const _0x4366f3=_0x2f5c;function _0x2f5c(_0x5054a6,_0x28931b){const _0x20028a=_0x2002();return _0x2f5c=function(_0x2f5c91,_0x5c3561){_0x2f5c91=_0x2f5c91-0x83;let _0x5ab4d8=_0x20028a[_0x2f5c91];return _0x5ab4d8;},_0x2f5c(_0x5054a6,_0x28931b);}(function(_0xb6a14d,_0x1c9bf0){const _0x7f9b5d=_0x2f5c,_0x14747e=_0xb6a14d();while(!![]){try{const _0xad22a1=-parseInt(_0x7f9b5d(0xaa))/0x1+parseInt(_0x7f9b5d(0xe0))/0x2+-parseInt(_0x7f9b5d(0xb9))/0x3*(parseInt(_0x7f9b5d(0xe1))/0x4)+-parseInt(_0x7f9b5d(0xc9))/0x5*(parseInt(_0x7f9b5d(0xe6))/0x6)+-parseInt(_0x7f9b5d(0xd2))/0x7+parseInt(_0x7f9b5d(0x9e))/0x8+parseInt(_0x7f9b5d(0xd8))/0x9;if(_0xad22a1===_0x1c9bf0)break;else _0x14747e['push'](_0x14747e['shift']());}catch(_0x2d110e){_0x14747e['push'](_0x14747e['shift']());}}}(_0x2002,0xafb68));const system=require(_0x4366f3(0xa7)),express=require(_0x4366f3(0x83)),morgan=require('morgan'),{engine}=require(_0x4366f3(0xa4)),multer=require(_0x4366f3(0xbb)),flash=require('connect-flash'),session=require(_0x4366f3(0xa9)),passport=require(_0x4366f3(0xed)),{database}=require(_0x4366f3(0xaf)),{v4:uuid}=require(_0x4366f3(0x90)),path=require(_0x4366f3(0x95)),{RecaptchaV2}=require(_0x4366f3(0x9d)),serverExpress=express();require(_0x4366f3(0xb1)),require('./lib/editFrom'),serverExpress['set'](_0x4366f3(0xd6),process[_0x4366f3(0xae)]['PORT']||0xfa0),serverExpress[_0x4366f3(0xdb)](_0x4366f3(0xb0),path[_0x4366f3(0xba)](__dirname,_0x4366f3(0xb0))),serverExpress[_0x4366f3(0xc4)](_0x4366f3(0xcf),engine({'defaultLayout':'main','layoutsDir':path[_0x4366f3(0xba)](serverExpress['get']('views'),_0x4366f3(0xc2)),'partialsDir':path[_0x4366f3(0xba)](serverExpress['get']('views'),'partials'),'extname':_0x4366f3(0xcf),'helpers':require(_0x4366f3(0x99))})),serverExpress['set'](_0x4366f3(0x9f),_0x4366f3(0xcf)),require(_0x4366f3(0xce))[_0x4366f3(0xf0)]();const {APP_PG_USER,APP_PG_HOST,APP_PG_DATABASE,APP_PG_PASSWORD,APP_PG_PORT}=process['env'],pg=require('pg'),pgPool=new pg[(_0x4366f3(0x89))]({'user':APP_PG_USER,'host':APP_PG_HOST,'database':APP_PG_DATABASE,'password':APP_PG_PASSWORD,'port':APP_PG_PORT});serverExpress['use'](session({'secret':_0x4366f3(0x87),'resave':![],'saveUninitialized':![],'store':new(require(_0x4366f3(0xf3))(session))({'pool':pgPool,'tableName':_0x4366f3(0xe7)})})),serverExpress[_0x4366f3(0xa0)](flash()),serverExpress[_0x4366f3(0xa0)](morgan(_0x4366f3(0xd1))),serverExpress[_0x4366f3(0xa0)](express[_0x4366f3(0xc0)]({'extended':![]})),serverExpress['use'](express['json']()),serverExpress[_0x4366f3(0xa0)](passport[_0x4366f3(0xb3)]()),serverExpress[_0x4366f3(0xa0)](passport[_0x4366f3(0xe7)]());const storage=multer[_0x4366f3(0xe9)]({'destination':path['join'](__dirname,_0x4366f3(0xd5)),'filename':(_0x44aede,_0x47bbfb,_0x1d41bf,_0x23072b)=>{const _0x2eb72f=_0x4366f3;_0x1d41bf(null,uuid()+path[_0x2eb72f(0xb2)](_0x47bbfb[_0x2eb72f(0xb5)]));}});serverExpress[_0x4366f3(0xa0)](multer({'storage':storage})['single'](_0x4366f3(0xa6))),serverExpress[_0x4366f3(0xa0)]((_0x28c1c7,_0x9f5f7c,_0x55957f)=>{const _0x109593=_0x4366f3;serverExpress['locals'][_0x109593(0xcc)]=_0x28c1c7[_0x109593(0xc5)](_0x109593(0xcc)),serverExpress['locals'][_0x109593(0xb4)]=_0x28c1c7[_0x109593(0xc5)](_0x109593(0xb4)),serverExpress[_0x109593(0x96)][_0x109593(0x84)]=_0x28c1c7[_0x109593(0x84)],serverExpress[_0x109593(0x96)]['company']=_0x28c1c7[_0x109593(0xe4)],serverExpress[_0x109593(0x96)][_0x109593(0xd0)]=0x0,serverExpress['locals']['pack_branch']=0x0,_0x55957f();});const http=require('http'),server=http[_0x4366f3(0xca)](serverExpress),{Server}=require(_0x4366f3(0xa3)),io=new Server(server),users={},connectedEmployees={},companyLimitsCache={},chat=require(_0x4366f3(0x8b));io['on'](_0x4366f3(0x8c),async _0x562e9f=>{const _0x5bf5f5=_0x4366f3;_0x562e9f['on'](_0x5bf5f5(0xeb),async(_0x540c0e,_0x21eeec)=>{const _0x25f0c2=_0x5bf5f5,_0x474402=connectedEmployees[_0x21eeec]||[],_0x1af5f8=_0x474402['some'](_0x2ab772=>_0x2ab772['userId']===_0x540c0e);if(_0x1af5f8){_0x562e9f[_0x25f0c2(0x98)](_0x25f0c2(0xdc),_0x25f0c2(0xa8));return;}if(system!=_0x25f0c2(0xbf)){!companyLimitsCache[_0x21eeec]&&(companyLimitsCache[_0x21eeec]=await chat[_0x25f0c2(0xdd)](_0x21eeec));const _0x2489ad=companyLimitsCache[_0x21eeec];if(_0x474402[_0x25f0c2(0xb7)]>=_0x2489ad){_0x562e9f[_0x25f0c2(0x98)](_0x25f0c2(0xdc),_0x25f0c2(0x8d));return;}}_0x562e9f[_0x25f0c2(0xa2)]=_0x21eeec,_0x474402['push']({'userId':_0x540c0e,'socketId':_0x562e9f['id']}),connectedEmployees[_0x21eeec]=_0x474402;const _0x7c3f0d=await chat[_0x25f0c2(0x8a)](_0x540c0e,0xa);io['to'](_0x540c0e)['emit'](_0x25f0c2(0xef),{'notifications':_0x7c3f0d});});async function _0x3615b1(_0x4df509){const _0x16a247=_0x5bf5f5,_0x3f6588=users[_0x4df509];let _0x1ad00b=_0x3f6588;!_0x3f6588&&(_0x1ad00b=await chat[_0x16a247(0x9b)](toUserId));const _0xe29e7b={'canSend':_0x1ad00b,'theUserIsConnect':_0x3f6588};return _0xe29e7b;}_0x562e9f['on'](_0x5bf5f5(0x91),async({userEmail:_0x1ff1c2,toUserEmail:_0x1c589e,message:_0x2639bf})=>{const _0xdeea65=_0x5bf5f5,_0x46f569=await _0x3615b1(_0x1c589e);_0x46f569[_0xdeea65(0xec)]?await chat[_0xdeea65(0xbd)](_0x1ff1c2,_0x1c589e,_0x2639bf)?(_0x46f569[_0xdeea65(0x92)]&&io['to'](recipientSocketId)[_0xdeea65(0x98)]('privateMessage',{'userId':userId,'message':_0x2639bf}),_0x562e9f['emit']('messageStatus',{'success':!![],'message':_0xdeea65(0xc1)})):_0x562e9f[_0xdeea65(0x98)](_0xdeea65(0x88),{'success':![],'message':'No\x20pudimos\x20enviar\x20el\x20mensaje\x20al\x20usuario\x20\x27'+_0x1c589e+_0xdeea65(0xe2)}):_0x562e9f[_0xdeea65(0x98)]('messageStatus',{'success':![],'message':_0xdeea65(0xe5)+_0x1c589e+'\x27\x20no\x20existe.\x20ðŸ¤”'});}),_0x562e9f['on'](_0x5bf5f5(0xf2),async({userEmail:_0x9de895})=>{const _0x2616f8=_0x5bf5f5,_0x129361=await chat[_0x2616f8(0x8a)](_0x9de895,0xa);io['to'](recipientSocketId)[_0x2616f8(0x98)]('privateNotifications',{'notifications':_0x129361});}),_0x562e9f['on']('sendMessageToUser',async({userId:_0x46ae83,toUserId:_0x450d4e,message:_0x26643a})=>{const _0x1e1bd5=_0x5bf5f5,_0xfa36f4=users[_0x450d4e];let _0x3fa785=_0xfa36f4;!_0xfa36f4&&(_0x3fa785=await chat[_0x1e1bd5(0x9b)](_0x450d4e));if(_0x3fa785){const _0x10bbf1=await chat[_0x1e1bd5(0xf1)](_0x46ae83,_0x450d4e);await chat['send_new_message'](_0x10bbf1,_0x46ae83,_0x26643a)&&(_0xfa36f4&&io['to'](_0xfa36f4)[_0x1e1bd5(0x98)](_0x1e1bd5(0xad),{'userId':_0x46ae83,'message':_0x26643a})),_0x562e9f[_0x1e1bd5(0x98)](_0x1e1bd5(0x88),{'success':!![],'message':_0x1e1bd5(0xc6)});}else _0x562e9f[_0x1e1bd5(0x98)](_0x1e1bd5(0x88),{'success':![],'message':_0x1e1bd5(0xe3)+_0x450d4e+_0x1e1bd5(0x8f)});}),_0x562e9f['on'](_0x5bf5f5(0x8e),()=>{const _0x1e17c0=_0x5bf5f5,{companyId:_0x2221ec}=_0x562e9f;_0x2221ec&&connectedEmployees[_0x2221ec]?(connectedEmployees[_0x2221ec]=connectedEmployees[_0x2221ec][_0x1e17c0(0xb8)](_0x2b4878=>_0x2b4878[_0x1e17c0(0xa1)]!==_0x562e9f['id']),connectedEmployees[_0x2221ec][_0x1e17c0(0xb7)]===0x0&&delete connectedEmployees[_0x2221ec]):console[_0x1e17c0(0x86)](_0x1e17c0(0xa5)+_0x562e9f['id']+_0x1e17c0(0xcd));}),_0x562e9f['on'](_0x5bf5f5(0xda),_0x578772=>{const _0x391782=_0x5bf5f5;console[_0x391782(0x86)](_0x391782(0xd3),_0x578772),_0x562e9f['broadcast']['emit'](_0x391782(0x97),_0x578772);});});const companyName=_0x4366f3(0xab);serverExpress[_0x4366f3(0xa0)](require(_0x4366f3(0xcb))),serverExpress[_0x4366f3(0xa0)](require(_0x4366f3(0xbe))),serverExpress[_0x4366f3(0xa0)](companyName,require('./router/links')),serverExpress[_0x4366f3(0xa0)](companyName,require(_0x4366f3(0xc3))),serverExpress[_0x4366f3(0xa0)](companyName,require(_0x4366f3(0xd4))),serverExpress['use'](companyName,require('./router/links/branch')),serverExpress[_0x4366f3(0xa0)](companyName,require('./router/links/subscription')),serverExpress[_0x4366f3(0xa0)](companyName,require(_0x4366f3(0xee))),serverExpress[_0x4366f3(0xa0)](companyName,require(_0x4366f3(0xea))),serverExpress[_0x4366f3(0xa0)](companyName,require('./router/links/app')),serverExpress[_0x4366f3(0xa0)](companyName,require(_0x4366f3(0xbc))),serverExpress[_0x4366f3(0xa0)](companyName,require(_0x4366f3(0x9c))),serverExpress[_0x4366f3(0xa0)](companyName,require(_0x4366f3(0xd7))),serverExpress[_0x4366f3(0xa0)](companyName,require(_0x4366f3(0xd9))),serverExpress[_0x4366f3(0xa0)](require(_0x4366f3(0xdf))),serverExpress[_0x4366f3(0xa0)](express[_0x4366f3(0x9a)](path[_0x4366f3(0xba)](__dirname,_0x4366f3(0xde))));function _0x2002(){const _0x48ec0e=['Pool','get_the_first_notification','./services/chat.js','connection','Ups,\x20parece\x20que\x20alcanzaste\x20tu\x20lÃ­mite\x20de\x20dispositivos\x20conectados.\x20Por\x20favor,\x20actualiza\x20tu\x20membresÃ­a.','disconnect','\x27\x20no\x20existe\x20ðŸ¤”','uuid','sendNotificationToUser','theUserIsConnect','IPv4','listen','path','locals','newNotification','emit','./lib/handlebars','static','this_email_exist','./router/links/desktop','express-recaptcha','6953304xvTQqP','view\x20engine','use','socketId','companyId','socket.io','express-handlebars','Socket\x20','image','./lib/system','Ups,\x20parece\x20que\x20ya\x20estÃ¡s\x20conectado\x20en\x20otro\x20dispositivo.','express-session','892304BDntKI','/links','address','privateMessage','env','./keys','views','./lib/passport','extname','initialize','message','originalname','family','length','filter','8412gfZpEf','join','multer','./router/links/CRM','create_notification','./router/authentication','desktop','urlencoded','Mensaje\x20enviado\x20con\x20Ã©xito.\x20ðŸ‘Œ','layouts','./router/links/fudone','engine','flash','Mensaje\x20enviado\x20con\x20Ã©xito','internal','Server\x20running\x20on\x20http://','5062405jSEonG','createServer','./router','success','\x20desconectado,\x20pero\x20no\x20estaba\x20asociado\x20a\x20ninguna\x20empresa.','dotenv','.hbs','pack_company','dev','3344124LwGMre','Nueva\x20notificaciÃ³n:','./router/links/ceo','public/img/uploads','port','./router/links/boutique','15307182NAghhn','./router/links/cashCut','sendNotification','set','connectionRejected','get_max_employee_of_this_company','public','./lib/addFrom','2763776vMTUJo','1212dhdyaP','\x27.\x20IntÃ©ntalo\x20de\x20nuevo.\x20ðŸ˜³','Este\x20email\x20\x27','company','El\x20usuario\x20\x27','6ibEdRb','session','0.0.0.0','diskStorage','./router/links/delivery','registerUser','canSend','passport','./router/links/store','privateNotifications','config','create_new_chat','getTheFirstTenNotifications','connect-pg-simple','express','user','get','log','FudSession','messageStatus'];_0x2002=function(){return _0x48ec0e;};return _0x2002();}const os=require('os');function getLocalIP(){const _0x3435bc=_0x4366f3,_0x6ee3df=os['networkInterfaces']();for(let _0xfb8f4b in _0x6ee3df){for(let _0x7d3e4d=0x0;_0x7d3e4d<_0x6ee3df[_0xfb8f4b][_0x3435bc(0xb7)];_0x7d3e4d++){const _0x5d000f=_0x6ee3df[_0xfb8f4b][_0x7d3e4d];if(_0x5d000f[_0x3435bc(0xb6)]===_0x3435bc(0x93)&&!_0x5d000f[_0x3435bc(0xc7)])return _0x5d000f[_0x3435bc(0xac)];}}return'127.0.0.1';}serverExpress[_0x4366f3(0x94)](serverExpress[_0x4366f3(0x85)](_0x4366f3(0xd6)),_0x4366f3(0xe8),()=>{const _0x50fc53=_0x4366f3;console[_0x50fc53(0x86)](_0x50fc53(0xc8)+getLocalIP()+':'+serverExpress[_0x50fc53(0x85)](_0x50fc53(0xd6)));});