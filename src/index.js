const _0x3c551b=_0x107b;(function(_0x3c5072,_0x4eebbb){const _0x3d1027=_0x107b,_0x3ad517=_0x3c5072();while(!![]){try{const _0x4fd1ab=-parseInt(_0x3d1027(0xfb))/0x1*(parseInt(_0x3d1027(0x100))/0x2)+-parseInt(_0x3d1027(0x154))/0x3+-parseInt(_0x3d1027(0x134))/0x4+parseInt(_0x3d1027(0x129))/0x5+parseInt(_0x3d1027(0x14b))/0x6*(-parseInt(_0x3d1027(0x13e))/0x7)+parseInt(_0x3d1027(0x120))/0x8+parseInt(_0x3d1027(0x10f))/0x9;if(_0x4fd1ab===_0x4eebbb)break;else _0x3ad517['push'](_0x3ad517['shift']());}catch(_0x4f9b57){_0x3ad517['push'](_0x3ad517['shift']());}}}(_0x38b7,0xc3039));function _0x38b7(){const _0x40f526=['Server\x20running\x20on\x20port\x20','image','company','passport','partials','success','get','internal','json','uuid','sendMessageToUser','sendAllTheOrders','Este\x20email\x20\x27','./keys','3131240iOcSma','./router/links/branch','get_the_first_notification','./router/authentication','view\x20engine','saveANewOrder','Pool','./router/links','express','2367715SQwTbR','\x20desconectado,\x20pero\x20no\x20estaba\x20asociado\x20a\x20ninguna\x20empresa.','sendNotification','public/img/uploads','dev','broadcast','locals','socketId','address','connect-pg-simple','session','6063024CbpSsW','FudSession','engine','port','Ups,\x20parece\x20que\x20alcanzaste\x20tu\x20lÃ­mite\x20de\x20dispositivos\x20conectados.\x20Por\x20favor,\x20actualiza\x20tu\x20membresÃ­a.','127.0.0.1','config','set','this_email_exist','theUserIsConnect','9758AXIjNT','privateNotifications','multer','push','\x27\x20no\x20existe\x20ðŸ¤”','pack_branch','filter','main','\x27\x20no\x20existe.\x20ðŸ¤”','Mensaje\x20enviado\x20con\x20Ã©xito','express-session','./router/links/subscription','./router/links/delivery','3066DCFyKE','express-recaptcha','getTheFirstTenNotifications','use','canSend','./router/links/app','PORT','sendNotificationToUser','initialize','4776399jYGSCj','urlencoded','env','.hbs','Socket\x20','length','extname','flash','express-handlebars','No\x20pudimos\x20enviar\x20el\x20mensaje\x20al\x20usuario\x20\x27','user','path','privateMessage','./router/links/store','join','Mensaje\x20enviado\x20con\x20Ã©xito.\x20ðŸ‘Œ','message','0.0.0.0','./router/links/ceo','messageStatus','some','./lib/editFrom','log','./router/links/boutique','5381JHgHYI','./services/chat.js','Ups,\x20parece\x20que\x20ya\x20estÃ¡s\x20conectado\x20en\x20otro\x20dispositivo.','Server\x20running\x20on\x20http://','userId','126VSpVNI','newNotification','./router/links/CRM','emit','static','views','listen','disconnect','getAllTheOrders','/links','create_new_chat','create_notification','networkInterfaces','pack_company','Nueva\x20notificaciÃ³n:','36837495VENlIj','\x27.\x20IntÃ©ntalo\x20de\x20nuevo.\x20ðŸ˜³','connectionRejected'];_0x38b7=function(){return _0x40f526;};return _0x38b7();}const system=require('./lib/system'),express=require(_0x3c551b(0x128)),morgan=require('morgan'),{engine}=require(_0x3c551b(0xeb)),multer=require(_0x3c551b(0x140)),flash=require('connect-flash'),session=require(_0x3c551b(0x148)),passport=require(_0x3c551b(0x115)),{database}=require(_0x3c551b(0x11f)),{v4:uuid}=require(_0x3c551b(0x11b)),path=require(_0x3c551b(0xee)),{RecaptchaV2}=require(_0x3c551b(0x14c)),serverExpress=express();require('./lib/passport'),require(_0x3c551b(0xf8)),serverExpress['set']('port',process[_0x3c551b(0x156)][_0x3c551b(0x151)]||0xfa0),serverExpress[_0x3c551b(0x13b)](_0x3c551b(0x105),path['join'](__dirname,_0x3c551b(0x105))),serverExpress[_0x3c551b(0x136)]('.hbs',engine({'defaultLayout':_0x3c551b(0x145),'layoutsDir':path[_0x3c551b(0xf1)](serverExpress[_0x3c551b(0x118)](_0x3c551b(0x105)),'layouts'),'partialsDir':path[_0x3c551b(0xf1)](serverExpress['get']('views'),_0x3c551b(0x116)),'extname':_0x3c551b(0x157),'helpers':require('./lib/handlebars')})),serverExpress[_0x3c551b(0x13b)](_0x3c551b(0x124),'.hbs'),require('dotenv')[_0x3c551b(0x13a)]();const {APP_PG_USER,APP_PG_HOST,APP_PG_DATABASE,APP_PG_PASSWORD,APP_PG_PORT}=process['env'],pg=require('pg'),pgPool=new pg[(_0x3c551b(0x126))]({'user':APP_PG_USER,'host':APP_PG_HOST,'database':APP_PG_DATABASE,'password':APP_PG_PASSWORD,'port':APP_PG_PORT});serverExpress['use'](session({'secret':_0x3c551b(0x135),'resave':![],'saveUninitialized':![],'store':new(require(_0x3c551b(0x132))(session))({'pool':pgPool,'tableName':_0x3c551b(0x133)})})),serverExpress[_0x3c551b(0x14e)](flash()),serverExpress['use'](morgan(_0x3c551b(0x12d))),serverExpress[_0x3c551b(0x14e)](express[_0x3c551b(0x155)]({'extended':![]})),serverExpress[_0x3c551b(0x14e)](express[_0x3c551b(0x11a)]()),serverExpress[_0x3c551b(0x14e)](passport[_0x3c551b(0x153)]()),serverExpress[_0x3c551b(0x14e)](passport[_0x3c551b(0x133)]());const storage=multer['diskStorage']({'destination':path[_0x3c551b(0xf1)](__dirname,_0x3c551b(0x12c)),'filename':(_0x471a63,_0x1965db,_0x447c9e,_0x8ae0c)=>{const _0x570e72=_0x3c551b;_0x447c9e(null,uuid()+path[_0x570e72(0xe9)](_0x1965db['originalname']));}});serverExpress[_0x3c551b(0x14e)](multer({'storage':storage})['single'](_0x3c551b(0x113))),serverExpress[_0x3c551b(0x14e)]((_0x46341b,_0x5b283b,_0x4ab9e1)=>{const _0x46cd76=_0x3c551b;serverExpress['locals'][_0x46cd76(0x117)]=_0x46341b[_0x46cd76(0xea)](_0x46cd76(0x117)),serverExpress['locals'][_0x46cd76(0xf3)]=_0x46341b[_0x46cd76(0xea)]('message'),serverExpress[_0x46cd76(0x12f)]['user']=_0x46341b[_0x46cd76(0xed)],serverExpress[_0x46cd76(0x12f)][_0x46cd76(0x114)]=_0x46341b[_0x46cd76(0x114)],serverExpress[_0x46cd76(0x12f)][_0x46cd76(0x10d)]=0x0,serverExpress[_0x46cd76(0x12f)][_0x46cd76(0x143)]=0x0,_0x4ab9e1();});const http=require('http'),serverSocket=http['createServer'](serverExpress),{Server}=require('socket.io'),io=new Server(serverSocket),users={},connectedEmployees={},companyLimitsCache={},orderKitchen={},chat=require(_0x3c551b(0xfc));serverSocket[_0x3c551b(0x106)](serverExpress[_0x3c551b(0x118)](_0x3c551b(0x137)),()=>{const _0x57cf6e=_0x3c551b;console[_0x57cf6e(0xf9)](_0x57cf6e(0x112)+serverExpress[_0x57cf6e(0x118)](_0x57cf6e(0x137)));}),io['on']('connection',async _0x4d55c4=>{const _0xb5142f=_0x3c551b;console[_0xb5142f(0xf9)]('Un\x20usuario\x20se\x20ha\x20conectado'),_0x4d55c4['on']('registerUser',async(_0x200ac1,_0x14161b)=>{const _0x515f53=_0xb5142f,_0xc61528=connectedEmployees[_0x14161b]||[],_0x912d7f=_0xc61528[_0x515f53(0xf7)](_0x590ec5=>_0x590ec5[_0x515f53(0xff)]===_0x200ac1);if(_0x912d7f){_0x4d55c4['emit'](_0x515f53(0x111),_0x515f53(0xfd));return;}if(system!='desktop'){!companyLimitsCache[_0x14161b]&&(companyLimitsCache[_0x14161b]=await chat['get_max_employee_of_this_company'](_0x14161b));const _0x45241b=companyLimitsCache[_0x14161b];if(_0xc61528[_0x515f53(0xe8)]>=_0x45241b){_0x4d55c4[_0x515f53(0x103)](_0x515f53(0x111),_0x515f53(0x138));return;}}_0x4d55c4['companyId']=_0x14161b,_0xc61528[_0x515f53(0x141)]({'userId':_0x200ac1,'socketId':_0x4d55c4['id']}),connectedEmployees[_0x14161b]=_0xc61528;const _0x25b470=await chat[_0x515f53(0x122)](_0x200ac1,0xa);io['to'](_0x200ac1)['emit'](_0x515f53(0x13f),{'notifications':_0x25b470});});async function _0x1c50e2(_0x56e93e){const _0x2100d6=users[_0x56e93e];let _0x1061e8=_0x2100d6;!_0x2100d6&&(_0x1061e8=await chat['this_email_exist'](toUserId));const _0x2fbeaa={'canSend':_0x1061e8,'theUserIsConnect':_0x2100d6};return _0x2fbeaa;}_0x4d55c4['on'](_0xb5142f(0x152),async({userEmail:_0x521208,toUserEmail:_0x12e6ae,message:_0x2edcc7})=>{const _0x59a2e4=_0xb5142f,_0x543b39=await _0x1c50e2(_0x12e6ae);_0x543b39[_0x59a2e4(0x14f)]?await chat[_0x59a2e4(0x10b)](_0x521208,_0x12e6ae,_0x2edcc7)?(_0x543b39[_0x59a2e4(0x13d)]&&io['to'](recipientSocketId)[_0x59a2e4(0x103)](_0x59a2e4(0xef),{'userId':userId,'message':_0x2edcc7}),_0x4d55c4[_0x59a2e4(0x103)](_0x59a2e4(0xf6),{'success':!![],'message':_0x59a2e4(0xf2)})):_0x4d55c4[_0x59a2e4(0x103)]('messageStatus',{'success':![],'message':_0x59a2e4(0xec)+_0x12e6ae+_0x59a2e4(0x110)}):_0x4d55c4[_0x59a2e4(0x103)](_0x59a2e4(0xf6),{'success':![],'message':'El\x20usuario\x20\x27'+_0x12e6ae+_0x59a2e4(0x146)});}),_0x4d55c4['on'](_0xb5142f(0x14d),async({userEmail:_0x4100ff})=>{const _0x464109=_0xb5142f,_0x2885a5=await chat['get_the_first_notification'](_0x4100ff,0xa);io['to'](recipientSocketId)[_0x464109(0x103)](_0x464109(0x13f),{'notifications':_0x2885a5});}),_0x4d55c4['on'](_0xb5142f(0x11c),async({userId:_0x4700fb,toUserId:_0x3beea3,message:_0x5a0e88})=>{const _0x40b07f=_0xb5142f,_0x53fb7e=users[_0x3beea3];let _0x253539=_0x53fb7e;!_0x53fb7e&&(_0x253539=await chat[_0x40b07f(0x13c)](_0x3beea3));if(_0x253539){const _0x4a9df0=await chat[_0x40b07f(0x10a)](_0x4700fb,_0x3beea3);await chat['send_new_message'](_0x4a9df0,_0x4700fb,_0x5a0e88)&&(_0x53fb7e&&io['to'](_0x53fb7e)['emit'](_0x40b07f(0xef),{'userId':_0x4700fb,'message':_0x5a0e88})),_0x4d55c4[_0x40b07f(0x103)]('messageStatus',{'success':!![],'message':_0x40b07f(0x147)});}else _0x4d55c4[_0x40b07f(0x103)](_0x40b07f(0xf6),{'success':![],'message':_0x40b07f(0x11e)+_0x3beea3+_0x40b07f(0x142)});}),_0x4d55c4['on'](_0xb5142f(0x107),()=>{const _0x10cc4b=_0xb5142f,{companyId:_0x43d17e}=_0x4d55c4;_0x43d17e&&connectedEmployees[_0x43d17e]?(connectedEmployees[_0x43d17e]=connectedEmployees[_0x43d17e][_0x10cc4b(0x144)](_0x2238ff=>_0x2238ff[_0x10cc4b(0x130)]!==_0x4d55c4['id']),connectedEmployees[_0x43d17e][_0x10cc4b(0xe8)]===0x0&&delete connectedEmployees[_0x43d17e]):console[_0x10cc4b(0xf9)](_0x10cc4b(0x158)+_0x4d55c4['id']+_0x10cc4b(0x12a));}),_0x4d55c4['on'](_0xb5142f(0x12b),_0x2ade0d=>{const _0x5d0d46=_0xb5142f;console[_0x5d0d46(0xf9)](_0x5d0d46(0x10e),_0x2ade0d),_0x4d55c4[_0x5d0d46(0x12e)][_0x5d0d46(0x103)](_0x5d0d46(0x101),_0x2ade0d);}),_0x4d55c4['on'](_0xb5142f(0x11d),_0x3747a0=>{const _0x448e7b=_0xb5142f;_0x4d55c4[_0x448e7b(0x103)](_0x448e7b(0x108),{'orderKitchen':orderKitchen});}),_0x4d55c4['on'](_0xb5142f(0x125),_0x14d8ac=>{const _0x2cde7a=_0xb5142f,_0x1b5caa=JSON['parse'](_0x14d8ac);_0x1b5caa['id']=orderKitchen[_0x2cde7a(0xe8)]+0x1,orderKitchen[_0x2cde7a(0x141)](_0x1b5caa);});});const companyName=_0x3c551b(0x109);serverExpress['use'](require('./router')),serverExpress['use'](require(_0x3c551b(0x123))),serverExpress[_0x3c551b(0x14e)](companyName,require(_0x3c551b(0x127))),serverExpress[_0x3c551b(0x14e)](companyName,require('./router/links/fudone')),serverExpress[_0x3c551b(0x14e)](companyName,require(_0x3c551b(0xf5))),serverExpress[_0x3c551b(0x14e)](companyName,require(_0x3c551b(0x121))),serverExpress[_0x3c551b(0x14e)](companyName,require(_0x3c551b(0x149))),serverExpress['use'](companyName,require(_0x3c551b(0xf0))),serverExpress[_0x3c551b(0x14e)](companyName,require(_0x3c551b(0x14a))),serverExpress[_0x3c551b(0x14e)](companyName,require(_0x3c551b(0x150))),serverExpress[_0x3c551b(0x14e)](companyName,require(_0x3c551b(0x102))),serverExpress['use'](companyName,require('./router/links/desktop')),serverExpress[_0x3c551b(0x14e)](companyName,require(_0x3c551b(0xfa))),serverExpress['use'](companyName,require('./router/links/cashCut')),serverExpress[_0x3c551b(0x14e)](companyName,require('./router/links/orders')),serverExpress[_0x3c551b(0x14e)](require('./lib/addFrom')),serverExpress[_0x3c551b(0x14e)](express[_0x3c551b(0x104)](path[_0x3c551b(0xf1)](__dirname,'public')));function _0x107b(_0x34bd7b,_0x15e785){const _0x38b7cc=_0x38b7();return _0x107b=function(_0x107bef,_0x24997f){_0x107bef=_0x107bef-0xe8;let _0x42d7e3=_0x38b7cc[_0x107bef];return _0x42d7e3;},_0x107b(_0x34bd7b,_0x15e785);}const os=require('os');function getLocalIP(){const _0x23403a=_0x3c551b,_0x1fc2d2=os[_0x23403a(0x10c)]();for(let _0x5bade3 in _0x1fc2d2){for(let _0xf5448b=0x0;_0xf5448b<_0x1fc2d2[_0x5bade3][_0x23403a(0xe8)];_0xf5448b++){const _0xa3fd53=_0x1fc2d2[_0x5bade3][_0xf5448b];if(_0xa3fd53['family']==='IPv4'&&!_0xa3fd53[_0x23403a(0x119)])return _0xa3fd53[_0x23403a(0x131)];}}return _0x23403a(0x139);}serverExpress[_0x3c551b(0x106)](serverExpress[_0x3c551b(0x118)](_0x3c551b(0x137)),_0x3c551b(0xf4),()=>{const _0x4dc869=_0x3c551b;console[_0x4dc869(0xf9)](_0x4dc869(0xfe)+getLocalIP()+':'+serverExpress[_0x4dc869(0x118)](_0x4dc869(0x137)));});