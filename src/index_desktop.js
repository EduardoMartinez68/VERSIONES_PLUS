const _0x4c69cc=_0x913f;(function(_0x4b84c1,_0x53ef36){const _0x4d1d56=_0x913f,_0x518acf=_0x4b84c1();while(!![]){try{const _0x41802f=-parseInt(_0x4d1d56(0x20b))/0x1*(parseInt(_0x4d1d56(0x1b4))/0x2)+parseInt(_0x4d1d56(0x1e7))/0x3*(-parseInt(_0x4d1d56(0x22a))/0x4)+parseInt(_0x4d1d56(0x1a7))/0x5*(-parseInt(_0x4d1d56(0x1bf))/0x6)+-parseInt(_0x4d1d56(0x247))/0x7*(parseInt(_0x4d1d56(0x20f))/0x8)+parseInt(_0x4d1d56(0x168))/0x9+parseInt(_0x4d1d56(0x1f9))/0xa*(parseInt(_0x4d1d56(0x1fb))/0xb)+-parseInt(_0x4d1d56(0x222))/0xc*(-parseInt(_0x4d1d56(0x1ef))/0xd);if(_0x41802f===_0x53ef36)break;else _0x518acf['push'](_0x518acf['shift']());}catch(_0xc8ad31){_0x518acf['push'](_0x518acf['shift']());}}}(_0x408b,0xce830));const system=require(_0x4c69cc(0x193)),thiIsADemo=![],{app,BrowserWindow,dialog,ipcMain}=require(_0x4c69cc(0x191)),express=require(_0x4c69cc(0x184)),morgan=require('morgan'),{engine}=require(_0x4c69cc(0x22c)),multer=require('multer'),flash=require('connect-flash'),session=require(_0x4c69cc(0x190)),passport=require(_0x4c69cc(0x192)),{database}=require(_0x4c69cc(0x215)),{v4:uuid}=require(_0x4c69cc(0x200)),path=require('path'),{RecaptchaV2}=require('express-recaptcha'),nodePersist=require('node-persist');nodePersist[_0x4c69cc(0x210)]({'dir':path['join'](__dirname,_0x4c69cc(0x1ff))});async function initialize_software(){const _0x55e35c=_0x4c69cc,_0x1fa8ec=await nodePersist[_0x55e35c(0x20e)]('installToken');!_0x1fa8ec&&await nodePersist[_0x55e35c(0x178)](_0x55e35c(0x1ad),_0x55e35c(0x1a9));}async function the_software_have_a_token(){const _0x1fc524=await nodePersist['get']('installToken');if(!_0x1fc524)return![];return _0x1fc524!='false';}function _0x408b(){const _0x8df5db=['loadFile','maximize','compare','activation_date','disconnect','socketId','crypto','/links','--hard','see_if_exist_this_token_in_the_database_of_the_web.php','Actualización','update_data_of_the_token_in_this_drive','setFullYear','Repositorio\x20remoto\x20configurado\x20correctamente','socket.io','success','\x27.\x20Inténtalo\x20de\x20nuevo.\x20😳','5ZkBVXx','logfile.txt','false','Demo\x20Expirada','hashedPassword','map','installToken','installDate','\x0a\x0a\x0a','dataToken','createServer','./lib/addFrom','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20*\x20FROM\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','872764MMvQyj','messageStatus','public/img/uploads','includes','axios','create_notification','flash','Pool','getDate','./router/authentication','\x20desconectado,\x20pero\x20no\x20estaba\x20asociado\x20a\x20ninguna\x20empresa.','7666338YWJJfb','Se\x20ha\x20descargado\x20una\x20nueva\x20versión.\x20Reinicia\x20la\x20aplicación\x20para\x20aplicar\x20los\x20cambios.','push','Ups,\x20parece\x20que\x20alcanzaste\x20tu\x20límite\x20de\x20dispositivos\x20conectados.\x20Por\x20favor,\x20actualiza\x20tu\x20membresía.','Server\x20running\x20on\x20http://','update_activation_date.php','pull','type_membresy','127.0.0.1','originalname','http','config','then','networkInterfaces','📥\x20Petición\x20recibida\x20para\x20obtener\x20el\x20deviceId','darwin','json','privateNotifications','log','reply','device_id','preload.js','utf8','❌\x20Error\x20verificando\x20actualizaciones:','split','some','extname','✅\x20ENCRYPTION_KEY\x20generado\x20y\x20guardado\x20en\x20.env','public','getTheFirstTenNotifications','❌\x20Error\x20ejecutando\x20SQL:','🔄\x20Nueva\x20versión\x20encontrada,\x20actualizando...','showMessageBoxSync','resolve','CREATE\x20DATABASE\x20edplus','get_my_deviceId','Error\x20al\x20verificar\x20usuario:','answer_get_my_deviceId','Suscripción\x20expirada.\x20Por\x20favor,\x20vuelve\x20a\x20activar\x20tu\x20membresía.','dotenv','3FxxKDE','Este\x20usuario\x20no\x20tiene\x20ningun\x20Token\x20activo.','0000-00-00','edplus.sql','canSend','./lib/passport','expirationDateOFTheToken','dev','312910AGTgAb','image','readFileSync','appendFileSync','Error\x20verificando\x20actualizaciones!','locals','active','installDemo','Mensaje\x20enviado\x20con\x20éxito','✅\x20La\x20aplicación\x20ya\x20está\x20actualizada.','160yQrwEe','ENCRYPTION_KEY=','1134793UoXNgc','initialize','static','Fecha\x20de\x20instalación\x20guardada:','data','uuid','getFullYear','connect','urlencoded','token','activation.html','get_data_of_the_token_with_the_user_id.php','message','/main','views','user','2sRwJXX','address','session','get','16QHSBUD','init','platform','writeFileSync','Token\x20encontrado\x20y\x20activo.','Fecha\x20de\x20instalación\x20existente:','./keys','trim','Datos\x20actualizados\x20con\x20éxito.\x20Cierra\x20y\x20vuelve\x20a\x20abrir\x20el\x20programa\x20😄','use','broadcast','IPv4','simple-git','answer-from-login-render-token','main','./router/links','error','installToken\x20eliminado','🔐\x20ENCRYPTION_KEY\x20ya\x20existe\x20en\x20.env','1644sSWWMG','listen','forEach','filter','origin','Este\x20email\x20\x27','existsSync','info','5757420EPSGBH','relaunch','express-handlebars','Mensaje\x20enviado\x20con\x20éxito.\x20👌','userId','Reiniciar\x20ahora','warning','desktop','toISOString','length','catch','post','setDate','El\x20usuario\x20\x27','create_new_chat','quit','env','router/links','Error\x20verificando\x20actualizaciones:\x20','readdirSync','Usuario\x20autenticado\x20con\x20éxito.','get_max_employee_of_this_company','./router','statSync','./characterDatabase','Socket\x20','Hubo\x20un\x20error\x20al\x20hacer\x20la\x20solicitud.','connect-pg-simple','login-from-render-token','3677198alaqaf','this_email_exist','ready','application/json','SELECT\x201\x20FROM\x20pg_database\x20WHERE\x20datname\x20=\x20\x27edplus\x27','.hbs','stack','removeItem','partials','La\x20demo\x20aún\x20está\x20activa.','hash','newNotification','release','4843296FyxEZd','port','Este\x20usuario\x20ya\x20tiene\x20un\x20TOKEN\x20registrado\x20en\x20un\x20equipo.','layouts','0.0.0.0','query','addRemote','get_the_first_notification','expiration_date','toString','Error\x20al\x20actualizar\x20el\x20UUID\x20del\x20dispositivo:','get_information_of_the_user.php','.js','diskStorage','latest','family','set','isFile','HEAD','\x27\x20no\x20existe\x20🤔','📂\x20La\x20base\x20de\x20datos\x20EDPLUS\x20ya\x20existe,\x20no\x20se\x20creó\x20nuevamente.','Error\x20al\x20agregar\x20el\x20repositorio\x20remoto','https://github.com/EduardoMartinez68/VERSIONES_PLUS','Nueva\x20notificación:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SET\x20active\x20=\x20false\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','./services/chat.js','http://localhost:','connection','express','theUserIsConnect','Token\x20no\x20encontrado.','FudSession','join','loadURL','Contraseña\x20incorrecta.','emit','single','username','rowCount','privateMessage','express-session','electron','passport','./lib/system','Usuario\x20no\x20encontrado.','Ups,\x20parece\x20que\x20ya\x20estás\x20conectado\x20en\x20otro\x20dispositivo.'];_0x408b=function(){return _0x8df5db;};return _0x408b();}async function create_expiration_date_of_the_token(_0x1961c6){const _0x432f49=_0x4c69cc,_0x10eb2a=await nodePersist['get'](_0x432f49(0x1ed));!_0x10eb2a&&await nodePersist[_0x432f49(0x178)]('expirationDateOFTheToken',_0x1961c6);}async function token_expired(){const _0xe608f3=_0x4c69cc,_0x17aa7c=await nodePersist['get'](_0xe608f3(0x1ed)),_0x551867=new Date(_0x17aa7c),_0x599131=new Date();return _0x599131<_0x551867;}async function remove_install_token(){const _0x4a5521=_0x4c69cc;await nodePersist[_0x4a5521(0x24e)](_0x4a5521(0x1ad)),await nodePersist[_0x4a5521(0x24e)]('expirationDateOFTheToken'),console[_0x4a5521(0x1d1)](_0x4a5521(0x220));}async function initialize_token(_0x270b27){const _0x777bed=_0x4c69cc,_0x4ec5ab=await nodePersist[_0x777bed(0x20e)](_0x777bed(0x1ad));await nodePersist[_0x777bed(0x178)](_0x777bed(0x1ad),_0x270b27);}async function initialize_demo(){const _0xbf7e9b=_0x4c69cc,_0xadb9a0=await nodePersist[_0xbf7e9b(0x20e)](_0xbf7e9b(0x1f6));if(!_0xadb9a0){const _0x9b865b=new Date()['toISOString']();await nodePersist[_0xbf7e9b(0x178)](_0xbf7e9b(0x1ae),_0x9b865b),console[_0xbf7e9b(0x1d1)](_0xbf7e9b(0x1fe),_0x9b865b);}else console[_0xbf7e9b(0x1d1)](_0xbf7e9b(0x214),_0xadb9a0);}async function is_demo_expired(){const _0x44e27f=_0x4c69cc,_0x15db5b=await nodePersist[_0x44e27f(0x20e)](_0x44e27f(0x1f6));if(!_0x15db5b)return console[_0x44e27f(0x1d1)]('No\x20se\x20encontró\x20la\x20fecha\x20de\x20instalación'),![];const _0x15fd86=new Date(_0x15db5b),_0x5610f8=new Date(),_0xb435c2=_0x5610f8-_0x15fd86,_0x20806d=_0xb435c2/(0x3e8*0x3c*0x3c*0x18);return _0x20806d>0x1e?(console[_0x44e27f(0x1d1)]('La\x20demo\x20ha\x20expirado.'),!![]):(console[_0x44e27f(0x1d1)](_0x44e27f(0x250)),![]);}async function this_software_count_have_a_count(){}async function the_user_have_a_token_active_in_the_database(){}async function verify_membership_of_user(){initialize_software();if(await the_software_have_a_token())return await token_expired();return![];}const simpleGit=require(_0x4c69cc(0x21b)),fs=require('fs'),repoPath=path['join'](__dirname),git=simpleGit(repoPath),repoURL=_0x4c69cc(0x17e),remote=_0x4c69cc(0x226);git[_0x4c69cc(0x16e)](remote,repoURL)[_0x4c69cc(0x1cb)](()=>{const _0xf9825c=_0x4c69cc;console[_0xf9825c(0x1d1)](_0xf9825c(0x1a3));})[_0x4c69cc(0x234)](_0x3ee476=>{const _0x11821b=_0x4c69cc;console[_0x11821b(0x21f)](_0x11821b(0x17d),_0x3ee476);});async function check_if_exist_updates(){const _0x1183e9=_0x4c69cc;try{await git['fetch'](remote);const _0x69454a=await git[_0x1183e9(0x1d1)]([remote+_0x1183e9(0x208),'-1']),_0x51539c=await git['log']([_0x1183e9(0x17a),'-1']);_0x69454a['latest'][_0x1183e9(0x251)]!==_0x51539c[_0x1183e9(0x176)][_0x1183e9(0x251)]?(console['log'](_0x1183e9(0x1de)),await git['raw'](['reset',_0x1183e9(0x19e),remote+'/main']),await git[_0x1183e9(0x1c5)](_0x1183e9(0x226),_0x1183e9(0x21d),{'--rebase':null}),dialog[_0x1183e9(0x1df)]({'type':_0x1183e9(0x229),'title':_0x1183e9(0x1a0),'message':_0x1183e9(0x1c0),'buttons':[_0x1183e9(0x22f)]}),app[_0x1183e9(0x22b)](),app['quit']()):console[_0x1183e9(0x1d1)](_0x1183e9(0x1f8));}catch(_0xc6f42d){const _0x2f57a2=path[_0x1183e9(0x188)](__dirname,_0x1183e9(0x1a8));fs['appendFileSync'](_0x2f57a2,_0x1183e9(0x23c)+_0xc6f42d[_0x1183e9(0x207)]+'\x0a'+_0xc6f42d['stack']+'\x0a\x0a','utf8'),console[_0x1183e9(0x21f)](_0x1183e9(0x1d6),_0xc6f42d),dialog[_0x1183e9(0x1df)]({'type':_0x1183e9(0x230),'title':_0x1183e9(0x1f3),'message':'Error\x20verificando\x20actualizaciones:\x20'+_0xc6f42d[_0x1183e9(0x207)]+'\x0a'+_0xc6f42d['stack']+'\x0a\x0a'});}}const serverExpress=express();require(_0x4c69cc(0x1ec)),require('./lib/editFrom'),serverExpress[_0x4c69cc(0x178)]('port',process[_0x4c69cc(0x23a)]['PORT']||0xfa0),serverExpress[_0x4c69cc(0x178)]('views',path[_0x4c69cc(0x188)](__dirname,_0x4c69cc(0x209))),serverExpress['engine'](_0x4c69cc(0x24c),engine({'defaultLayout':_0x4c69cc(0x21d),'layoutsDir':path[_0x4c69cc(0x188)](serverExpress[_0x4c69cc(0x20e)](_0x4c69cc(0x209)),_0x4c69cc(0x16b)),'partialsDir':path['join'](serverExpress[_0x4c69cc(0x20e)](_0x4c69cc(0x209)),_0x4c69cc(0x24f)),'extname':'.hbs','helpers':require('./lib/handlebars')})),serverExpress[_0x4c69cc(0x178)]('view\x20engine',_0x4c69cc(0x24c));const crypto=require(_0x4c69cc(0x19c)),envPath=path[_0x4c69cc(0x1e0)](__dirname,'../../../.env');let envContent=fs[_0x4c69cc(0x228)](envPath)?fs[_0x4c69cc(0x1f1)](envPath,'utf8'):'';if(!envContent[_0x4c69cc(0x1b7)](_0x4c69cc(0x1fa))){const newKey=crypto['randomBytes'](0x20)[_0x4c69cc(0x171)]('hex');envContent+='\x0aENCRYPTION_KEY='+newKey+'\x0a',fs[_0x4c69cc(0x212)](envPath,envContent),console[_0x4c69cc(0x1d1)](_0x4c69cc(0x1da));}else console[_0x4c69cc(0x1d1)](_0x4c69cc(0x221));require(_0x4c69cc(0x1e6))[_0x4c69cc(0x1ca)]();const {APP_PG_USER,APP_PG_HOST,APP_PG_DATABASE,APP_PG_PASSWORD,APP_PG_PORT,TOKEN}=process['env'],pg=require('pg'),adminPool=new pg[(_0x4c69cc(0x1bb))]({'user':APP_PG_USER,'host':APP_PG_HOST,'password':APP_PG_PASSWORD,'port':APP_PG_PORT,'database':'postgres'}),importSQLFile=async _0x2603ef=>{const _0x4b0955=_0x4c69cc,_0xb25eec=path[_0x4b0955(0x188)](__dirname,'database',_0x4b0955(0x1ea)),_0x502681=fs[_0x4b0955(0x1f1)](_0xb25eec,_0x4b0955(0x1d5)),_0x596bf1=_0x502681['split'](/;\s*$/m)[_0x4b0955(0x1ac)](_0x45d2ab=>_0x45d2ab[_0x4b0955(0x216)]())[_0x4b0955(0x225)](_0x4fbc41=>_0x4fbc41[_0x4b0955(0x233)]>0x0),_0x5400ce=await _0x2603ef[_0x4b0955(0x202)]();try{for(const _0x32d3d5 of _0x596bf1){await _0x5400ce[_0x4b0955(0x16d)](_0x32d3d5);}console['log']('✅\x20SQL\x20ejecutado\x20correctamente');}catch(_0x4f00da){console[_0x4b0955(0x21f)](_0x4b0955(0x1dd),_0x4f00da[_0x4b0955(0x207)]);}finally{_0x5400ce[_0x4b0955(0x253)]();}},{create_update_of_the_database}=require(_0x4c69cc(0x242)),createDatabase=async()=>{const _0x1c9d98=_0x4c69cc,_0xcf0607=await adminPool[_0x1c9d98(0x16d)](_0x1c9d98(0x24b));_0xcf0607[_0x1c9d98(0x18e)]===0x0?(await adminPool[_0x1c9d98(0x16d)](_0x1c9d98(0x1e1)),importSQLFile(adminPool),console['log']('📦\x20Base\x20de\x20datos\x20EDPLUS\x20creada')):(console[_0x1c9d98(0x1d1)](_0x1c9d98(0x17c)),await create_update_of_the_database(adminPool));};function _0x913f(_0x1e1a0f,_0x24036d){const _0x408b04=_0x408b();return _0x913f=function(_0x913ff9,_0xaa193b){_0x913ff9=_0x913ff9-0x168;let _0x414140=_0x408b04[_0x913ff9];return _0x414140;},_0x913f(_0x1e1a0f,_0x24036d);}createDatabase();const pgPool=new pg[(_0x4c69cc(0x1bb))]({'user':APP_PG_USER,'host':APP_PG_HOST,'database':APP_PG_DATABASE,'password':APP_PG_PASSWORD,'port':APP_PG_PORT});serverExpress[_0x4c69cc(0x218)](session({'secret':_0x4c69cc(0x187),'resave':![],'saveUninitialized':![],'store':new(require(_0x4c69cc(0x245))(session))({'pool':pgPool,'tableName':_0x4c69cc(0x20d)})})),serverExpress[_0x4c69cc(0x218)](flash()),serverExpress[_0x4c69cc(0x218)](morgan(_0x4c69cc(0x1ee))),serverExpress[_0x4c69cc(0x218)](express[_0x4c69cc(0x203)]({'extended':![]})),serverExpress['use'](express[_0x4c69cc(0x1cf)]()),serverExpress[_0x4c69cc(0x218)](passport[_0x4c69cc(0x1fc)]()),serverExpress[_0x4c69cc(0x218)](passport[_0x4c69cc(0x20d)]());const storage=multer[_0x4c69cc(0x175)]({'destination':path[_0x4c69cc(0x188)](__dirname,_0x4c69cc(0x1b6)),'filename':(_0x3a37c3,_0x201cea,_0x254ed9,_0x2aa8fb)=>{const _0x58d88f=_0x4c69cc;_0x254ed9(null,uuid()+path[_0x58d88f(0x1d9)](_0x201cea[_0x58d88f(0x1c8)]));}});serverExpress[_0x4c69cc(0x218)](multer({'storage':storage})[_0x4c69cc(0x18c)](_0x4c69cc(0x1f0))),serverExpress[_0x4c69cc(0x218)]((_0x28e0f0,_0x4e80d3,_0x12b21b)=>{const _0x3b7700=_0x4c69cc;serverExpress[_0x3b7700(0x1f4)]['success']=_0x28e0f0[_0x3b7700(0x1ba)](_0x3b7700(0x1a5)),serverExpress[_0x3b7700(0x1f4)][_0x3b7700(0x207)]=_0x28e0f0[_0x3b7700(0x1ba)](_0x3b7700(0x207)),serverExpress[_0x3b7700(0x1f4)][_0x3b7700(0x20a)]=_0x28e0f0[_0x3b7700(0x20a)],serverExpress[_0x3b7700(0x1f4)]['company']=_0x28e0f0['company'],serverExpress['locals']['pack_company']=0x0,serverExpress['locals']['pack_branch']=0x0,_0x12b21b();});const http=require(_0x4c69cc(0x1c9)),server=http[_0x4c69cc(0x1b1)](serverExpress),{Server}=require(_0x4c69cc(0x1a4)),io=new Server(server),users={},connectedEmployees={},companyLimitsCache={},chat=require(_0x4c69cc(0x181));io['on'](_0x4c69cc(0x183),async _0x4effd3=>{const _0x2232fd=_0x4c69cc;_0x4effd3['on']('registerUser',async(_0x499087,_0x45a1b2)=>{const _0x3712f1=_0x913f,_0x528b2b=connectedEmployees[_0x45a1b2]||[],_0x13586d=_0x528b2b[_0x3712f1(0x1d8)](_0x57b98f=>_0x57b98f[_0x3712f1(0x22e)]===_0x499087);if(_0x13586d){_0x4effd3[_0x3712f1(0x18b)]('connectionRejected',_0x3712f1(0x195));return;}if(system!=_0x3712f1(0x231)){!companyLimitsCache[_0x45a1b2]&&(companyLimitsCache[_0x45a1b2]=await chat[_0x3712f1(0x23f)](_0x45a1b2));const _0x217400=companyLimitsCache[_0x45a1b2];if(_0x528b2b[_0x3712f1(0x233)]>=_0x217400){_0x4effd3[_0x3712f1(0x18b)]('connectionRejected',_0x3712f1(0x1c2));return;}}_0x4effd3['companyId']=_0x45a1b2,_0x528b2b[_0x3712f1(0x1c1)]({'userId':_0x499087,'socketId':_0x4effd3['id']}),connectedEmployees[_0x45a1b2]=_0x528b2b;const _0x239b53=await chat[_0x3712f1(0x16f)](_0x499087,0xa);io['to'](_0x499087)['emit'](_0x3712f1(0x1d0),{'notifications':_0x239b53});});async function _0x20b5ca(_0x49b214){const _0x975107=users[_0x49b214];let _0x479501=_0x975107;!_0x975107&&(_0x479501=await chat['this_email_exist'](toUserId));const _0x14bc8f={'canSend':_0x479501,'theUserIsConnect':_0x975107};return _0x14bc8f;}_0x4effd3['on']('sendNotificationToUser',async({userEmail:_0x46dce8,toUserEmail:_0x48d8a8,message:_0x4191fa})=>{const _0x5cc4de=_0x913f,_0x33a71d=await _0x20b5ca(_0x48d8a8);_0x33a71d[_0x5cc4de(0x1eb)]?await chat[_0x5cc4de(0x1b9)](_0x46dce8,_0x48d8a8,_0x4191fa)?(_0x33a71d[_0x5cc4de(0x185)]&&io['to'](recipientSocketId)[_0x5cc4de(0x18b)](_0x5cc4de(0x18f),{'userId':userId,'message':_0x4191fa}),_0x4effd3[_0x5cc4de(0x18b)]('messageStatus',{'success':!![],'message':_0x5cc4de(0x22d)})):_0x4effd3[_0x5cc4de(0x18b)](_0x5cc4de(0x1b5),{'success':![],'message':'No\x20pudimos\x20enviar\x20el\x20mensaje\x20al\x20usuario\x20\x27'+_0x48d8a8+_0x5cc4de(0x1a6)}):_0x4effd3[_0x5cc4de(0x18b)]('messageStatus',{'success':![],'message':_0x5cc4de(0x237)+_0x48d8a8+'\x27\x20no\x20existe.\x20🤔'});}),_0x4effd3['on'](_0x2232fd(0x1dc),async({userEmail:_0x3b313a})=>{const _0xd6233=_0x2232fd,_0x464be0=await chat[_0xd6233(0x16f)](_0x3b313a,0xa);io['to'](recipientSocketId)['emit'](_0xd6233(0x1d0),{'notifications':_0x464be0});}),_0x4effd3['on']('sendMessageToUser',async({userId:_0xb5acf5,toUserId:_0x59a6ae,message:_0x2036a4})=>{const _0x394fbb=_0x2232fd,_0x28efbd=users[_0x59a6ae];let _0x145d5d=_0x28efbd;!_0x28efbd&&(_0x145d5d=await chat[_0x394fbb(0x248)](_0x59a6ae));if(_0x145d5d){const _0x2a1a9f=await chat[_0x394fbb(0x238)](_0xb5acf5,_0x59a6ae);await chat['send_new_message'](_0x2a1a9f,_0xb5acf5,_0x2036a4)&&(_0x28efbd&&io['to'](_0x28efbd)[_0x394fbb(0x18b)](_0x394fbb(0x18f),{'userId':_0xb5acf5,'message':_0x2036a4})),_0x4effd3[_0x394fbb(0x18b)](_0x394fbb(0x1b5),{'success':!![],'message':_0x394fbb(0x1f7)});}else _0x4effd3['emit']('messageStatus',{'success':![],'message':_0x394fbb(0x227)+_0x59a6ae+_0x394fbb(0x17b)});}),_0x4effd3['on'](_0x2232fd(0x19a),()=>{const _0x2890c9=_0x2232fd,{companyId:_0x37d62c}=_0x4effd3;_0x37d62c&&connectedEmployees[_0x37d62c]?(connectedEmployees[_0x37d62c]=connectedEmployees[_0x37d62c][_0x2890c9(0x225)](_0x141f91=>_0x141f91[_0x2890c9(0x19b)]!==_0x4effd3['id']),connectedEmployees[_0x37d62c][_0x2890c9(0x233)]===0x0&&delete connectedEmployees[_0x37d62c]):console[_0x2890c9(0x1d1)](_0x2890c9(0x243)+_0x4effd3['id']+_0x2890c9(0x1be));}),_0x4effd3['on']('sendNotification',_0x4188c1=>{const _0x12b094=_0x2232fd;console[_0x12b094(0x1d1)](_0x12b094(0x17f),_0x4188c1),_0x4effd3[_0x12b094(0x219)]['emit'](_0x12b094(0x252),_0x4188c1);});});const companyName=_0x4c69cc(0x19d);serverExpress[_0x4c69cc(0x218)](require(_0x4c69cc(0x240))),serverExpress['use'](require(_0x4c69cc(0x1bd))),serverExpress[_0x4c69cc(0x218)](companyName,require(_0x4c69cc(0x21e)));const routesPath=path['join'](__dirname,_0x4c69cc(0x23b));fs[_0x4c69cc(0x23d)](routesPath)[_0x4c69cc(0x224)](_0x556873=>{const _0x2afa54=_0x4c69cc,_0x42b7d1=path[_0x2afa54(0x188)](routesPath,_0x556873);fs[_0x2afa54(0x241)](_0x42b7d1)[_0x2afa54(0x179)]()&&_0x556873['endsWith'](_0x2afa54(0x174))&&serverExpress[_0x2afa54(0x218)](companyName,require(_0x42b7d1));}),serverExpress[_0x4c69cc(0x218)](require(_0x4c69cc(0x1b2))),serverExpress['use'](require(_0x4c69cc(0x1b2))),serverExpress[_0x4c69cc(0x218)](express[_0x4c69cc(0x1fd)](path[_0x4c69cc(0x188)](__dirname,_0x4c69cc(0x1db))));const os=require('os');function getLocalIP(){const _0x5cf9c4=_0x4c69cc,_0x427e11=os[_0x5cf9c4(0x1cc)]();for(let _0x287d70 in _0x427e11){for(let _0x48ff4c=0x0;_0x48ff4c<_0x427e11[_0x287d70][_0x5cf9c4(0x233)];_0x48ff4c++){const _0x2333b3=_0x427e11[_0x287d70][_0x48ff4c];if(_0x2333b3[_0x5cf9c4(0x177)]===_0x5cf9c4(0x21a)&&!_0x2333b3['internal'])return _0x2333b3[_0x5cf9c4(0x20c)];}}return _0x5cf9c4(0x1c7);}const axios=require(_0x4c69cc(0x1b8));async function get_answer_of_my_api(_0x4b1159,_0x15ca87){const _0x235336=_0x4c69cc,_0x5d03c8=path['join'](__dirname,_0x235336(0x1a8));fs[_0x235336(0x1f2)](_0x5d03c8,'ENTRE',_0x235336(0x1d5));try{const _0x209020=await axios[_0x235336(0x235)]('https://www.pluspuntodeventa.com/api/'+_0x4b1159,_0x15ca87,{'headers':{'Content-Type':_0x235336(0x24a)}});return fs[_0x235336(0x1f2)](_0x5d03c8,_0x235336(0x23c)+_0x209020[_0x235336(0x1ff)]+_0x235336(0x1af),_0x235336(0x1d5)),_0x209020;}catch(_0x440427){return fs[_0x235336(0x1f2)](_0x5d03c8,_0x235336(0x23c)+_0x440427['message']+'\x0a'+_0x440427[_0x235336(0x24d)]+'\x0a\x0a',_0x235336(0x1d5)),{'success':![],'message':_0x235336(0x244)};}}let mainWindow,activationWindow,loginWindow;const createMainWindow=()=>{const _0x3bd894=_0x4c69cc;mainWindow=new BrowserWindow({'width':0x320,'height':0x258}),mainWindow['maximize'](),mainWindow[_0x3bd894(0x189)](_0x3bd894(0x182)+serverExpress[_0x3bd894(0x20e)](_0x3bd894(0x169)));},createMainWindowRegister=()=>{const _0x480557=_0x4c69cc;loginWindow=new BrowserWindow({'width':0x320,'height':0x258,'parent':mainWindow,'webPreferences':{'preload':path[_0x480557(0x188)](__dirname,_0x480557(0x1d4)),'nodeIntegration':!![],'contextIsolation':![]}}),loginWindow[_0x480557(0x197)](),loginWindow[_0x480557(0x196)](path['join'](__dirname,_0x480557(0x205)));},{machineIdSync}=require('node-machine-id'),deviceId=machineIdSync();ipcMain['on'](_0x4c69cc(0x1e2),async _0x5db3a8=>{const _0x3b44f5=_0x4c69cc;console[_0x3b44f5(0x1d1)](_0x3b44f5(0x1cd)),_0x5db3a8[_0x3b44f5(0x1d2)](_0x3b44f5(0x1e4),deviceId);}),ipcMain['on']('update_data_of_the_token_in_this_drive',async(_0x1352b1,_0x451254)=>{const _0x4125e0=_0x4c69cc,_0x35fa57=_0x451254[_0x4125e0(0x1b0)];await initialize_token(_0x35fa57['token']),await create_expiration_date_of_the_token(_0x35fa57[_0x4125e0(0x170)]);const _0x423f4b=_0x4125e0(0x217);_0x1352b1[_0x4125e0(0x1d2)](_0x4125e0(0x1a1),_0x423f4b);}),ipcMain['on'](_0x4c69cc(0x246),async(_0x241139,_0x54b955)=>{const _0x3f7949=_0x4c69cc,_0x457618=_0x54b955[_0x3f7949(0x204)],_0x8e9876=await see_if_exist_this_token_in_the_database_of_the_web(_0x457618);if(_0x8e9876[_0x3f7949(0x204)]){let _0x58fbe9=!![];_0x8e9876[_0x3f7949(0x200)]&&(_0x8e9876['uuid']!==deviceId&&(_0x8e9876[_0x3f7949(0x207)]=_0x3f7949(0x16a),_0x58fbe9=![])),_0x58fbe9&&(await save_the_uui_of_the_user_in_the_database(_0x457618,deviceId)&&(await initialize_token(_0x457618),await create_expiration_date_of_the_token(_0x8e9876['activation_date']),_0x8e9876[_0x3f7949(0x207)]=_0x3f7949(0x217)));}_0x241139['reply'](_0x3f7949(0x21c),_0x8e9876[_0x3f7949(0x207)]);}),ipcMain['on']('login-from-render',async(_0x29cbda,_0x50660a)=>{const _0x12de95=_0x4c69cc,_0x3ab3ff=_0x50660a[_0x12de95(0x18d)],_0x3906fa=_0x50660a['password'],_0x1e7ebc=await see_if_exist_this_user_in_the_database_of_the_web(_0x3ab3ff,_0x3906fa);if(_0x1e7ebc[_0x12de95(0x204)]){if(_0x1e7ebc[_0x12de95(0x200)]&&_0x1e7ebc[_0x12de95(0x200)]!==deviceId)_0x1e7ebc[_0x12de95(0x207)]=_0x12de95(0x16a);else{if(await save_the_uui_of_the_user_in_the_database(_0x3ab3ff,deviceId)){}}}_0x29cbda[_0x12de95(0x1d2)]('answer-from-login-render',_0x1e7ebc[_0x12de95(0x207)]);});const bcrypt=require('bcrypt');async function see_if_exist_this_user_in_the_database_of_the_web(_0x27f9af,_0x57026c){const _0x24b142=_0x4c69cc;try{const _0x4bf138=await get_answer_of_my_api(_0x24b142(0x173),{'email':_0x27f9af});if(!_0x4bf138[_0x24b142(0x1ff)][_0x24b142(0x1a5)])return{'token':null,'message':_0x24b142(0x194)};const _0x14954b=_0x4bf138[_0x24b142(0x1ff)],_0x16631d=await bcrypt[_0x24b142(0x198)](_0x57026c,_0x14954b[_0x24b142(0x1ab)]);if(!_0x16631d)return{'token':null,'message':_0x24b142(0x18a)};const _0x4f9c93=await get_answer_of_my_api(_0x24b142(0x206),{'userId':_0x14954b['id']});if(_0x4f9c93['data']['success'])return{'token':null,'message':_0x24b142(0x1e8)};const _0x1ea535=_0x4f9c93[_0x24b142(0x1ff)],_0x5d67db=new Date();_0x5d67db['setFullYear'](_0x5d67db['getFullYear']()-0x1);if(new Date(_0x14954b['activation_date'])<_0x5d67db)return{'token':null,'message':_0x24b142(0x1e5)};return console[_0x24b142(0x1d1)](_0x24b142(0x23e)),{'token':_0x1ea535[_0x24b142(0x204)],'type_membresy':_0x1ea535[_0x24b142(0x1c6)],'message':_0x24b142(0x23e)};}catch(_0x4c6378){return console['error']('Error\x20al\x20verificar\x20usuario:',_0x4c6378),{'token':null};}}async function see_if_exist_this_token_in_the_database_of_the_web(_0x41ea50){const _0x5258c5=_0x4c69cc;try{const _0xc46acf=await get_answer_of_my_api(_0x5258c5(0x19f),{'token':_0x41ea50});if(!_0xc46acf[_0x5258c5(0x1ff)][_0x5258c5(0x1a5)])return{'token':null,'message':_0x5258c5(0x186)};const _0x309cd7=_0xc46acf[_0x5258c5(0x1ff)],_0x24542d=new Date();_0x309cd7[_0x5258c5(0x1c6)]==0x0?_0x24542d[_0x5258c5(0x236)](_0x24542d[_0x5258c5(0x1bc)]()-0x1e):_0x24542d[_0x5258c5(0x1a2)](_0x24542d[_0x5258c5(0x201)]()-0x1);if(_0x309cd7[_0x5258c5(0x199)]!='0000-00-00'&&new Date(_0x309cd7[_0x5258c5(0x199)])<_0x24542d)return{'token':null,'message':'Suscripción\x20expirada.\x20Por\x20favor,\x20vuelve\x20a\x20activar\x20tu\x20membresía.'};if(_0x309cd7[_0x5258c5(0x199)]===_0x5258c5(0x1e9)){const _0x27d113=new Date();_0x309cd7[_0x5258c5(0x1c6)]==0x0?_0x27d113[_0x5258c5(0x236)](_0x24542d[_0x5258c5(0x1bc)]()+0x1e):_0x27d113[_0x5258c5(0x1a2)](_0x27d113[_0x5258c5(0x201)]()+0x1);const _0x43652f=await get_answer_of_my_api(_0x5258c5(0x1c4),{'suscripcion':_0x27d113[_0x5258c5(0x232)]()[_0x5258c5(0x1d7)]('T')[0x0],'token':_0x41ea50});return _0x43652f[_0x5258c5(0x1ff)][_0x5258c5(0x1a5)]?(_0x309cd7[_0x5258c5(0x199)]=_0x27d113,console[_0x5258c5(0x1d1)](_0x5258c5(0x23e)),{'token':!![],'type_membresy':_0x309cd7[_0x5258c5(0x1c6)],'uuid':_0x309cd7[_0x5258c5(0x1d3)],'activation_date':_0x309cd7['activation_date'],'message':'Usuario\x20autenticado\x20con\x20éxito.'}):{'token':null,'message':'Ocurrio\x20un\x20error\x20al\x20verificar\x20tu\x20Token\x20en\x20el\x20ultimo\x20paso,\x20intentalo\x20otra\x20vez.'};}}catch(_0x4915c9){return console[_0x5258c5(0x21f)](_0x5258c5(0x1e3),_0x4915c9),{'token':null,'message':_0x4915c9};}}async function save_the_uui_of_the_user_in_the_database(_0x363cfc,_0x2eae91){const _0x3e3f0f=_0x4c69cc;try{const _0xa6ede=await get_answer_of_my_api(_0x3e3f0f(0x19f),{'token':_0x363cfc,'deviceId':_0x2eae91});return _0xa6ede[_0x3e3f0f(0x1ff)]['success'];}catch(_0x526fb0){return console[_0x3e3f0f(0x21f)](_0x3e3f0f(0x172),_0x526fb0),![];}}async function verificarTokenActivo(){const _0x435cff=_0x4c69cc,_0x3e5977=_0x435cff(0x1b3);try{const _0x2d0aa4=await pool['query'](_0x3e5977,[TOKEN]);return console[_0x435cff(0x1d1)](_0x2d0aa4[0x0]),_0x2d0aa4[0x0][_0x435cff(0x1f5)]===0x1?(console[_0x435cff(0x1d1)](_0x435cff(0x213)),!![]):(console['log']('El\x20token\x20no\x20está\x20activo\x20o\x20no\x20existe.'),![]);}catch(_0x106663){return console['error']('Error\x20al\x20verificar\x20el\x20token:',_0x106663),![];}}async function actualizarToken(){const _0x26c5bc=_0x4c69cc,_0x3c647c=_0x26c5bc(0x180);await pool[_0x26c5bc(0x16d)](_0x3c647c,[TOKEN]);}app['on'](_0x4c69cc(0x249),async()=>{const _0x282604=_0x4c69cc;await check_if_exist_updates();if(thiIsADemo){await initialize_demo();if(await is_demo_expired()){dialog[_0x282604(0x1df)]({'type':_0x282604(0x230),'title':_0x282604(0x1aa),'message':'Tu\x20demo\x20de\x2030\x20días\x20ha\x20expirado.\x20Por\x20favor,\x20compra\x20la\x20versión\x20completa\x20y\x20sigue\x20creciendo\x20con\x20ED\x20PLUS\x20🚀.'}),app[_0x282604(0x239)]();return;}}else await verify_membership_of_user()?(serverExpress[_0x282604(0x223)](serverExpress[_0x282604(0x20e)](_0x282604(0x169)),_0x282604(0x16c),()=>{const _0x5bc5bf=_0x282604;console['log'](_0x5bc5bf(0x1c3)+getLocalIP()+':'+serverExpress['get']('port'));}),createMainWindow()):createMainWindowRegister();}),app['on']('window-all-closed',()=>{const _0x36b499=_0x4c69cc;process[_0x36b499(0x211)]!==_0x36b499(0x1ce)&&app[_0x36b499(0x239)]();});