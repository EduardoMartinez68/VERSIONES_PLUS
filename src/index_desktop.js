const _0x50c5bb=_0x4a1a;(function(_0x3a736e,_0x7547c4){const _0x175b3d=_0x4a1a,_0xf1794e=_0x3a736e();while(!![]){try{const _0x3d8d43=-parseInt(_0x175b3d(0x207))/0x1+parseInt(_0x175b3d(0x1d6))/0x2+parseInt(_0x175b3d(0x1f1))/0x3+-parseInt(_0x175b3d(0x187))/0x4*(-parseInt(_0x175b3d(0x19d))/0x5)+parseInt(_0x175b3d(0x210))/0x6+-parseInt(_0x175b3d(0x1ad))/0x7+-parseInt(_0x175b3d(0x1e4))/0x8;if(_0x3d8d43===_0x7547c4)break;else _0xf1794e['push'](_0xf1794e['shift']());}catch(_0x25b756){_0xf1794e['push'](_0xf1794e['shift']());}}}(_0x560b,0x239da));const system=require('./lib/system'),thiIsADemo=![],{app,BrowserWindow,dialog,ipcMain}=require(_0x50c5bb(0x1b9)),express=require('express'),morgan=require('morgan'),{engine}=require(_0x50c5bb(0x184)),multer=require('multer'),flash=require('connect-flash'),session=require(_0x50c5bb(0x1c4)),passport=require(_0x50c5bb(0x192)),{database}=require('./keys'),{v4:uuid}=require('uuid'),path=require(_0x50c5bb(0x1f9)),{RecaptchaV2}=require('express-recaptcha'),nodePersist=require(_0x50c5bb(0x1ef));nodePersist[_0x50c5bb(0x1f8)]({'dir':path[_0x50c5bb(0x1b6)](__dirname,'data')});async function initialize_software(){const _0x2beea0=_0x50c5bb,_0x27820a=await nodePersist[_0x2beea0(0x1e5)]('installToken');!_0x27820a&&await nodePersist['set']('installToken',_0x2beea0(0x242));}async function the_software_have_a_token(){const _0x42b41d=_0x50c5bb,_0x527615=await nodePersist[_0x42b41d(0x1e5)](_0x42b41d(0x1a9));if(!_0x527615)return![];return _0x527615!=_0x42b41d(0x242);}async function create_expiration_date_of_the_token(_0x213917){const _0x2e52bb=_0x50c5bb,_0x592280=await nodePersist[_0x2e52bb(0x1e5)]('expirationDateOFTheToken');!_0x592280&&await nodePersist['set'](_0x2e52bb(0x23b),_0x213917);}async function token_expired(){const _0x5939de=_0x50c5bb,_0x129e64=await nodePersist[_0x5939de(0x1e5)]('expirationDateOFTheToken'),_0x1b3d5f=new Date(_0x129e64),_0x35d53a=new Date();return _0x35d53a<_0x1b3d5f;}function _0x560b(){const _0xed0c30=['darwin','reset','extname','update_activation_date.php','get_max_employee_of_this_company','flash','false','0.0.0.0','ENTRE','get_the_first_notification','Usuario\x20autenticado\x20con\x20éxito.','addRemote','emit','privateMessage','toISOString','\x27\x20no\x20existe\x20🤔','catch','send_new_message','env','token','newNotification','main','https://www.pluspuntodeventa.com/api/','❌\x20Error\x20ejecutando\x20SQL:','appendFileSync','removeItem','pack_company','Error\x20verificando\x20actualizaciones:\x20','Tu\x20demo\x20de\x2030\x20días\x20ha\x20expirado.\x20Por\x20favor,\x20compra\x20la\x20versión\x20completa\x20y\x20sigue\x20creciendo\x20con\x20ED\x20PLUS\x20🚀.','query','username','info','readdirSync','dataToken','success','127.0.0.1','✅\x20SQL\x20ejecutado\x20correctamente','relaunch','crypto','express-handlebars','setFullYear','La\x20demo\x20aún\x20está\x20activa.','143372hLLLhd','disconnect','messageStatus','socket.io','installDate','PORT','latest','installDemo','La\x20demo\x20ha\x20expirado.','ENCRYPTION_KEY=','📥\x20Petición\x20recibida\x20para\x20obtener\x20el\x20deviceId','passport','bcrypt','canSend','listen','Datos\x20actualizados\x20con\x20éxito.\x20Cierra\x20y\x20vuelve\x20a\x20abrir\x20el\x20programa\x20😄','showMessageBoxSync','family','hash','Error\x20verificando\x20actualizaciones!','./lib/addFrom','split','35yxBfKT','compare','Token\x20no\x20encontrado.','Server\x20running\x20on\x20http://','No\x20pudimos\x20enviar\x20el\x20mensaje\x20al\x20usuario\x20\x27','length','log','see_if_exist_this_token_in_the_database_of_the_web.php','readFileSync','registerUser','warning','setDate','installToken','writeFileSync','originalname','CREATE\x20DATABASE\x20EDPLUS','543732RiMUVS','database','Fecha\x20de\x20instalación\x20guardada:','static','./router','Suscripción\x20expirada.\x20Por\x20favor,\x20vuelve\x20a\x20activar\x20tu\x20membresía.','login-from-render','connection','use','join','../../../.env','companyId','electron','Ups,\x20parece\x20que\x20ya\x20estás\x20conectado\x20en\x20otro\x20dispositivo.','desktop','Mensaje\x20enviado\x20con\x20éxito','Se\x20ha\x20descargado\x20una\x20nueva\x20versión.\x20Reinicia\x20la\x20aplicación\x20para\x20aplicar\x20los\x20cambios.','address','statSync','pull','data','./characterDatabase','http://localhost:','express-session','rowCount','--hard','trim','pack_branch','connectionRejected','release','sendNotificationToUser','Error\x20al\x20verificar\x20usuario:','createServer','🔄\x20Nueva\x20versión\x20encontrada,\x20actualizando...','set','reply','stack','🔐\x20ENCRYPTION_KEY\x20ya\x20existe\x20en\x20.env','uuid','answer_get_my_deviceId','preload.js','87986YCqZiP','isFile','resolve','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20*\x20FROM\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','message','connect-pg-simple','login-from-render-token','.js','Socket\x20','get_my_deviceId','Este\x20usuario\x20ya\x20tiene\x20un\x20TOKEN\x20registrado\x20en\x20un\x20equipo.','then','partials','window-all-closed','2855088KgCbdX','get','hex','edplus.sql','answer-from-login-render','Hubo\x20un\x20error\x20al\x20hacer\x20la\x20solicitud.','./lib/passport','dotenv','active','simple-git','urlencoded','node-persist','privateNotifications','331392WjwaZG','sendMessageToUser','maximize','port','get_data_of_the_token_with_the_user_id.php','activation_date','expiration_date','init','path','locals','includes','socketId','this_email_exist','✅\x20ENCRYPTION_KEY\x20generado\x20y\x20guardado\x20en\x20.env','utf8','company','update_data_of_the_token_in_this_drive','some','user','getTheFirstTenNotifications','Este\x20usuario\x20no\x20tiene\x20ningun\x20Token\x20activo.','diskStorage','21557iMDEfz','postgres','type_membresy','./router/authentication','Repositorio\x20remoto\x20configurado\x20correctamente','json','\x27\x20no\x20existe.\x20🤔','toString','forEach','1179858xcPgGs','Pool','getDate','filter','/main','engine','device_id','sendNotification','internal','Contraseña\x20incorrecta.','https://github.com/EduardoMartinez68/VERSIONES_PLUS','Este\x20email\x20\x27','logfile.txt','application/json','connect','initialize','IPv4','./lib/editFrom','session','loadFile','Ups,\x20parece\x20que\x20alcanzaste\x20tu\x20límite\x20de\x20dispositivos\x20conectados.\x20Por\x20favor,\x20actualiza\x20tu\x20membresía.','✅\x20La\x20aplicación\x20ya\x20está\x20actualizada.','📦\x20Base\x20de\x20datos\x20EDPLUS\x20creada','view\x20engine','map','public/img/uploads','getFullYear','Token\x20encontrado\x20y\x20activo.','Usuario\x20no\x20encontrado.','password','error','views','\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SET\x20active\x20=\x20false\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','./lib/handlebars','Reiniciar\x20ahora','Ocurrio\x20un\x20error\x20al\x20verificar\x20tu\x20Token\x20en\x20el\x20ultimo\x20paso,\x20intentalo\x20otra\x20vez.','📂\x20La\x20base\x20de\x20datos\x20EDPLUS\x20ya\x20existe,\x20no\x20se\x20creó\x20nuevamente.','SELECT\x201\x20FROM\x20pg_database\x20WHERE\x20datname\x20=\x20\x27edplus\x27','config','userId','quit','0000-00-00','hashedPassword','expirationDateOFTheToken'];_0x560b=function(){return _0xed0c30;};return _0x560b();}async function remove_install_token(){const _0x192337=_0x50c5bb;await nodePersist[_0x192337(0x255)](_0x192337(0x1a9)),await nodePersist[_0x192337(0x255)](_0x192337(0x23b)),console[_0x192337(0x1a3)]('installToken\x20eliminado');}async function initialize_token(_0x4379ec){const _0xacffa2=_0x50c5bb,_0x1ff2b9=await nodePersist['get'](_0xacffa2(0x1a9));await nodePersist[_0xacffa2(0x1cf)](_0xacffa2(0x1a9),_0x4379ec);}async function initialize_demo(){const _0x211b36=_0x50c5bb,_0x372356=await nodePersist[_0x211b36(0x1e5)]('installDemo');if(!_0x372356){const _0x2e1f4b=new Date()['toISOString']();await nodePersist[_0x211b36(0x1cf)](_0x211b36(0x18b),_0x2e1f4b),console['log'](_0x211b36(0x1af),_0x2e1f4b);}else console[_0x211b36(0x1a3)]('Fecha\x20de\x20instalación\x20existente:',_0x372356);}async function is_demo_expired(){const _0x1a0915=_0x50c5bb,_0x4174c3=await nodePersist['get'](_0x1a0915(0x18e));if(!_0x4174c3)return console[_0x1a0915(0x1a3)]('No\x20se\x20encontró\x20la\x20fecha\x20de\x20instalación'),![];const _0x4eeff0=new Date(_0x4174c3),_0x375872=new Date(),_0x2e7b7d=_0x375872-_0x4eeff0,_0xc5a264=_0x2e7b7d/(0x3e8*0x3c*0x3c*0x18);return _0xc5a264>0x1e?(console[_0x1a0915(0x1a3)](_0x1a0915(0x18f)),!![]):(console[_0x1a0915(0x1a3)](_0x1a0915(0x186)),![]);}async function this_software_count_have_a_count(){}async function the_user_have_a_token_active_in_the_database(){}async function verify_membership_of_user(){initialize_software();if(await the_software_have_a_token())return await token_expired();return![];}const simpleGit=require(_0x50c5bb(0x1ed)),fs=require('fs'),repoPath=path[_0x50c5bb(0x1b6)](__dirname),git=simpleGit(repoPath),repoURL=_0x50c5bb(0x21a),remote='origin';git[_0x50c5bb(0x247)](remote,repoURL)[_0x50c5bb(0x1e1)](()=>{const _0x2a6399=_0x50c5bb;console['log'](_0x2a6399(0x20b));})[_0x50c5bb(0x24c)](_0x3ac8ce=>{const _0x59dc41=_0x50c5bb;console[_0x59dc41(0x22e)]('Error\x20al\x20agregar\x20el\x20repositorio\x20remoto',_0x3ac8ce);});async function check_if_exist_updates(){const _0x35156a=_0x50c5bb;try{await git['fetch'](remote);const _0x3a4f4a=await git['log']([remote+_0x35156a(0x214),'-1']),_0x2d5941=await git[_0x35156a(0x1a3)](['HEAD','-1']);_0x3a4f4a[_0x35156a(0x18d)][_0x35156a(0x199)]!==_0x2d5941[_0x35156a(0x18d)][_0x35156a(0x199)]?(console[_0x35156a(0x1a3)](_0x35156a(0x1ce)),await git['raw']([_0x35156a(0x23d),_0x35156a(0x1c6),remote+_0x35156a(0x214)]),await git[_0x35156a(0x1c0)]('origin',_0x35156a(0x251),{'--rebase':null}),dialog[_0x35156a(0x197)]({'type':_0x35156a(0x25b),'title':'Actualización','message':_0x35156a(0x1bd),'buttons':[_0x35156a(0x232)]}),app[_0x35156a(0x182)](),app[_0x35156a(0x238)]()):console[_0x35156a(0x1a3)](_0x35156a(0x225));}catch(_0x4d0e31){const _0x326e5c=path[_0x35156a(0x1b6)](__dirname,_0x35156a(0x21c));fs[_0x35156a(0x254)](_0x326e5c,_0x35156a(0x257)+_0x4d0e31['message']+'\x0a'+_0x4d0e31[_0x35156a(0x1d1)]+'\x0a\x0a',_0x35156a(0x1ff)),console[_0x35156a(0x22e)]('❌\x20Error\x20verificando\x20actualizaciones:',_0x4d0e31),dialog[_0x35156a(0x197)]({'type':_0x35156a(0x1a7),'title':_0x35156a(0x19a),'message':_0x35156a(0x257)+_0x4d0e31[_0x35156a(0x1da)]+'\x0a'+_0x4d0e31[_0x35156a(0x1d1)]+'\x0a\x0a'});}}const serverExpress=express();require(_0x50c5bb(0x1ea)),require(_0x50c5bb(0x221)),serverExpress['set']('port',process[_0x50c5bb(0x24e)][_0x50c5bb(0x18c)]||0xfa0),serverExpress['set'](_0x50c5bb(0x22f),path[_0x50c5bb(0x1b6)](__dirname,_0x50c5bb(0x22f))),serverExpress[_0x50c5bb(0x215)]('.hbs',engine({'defaultLayout':_0x50c5bb(0x251),'layoutsDir':path[_0x50c5bb(0x1b6)](serverExpress[_0x50c5bb(0x1e5)]('views'),'layouts'),'partialsDir':path[_0x50c5bb(0x1b6)](serverExpress[_0x50c5bb(0x1e5)](_0x50c5bb(0x22f)),_0x50c5bb(0x1e2)),'extname':'.hbs','helpers':require(_0x50c5bb(0x231))})),serverExpress['set'](_0x50c5bb(0x227),'.hbs');const crypto=require(_0x50c5bb(0x183)),envPath=path[_0x50c5bb(0x1d8)](__dirname,_0x50c5bb(0x1b7));let envContent=fs['existsSync'](envPath)?fs[_0x50c5bb(0x1a5)](envPath,'utf8'):'';if(!envContent[_0x50c5bb(0x1fb)](_0x50c5bb(0x190))){const newKey=crypto['randomBytes'](0x20)[_0x50c5bb(0x20e)](_0x50c5bb(0x1e6));envContent+='\x0aENCRYPTION_KEY='+newKey+'\x0a',fs[_0x50c5bb(0x1aa)](envPath,envContent),console[_0x50c5bb(0x1a3)](_0x50c5bb(0x1fe));}else console['log'](_0x50c5bb(0x1d2));require(_0x50c5bb(0x1eb))[_0x50c5bb(0x236)]();const {APP_PG_USER,APP_PG_HOST,APP_PG_DATABASE,APP_PG_PASSWORD,APP_PG_PORT,TOKEN}=process['env'],pg=require('pg'),adminPool=new pg[(_0x50c5bb(0x211))]({'user':APP_PG_USER,'host':APP_PG_HOST,'password':APP_PG_PASSWORD,'port':APP_PG_PORT,'database':_0x50c5bb(0x208)}),importSQLFile=async _0x348543=>{const _0x418810=_0x50c5bb,_0x7ce16f=path[_0x418810(0x1b6)](__dirname,_0x418810(0x1ae),_0x418810(0x1e7)),_0x3d50b9=fs[_0x418810(0x1a5)](_0x7ce16f,'utf8'),_0x430cd1=_0x3d50b9[_0x418810(0x19c)](/;\s*$/m)[_0x418810(0x228)](_0x21caef=>_0x21caef[_0x418810(0x1c7)]())['filter'](_0x397ec0=>_0x397ec0[_0x418810(0x1a2)]>0x0),_0x4cea46=await _0x348543[_0x418810(0x21e)]();try{for(const _0x30b2d0 of _0x430cd1){await _0x4cea46[_0x418810(0x259)](_0x30b2d0);}console[_0x418810(0x1a3)](_0x418810(0x181));}catch(_0x4918f2){console[_0x418810(0x22e)](_0x418810(0x253),_0x4918f2[_0x418810(0x1da)]);}finally{_0x4cea46[_0x418810(0x1ca)]();}},{create_update_of_the_database}=require(_0x50c5bb(0x1c2)),createDatabase=async()=>{const _0x26af87=_0x50c5bb,_0x276eaa=await adminPool[_0x26af87(0x259)](_0x26af87(0x235));_0x276eaa[_0x26af87(0x1c5)]===0x0?(await adminPool[_0x26af87(0x259)](_0x26af87(0x1ac)),importSQLFile(adminPool),console[_0x26af87(0x1a3)](_0x26af87(0x226))):(console[_0x26af87(0x1a3)](_0x26af87(0x234)),await create_update_of_the_database(adminPool));};createDatabase();const pgPool=new pg[(_0x50c5bb(0x211))]({'user':APP_PG_USER,'host':APP_PG_HOST,'database':APP_PG_DATABASE,'password':APP_PG_PASSWORD,'port':APP_PG_PORT});serverExpress[_0x50c5bb(0x1b5)](session({'secret':'FudSession','resave':![],'saveUninitialized':![],'store':new(require(_0x50c5bb(0x1db))(session))({'pool':pgPool,'tableName':_0x50c5bb(0x222)})})),serverExpress['use'](flash()),serverExpress[_0x50c5bb(0x1b5)](morgan('dev')),serverExpress['use'](express[_0x50c5bb(0x1ee)]({'extended':![]})),serverExpress[_0x50c5bb(0x1b5)](express[_0x50c5bb(0x20c)]()),serverExpress[_0x50c5bb(0x1b5)](passport[_0x50c5bb(0x21f)]()),serverExpress[_0x50c5bb(0x1b5)](passport[_0x50c5bb(0x222)]());const storage=multer[_0x50c5bb(0x206)]({'destination':path[_0x50c5bb(0x1b6)](__dirname,_0x50c5bb(0x229)),'filename':(_0x200812,_0x212c8b,_0x201b16,_0x232ec4)=>{const _0x4a2219=_0x50c5bb;_0x201b16(null,uuid()+path[_0x4a2219(0x23e)](_0x212c8b[_0x4a2219(0x1ab)]));}});serverExpress[_0x50c5bb(0x1b5)](multer({'storage':storage})['single']('image')),serverExpress['use']((_0x5d96e2,_0x1b8e99,_0x537f7d)=>{const _0x3110bf=_0x50c5bb;serverExpress[_0x3110bf(0x1fa)]['success']=_0x5d96e2['flash']('success'),serverExpress[_0x3110bf(0x1fa)]['message']=_0x5d96e2[_0x3110bf(0x241)]('message'),serverExpress[_0x3110bf(0x1fa)][_0x3110bf(0x203)]=_0x5d96e2[_0x3110bf(0x203)],serverExpress[_0x3110bf(0x1fa)][_0x3110bf(0x200)]=_0x5d96e2[_0x3110bf(0x200)],serverExpress[_0x3110bf(0x1fa)][_0x3110bf(0x256)]=0x0,serverExpress[_0x3110bf(0x1fa)][_0x3110bf(0x1c8)]=0x0,_0x537f7d();});const http=require('http'),server=http[_0x50c5bb(0x1cd)](serverExpress),{Server}=require(_0x50c5bb(0x18a)),io=new Server(server),users={},connectedEmployees={},companyLimitsCache={},chat=require('./services/chat.js');io['on'](_0x50c5bb(0x1b4),async _0x4ddda5=>{const _0x2247ae=_0x50c5bb;_0x4ddda5['on'](_0x2247ae(0x1a6),async(_0xfdee9b,_0x1d0286)=>{const _0x12b92e=_0x2247ae,_0x53a90f=connectedEmployees[_0x1d0286]||[],_0x2e886d=_0x53a90f[_0x12b92e(0x202)](_0x4c808d=>_0x4c808d[_0x12b92e(0x237)]===_0xfdee9b);if(_0x2e886d){_0x4ddda5[_0x12b92e(0x248)](_0x12b92e(0x1c9),_0x12b92e(0x1ba));return;}if(system!=_0x12b92e(0x1bb)){!companyLimitsCache[_0x1d0286]&&(companyLimitsCache[_0x1d0286]=await chat[_0x12b92e(0x240)](_0x1d0286));const _0x35c620=companyLimitsCache[_0x1d0286];if(_0x53a90f[_0x12b92e(0x1a2)]>=_0x35c620){_0x4ddda5[_0x12b92e(0x248)]('connectionRejected',_0x12b92e(0x224));return;}}_0x4ddda5[_0x12b92e(0x1b8)]=_0x1d0286,_0x53a90f['push']({'userId':_0xfdee9b,'socketId':_0x4ddda5['id']}),connectedEmployees[_0x1d0286]=_0x53a90f;const _0x3ad32b=await chat[_0x12b92e(0x245)](_0xfdee9b,0xa);io['to'](_0xfdee9b)[_0x12b92e(0x248)](_0x12b92e(0x1f0),{'notifications':_0x3ad32b});});async function _0x4b510d(_0x571055){const _0x3ab9a2=_0x2247ae,_0x232248=users[_0x571055];let _0x39a385=_0x232248;!_0x232248&&(_0x39a385=await chat[_0x3ab9a2(0x1fd)](toUserId));const _0x140a1d={'canSend':_0x39a385,'theUserIsConnect':_0x232248};return _0x140a1d;}_0x4ddda5['on'](_0x2247ae(0x1cb),async({userEmail:_0x15f6e5,toUserEmail:_0x5e20b3,message:_0x14bdba})=>{const _0x40454b=_0x2247ae,_0x3bc726=await _0x4b510d(_0x5e20b3);_0x3bc726[_0x40454b(0x194)]?await chat['create_notification'](_0x15f6e5,_0x5e20b3,_0x14bdba)?(_0x3bc726['theUserIsConnect']&&io['to'](recipientSocketId)[_0x40454b(0x248)](_0x40454b(0x249),{'userId':userId,'message':_0x14bdba}),_0x4ddda5[_0x40454b(0x248)](_0x40454b(0x189),{'success':!![],'message':'Mensaje\x20enviado\x20con\x20éxito.\x20👌'})):_0x4ddda5[_0x40454b(0x248)](_0x40454b(0x189),{'success':![],'message':_0x40454b(0x1a1)+_0x5e20b3+'\x27.\x20Inténtalo\x20de\x20nuevo.\x20😳'}):_0x4ddda5[_0x40454b(0x248)](_0x40454b(0x189),{'success':![],'message':'El\x20usuario\x20\x27'+_0x5e20b3+_0x40454b(0x20d)});}),_0x4ddda5['on'](_0x2247ae(0x204),async({userEmail:_0x5ac8e5})=>{const _0x36d4c4=_0x2247ae,_0x466b82=await chat[_0x36d4c4(0x245)](_0x5ac8e5,0xa);io['to'](recipientSocketId)[_0x36d4c4(0x248)](_0x36d4c4(0x1f0),{'notifications':_0x466b82});}),_0x4ddda5['on'](_0x2247ae(0x1f2),async({userId:_0x5ed4de,toUserId:_0x109a19,message:_0x490fc0})=>{const _0x37f577=_0x2247ae,_0x3d1a7a=users[_0x109a19];let _0x515ecf=_0x3d1a7a;!_0x3d1a7a&&(_0x515ecf=await chat[_0x37f577(0x1fd)](_0x109a19));if(_0x515ecf){const _0x2952af=await chat['create_new_chat'](_0x5ed4de,_0x109a19);await chat[_0x37f577(0x24d)](_0x2952af,_0x5ed4de,_0x490fc0)&&(_0x3d1a7a&&io['to'](_0x3d1a7a)['emit']('privateMessage',{'userId':_0x5ed4de,'message':_0x490fc0})),_0x4ddda5[_0x37f577(0x248)]('messageStatus',{'success':!![],'message':_0x37f577(0x1bc)});}else _0x4ddda5[_0x37f577(0x248)](_0x37f577(0x189),{'success':![],'message':_0x37f577(0x21b)+_0x109a19+_0x37f577(0x24b)});}),_0x4ddda5['on'](_0x2247ae(0x188),()=>{const _0x21c94f=_0x2247ae,{companyId:_0x2420e2}=_0x4ddda5;_0x2420e2&&connectedEmployees[_0x2420e2]?(connectedEmployees[_0x2420e2]=connectedEmployees[_0x2420e2][_0x21c94f(0x213)](_0x2375f9=>_0x2375f9[_0x21c94f(0x1fc)]!==_0x4ddda5['id']),connectedEmployees[_0x2420e2]['length']===0x0&&delete connectedEmployees[_0x2420e2]):console['log'](_0x21c94f(0x1de)+_0x4ddda5['id']+'\x20desconectado,\x20pero\x20no\x20estaba\x20asociado\x20a\x20ninguna\x20empresa.');}),_0x4ddda5['on'](_0x2247ae(0x217),_0x2a6a7e=>{const _0x22ce7c=_0x2247ae;console['log']('Nueva\x20notificación:',_0x2a6a7e),_0x4ddda5['broadcast'][_0x22ce7c(0x248)](_0x22ce7c(0x250),_0x2a6a7e);});});const companyName='/links';serverExpress['use'](require(_0x50c5bb(0x1b1))),serverExpress[_0x50c5bb(0x1b5)](require(_0x50c5bb(0x20a))),serverExpress[_0x50c5bb(0x1b5)](companyName,require('./router/links'));const routesPath=path[_0x50c5bb(0x1b6)](__dirname,'router/links');fs[_0x50c5bb(0x17d)](routesPath)[_0x50c5bb(0x20f)](_0x5ca854=>{const _0x5bdb5d=_0x50c5bb,_0x5d41ea=path[_0x5bdb5d(0x1b6)](routesPath,_0x5ca854);fs[_0x5bdb5d(0x1bf)](_0x5d41ea)[_0x5bdb5d(0x1d7)]()&&_0x5ca854['endsWith'](_0x5bdb5d(0x1dd))&&serverExpress[_0x5bdb5d(0x1b5)](companyName,require(_0x5d41ea));}),serverExpress[_0x50c5bb(0x1b5)](require(_0x50c5bb(0x19b))),serverExpress[_0x50c5bb(0x1b5)](require(_0x50c5bb(0x19b))),serverExpress[_0x50c5bb(0x1b5)](express[_0x50c5bb(0x1b0)](path[_0x50c5bb(0x1b6)](__dirname,'public')));const os=require('os');function getLocalIP(){const _0x2aaa2b=_0x50c5bb,_0x1b8683=os['networkInterfaces']();for(let _0x2cc4fc in _0x1b8683){for(let _0x50b797=0x0;_0x50b797<_0x1b8683[_0x2cc4fc][_0x2aaa2b(0x1a2)];_0x50b797++){const _0x48c5a5=_0x1b8683[_0x2cc4fc][_0x50b797];if(_0x48c5a5[_0x2aaa2b(0x198)]===_0x2aaa2b(0x220)&&!_0x48c5a5[_0x2aaa2b(0x218)])return _0x48c5a5[_0x2aaa2b(0x1be)];}}return _0x2aaa2b(0x180);}const axios=require('axios');function _0x4a1a(_0x55784e,_0x2cc73a){const _0x560b4f=_0x560b();return _0x4a1a=function(_0x4a1a02,_0x197d96){_0x4a1a02=_0x4a1a02-0x17d;let _0x54c139=_0x560b4f[_0x4a1a02];return _0x54c139;},_0x4a1a(_0x55784e,_0x2cc73a);}async function get_answer_of_my_api(_0x1cd365,_0x542cb8){const _0x53f450=_0x50c5bb,_0x50e298=path[_0x53f450(0x1b6)](__dirname,_0x53f450(0x21c));fs[_0x53f450(0x254)](_0x50e298,_0x53f450(0x244),_0x53f450(0x1ff));try{const _0xa9d6b0=await axios['post'](_0x53f450(0x252)+_0x1cd365,_0x542cb8,{'headers':{'Content-Type':_0x53f450(0x21d)}});return fs[_0x53f450(0x254)](_0x50e298,'Error\x20verificando\x20actualizaciones:\x20'+_0xa9d6b0[_0x53f450(0x1c1)]+'\x0a\x0a\x0a',_0x53f450(0x1ff)),_0xa9d6b0;}catch(_0x2c3930){return fs[_0x53f450(0x254)](_0x50e298,'Error\x20verificando\x20actualizaciones:\x20'+_0x2c3930[_0x53f450(0x1da)]+'\x0a'+_0x2c3930[_0x53f450(0x1d1)]+'\x0a\x0a',_0x53f450(0x1ff)),{'success':![],'message':_0x53f450(0x1e9)};}}let mainWindow,activationWindow,loginWindow;const createMainWindow=()=>{const _0x3e2b2d=_0x50c5bb;mainWindow=new BrowserWindow({'width':0x320,'height':0x258}),mainWindow[_0x3e2b2d(0x1f3)](),mainWindow['loadURL'](_0x3e2b2d(0x1c3)+serverExpress['get']('port'));},createMainWindowRegister=()=>{const _0x48b171=_0x50c5bb;loginWindow=new BrowserWindow({'width':0x320,'height':0x258,'parent':mainWindow,'webPreferences':{'preload':path[_0x48b171(0x1b6)](__dirname,_0x48b171(0x1d5)),'nodeIntegration':!![],'contextIsolation':![]}}),loginWindow['maximize'](),loginWindow[_0x48b171(0x223)](path[_0x48b171(0x1b6)](__dirname,'activation.html'));},{machineIdSync}=require('node-machine-id'),deviceId=machineIdSync();ipcMain['on'](_0x50c5bb(0x1df),async _0x506a3a=>{const _0x2312e8=_0x50c5bb;console['log'](_0x2312e8(0x191)),_0x506a3a[_0x2312e8(0x1d0)](_0x2312e8(0x1d4),deviceId);}),ipcMain['on'](_0x50c5bb(0x201),async(_0x3307af,_0x299472)=>{const _0x34072e=_0x50c5bb,_0xb364cc=_0x299472[_0x34072e(0x17e)];await initialize_token(_0xb364cc[_0x34072e(0x24f)]),await create_expiration_date_of_the_token(_0xb364cc[_0x34072e(0x1f7)]);const _0x136040=_0x34072e(0x196);_0x3307af[_0x34072e(0x1d0)]('update_data_of_the_token_in_this_drive',_0x136040);}),ipcMain['on'](_0x50c5bb(0x1dc),async(_0x28b815,_0x3a4b0e)=>{const _0x897734=_0x50c5bb,_0x88720e=_0x3a4b0e[_0x897734(0x24f)],_0x517d50=await see_if_exist_this_token_in_the_database_of_the_web(_0x88720e);if(_0x517d50[_0x897734(0x24f)]){let _0x49bcdb=!![];_0x517d50[_0x897734(0x1d3)]&&(_0x517d50[_0x897734(0x1d3)]!==deviceId&&(_0x517d50[_0x897734(0x1da)]=_0x897734(0x1e0),_0x49bcdb=![])),_0x49bcdb&&(await save_the_uui_of_the_user_in_the_database(_0x88720e,deviceId)&&(await initialize_token(_0x88720e),await create_expiration_date_of_the_token(_0x517d50[_0x897734(0x1f6)]),_0x517d50[_0x897734(0x1da)]=_0x897734(0x196)));}_0x28b815[_0x897734(0x1d0)]('answer-from-login-render-token',_0x517d50[_0x897734(0x1da)]);}),ipcMain['on'](_0x50c5bb(0x1b3),async(_0xe036b4,_0x3699d6)=>{const _0x233d1c=_0x50c5bb,_0x2c5422=_0x3699d6[_0x233d1c(0x25a)],_0x192701=_0x3699d6[_0x233d1c(0x22d)],_0xe832b5=await see_if_exist_this_user_in_the_database_of_the_web(_0x2c5422,_0x192701);if(_0xe832b5['token']){if(_0xe832b5[_0x233d1c(0x1d3)]&&_0xe832b5[_0x233d1c(0x1d3)]!==deviceId)_0xe832b5[_0x233d1c(0x1da)]='Este\x20usuario\x20ya\x20tiene\x20un\x20TOKEN\x20registrado\x20en\x20un\x20equipo.';else{if(await save_the_uui_of_the_user_in_the_database(_0x2c5422,deviceId)){}}}_0xe036b4[_0x233d1c(0x1d0)](_0x233d1c(0x1e8),_0xe832b5['message']);});const bcrypt=require(_0x50c5bb(0x193));async function see_if_exist_this_user_in_the_database_of_the_web(_0x2a0f84,_0x41bfbf){const _0xd8a544=_0x50c5bb;try{const _0x5bd05a=await get_answer_of_my_api('get_information_of_the_user.php',{'email':_0x2a0f84});if(!_0x5bd05a[_0xd8a544(0x1c1)][_0xd8a544(0x17f)])return{'token':null,'message':_0xd8a544(0x22c)};const _0x454297=_0x5bd05a[_0xd8a544(0x1c1)],_0x2fb3de=await bcrypt[_0xd8a544(0x19e)](_0x41bfbf,_0x454297[_0xd8a544(0x23a)]);if(!_0x2fb3de)return{'token':null,'message':_0xd8a544(0x219)};const _0x5edfc2=await get_answer_of_my_api(_0xd8a544(0x1f5),{'userId':_0x454297['id']});if(_0x5edfc2[_0xd8a544(0x1c1)]['success'])return{'token':null,'message':_0xd8a544(0x205)};const _0x56c698=_0x5edfc2[_0xd8a544(0x1c1)],_0x2216b9=new Date();_0x2216b9[_0xd8a544(0x185)](_0x2216b9[_0xd8a544(0x22a)]()-0x1);if(new Date(_0x454297[_0xd8a544(0x1f6)])<_0x2216b9)return{'token':null,'message':_0xd8a544(0x1b2)};return console[_0xd8a544(0x1a3)](_0xd8a544(0x246)),{'token':_0x56c698['token'],'type_membresy':_0x56c698[_0xd8a544(0x209)],'message':_0xd8a544(0x246)};}catch(_0x492060){return console[_0xd8a544(0x22e)](_0xd8a544(0x1cc),_0x492060),{'token':null};}}async function see_if_exist_this_token_in_the_database_of_the_web(_0x1f4086){const _0x3bf267=_0x50c5bb;try{const _0xf0d269=await get_answer_of_my_api(_0x3bf267(0x1a4),{'token':_0x1f4086});if(!_0xf0d269[_0x3bf267(0x1c1)][_0x3bf267(0x17f)])return{'token':null,'message':_0x3bf267(0x19f)};const _0x2803ae=_0xf0d269[_0x3bf267(0x1c1)],_0x4f0cec=new Date();_0x2803ae[_0x3bf267(0x209)]==0x0?_0x4f0cec[_0x3bf267(0x1a8)](_0x4f0cec[_0x3bf267(0x212)]()-0x1e):_0x4f0cec[_0x3bf267(0x185)](_0x4f0cec[_0x3bf267(0x22a)]()-0x1);if(_0x2803ae[_0x3bf267(0x1f6)]!=_0x3bf267(0x239)&&new Date(_0x2803ae[_0x3bf267(0x1f6)])<_0x4f0cec)return{'token':null,'message':_0x3bf267(0x1b2)};if(_0x2803ae[_0x3bf267(0x1f6)]===_0x3bf267(0x239)){const _0x5b8dad=new Date();_0x2803ae['type_membresy']==0x0?_0x5b8dad[_0x3bf267(0x1a8)](_0x4f0cec['getDate']()+0x1e):_0x5b8dad['setFullYear'](_0x5b8dad[_0x3bf267(0x22a)]()+0x1);const _0x5b55a0=await get_answer_of_my_api(_0x3bf267(0x23f),{'suscripcion':_0x5b8dad[_0x3bf267(0x24a)]()[_0x3bf267(0x19c)]('T')[0x0],'token':_0x1f4086});return _0x5b55a0[_0x3bf267(0x1c1)][_0x3bf267(0x17f)]?(_0x2803ae[_0x3bf267(0x1f6)]=_0x5b8dad,console[_0x3bf267(0x1a3)](_0x3bf267(0x246)),{'token':!![],'type_membresy':_0x2803ae['type_membresy'],'uuid':_0x2803ae[_0x3bf267(0x216)],'activation_date':_0x2803ae[_0x3bf267(0x1f6)],'message':_0x3bf267(0x246)}):{'token':null,'message':_0x3bf267(0x233)};}}catch(_0x4036ba){return console[_0x3bf267(0x22e)](_0x3bf267(0x1cc),_0x4036ba),{'token':null,'message':_0x4036ba};}}async function save_the_uui_of_the_user_in_the_database(_0x4d7e4c,_0x344e3f){const _0x347a2d=_0x50c5bb;try{const _0x226e4e=await get_answer_of_my_api(_0x347a2d(0x1a4),{'token':_0x4d7e4c,'deviceId':_0x344e3f});return _0x226e4e[_0x347a2d(0x1c1)][_0x347a2d(0x17f)];}catch(_0x37f01d){return console[_0x347a2d(0x22e)]('Error\x20al\x20actualizar\x20el\x20UUID\x20del\x20dispositivo:',_0x37f01d),![];}}async function verificarTokenActivo(){const _0x47d066=_0x50c5bb,_0x5e5273=_0x47d066(0x1d9);try{const _0x460591=await pool[_0x47d066(0x259)](_0x5e5273,[TOKEN]);return console[_0x47d066(0x1a3)](_0x460591[0x0]),_0x460591[0x0][_0x47d066(0x1ec)]===0x1?(console['log'](_0x47d066(0x22b)),!![]):(console[_0x47d066(0x1a3)]('El\x20token\x20no\x20está\x20activo\x20o\x20no\x20existe.'),![]);}catch(_0x501ca1){return console[_0x47d066(0x22e)]('Error\x20al\x20verificar\x20el\x20token:',_0x501ca1),![];}}async function actualizarToken(){const _0x4455e1=_0x50c5bb,_0x5daee8=_0x4455e1(0x230);await pool[_0x4455e1(0x259)](_0x5daee8,[TOKEN]);}app['on']('ready',async()=>{const _0xb5ed21=_0x50c5bb;await check_if_exist_updates();if(thiIsADemo){await initialize_demo();if(await is_demo_expired()){dialog[_0xb5ed21(0x197)]({'type':_0xb5ed21(0x1a7),'title':'Demo\x20Expirada','message':_0xb5ed21(0x258)}),app[_0xb5ed21(0x238)]();return;}}else await verify_membership_of_user()?(serverExpress[_0xb5ed21(0x195)](serverExpress[_0xb5ed21(0x1e5)](_0xb5ed21(0x1f4)),_0xb5ed21(0x243),()=>{const _0x234d3d=_0xb5ed21;console[_0x234d3d(0x1a3)](_0x234d3d(0x1a0)+getLocalIP()+':'+serverExpress['get']('port'));}),createMainWindow()):createMainWindowRegister();}),app['on'](_0x50c5bb(0x1e3),()=>{const _0x2ffae6=_0x50c5bb;process['platform']!==_0x2ffae6(0x23c)&&app[_0x2ffae6(0x238)]();});