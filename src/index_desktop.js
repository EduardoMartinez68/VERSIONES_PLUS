const _0x54db13=_0x530c;(function(_0x3a9081,_0x236d7f){const _0x67b422=_0x530c,_0x180044=_0x3a9081();while(!![]){try{const _0x41c555=-parseInt(_0x67b422(0x8a))/0x1+-parseInt(_0x67b422(0x11b))/0x2+-parseInt(_0x67b422(0x144))/0x3+-parseInt(_0x67b422(0x101))/0x4*(parseInt(_0x67b422(0xf1))/0x5)+parseInt(_0x67b422(0x10a))/0x6+-parseInt(_0x67b422(0xb5))/0x7+parseInt(_0x67b422(0x114))/0x8;if(_0x41c555===_0x236d7f)break;else _0x180044['push'](_0x180044['shift']());}catch(_0x10ab78){_0x180044['push'](_0x180044['shift']());}}}(_0x557f,0x2e735));const system=require('./lib/system'),thiIsADemo=![],{app,BrowserWindow,dialog,ipcMain}=require(_0x54db13(0xc0)),express=require('express'),morgan=require(_0x54db13(0x10f)),{engine}=require(_0x54db13(0xfd)),multer=require(_0x54db13(0x147)),flash=require(_0x54db13(0x10b)),session=require(_0x54db13(0x97)),passport=require(_0x54db13(0xbc)),{database}=require(_0x54db13(0x141)),{v4:uuid}=require(_0x54db13(0x94)),path=require(_0x54db13(0x91)),{RecaptchaV2}=require(_0x54db13(0xfe)),nodePersist=require(_0x54db13(0x146));nodePersist[_0x54db13(0x117)]({'dir':path[_0x54db13(0xa1)](__dirname,'data')});async function initialize_software(){const _0x41ecf5=_0x54db13,_0x537a9e=await nodePersist[_0x41ecf5(0x10e)]('installToken');!_0x537a9e&&await nodePersist['set'](_0x41ecf5(0x136),_0x41ecf5(0x98));}async function the_software_have_a_token(){const _0x5c15d4=_0x54db13,_0x4cbf50=await nodePersist[_0x5c15d4(0x10e)](_0x5c15d4(0x136));if(!_0x4cbf50)return![];return _0x4cbf50!=_0x5c15d4(0x98);}async function create_expiration_date_of_the_token(_0x47b892){const _0xb2888d=_0x54db13,_0x31340b=await nodePersist[_0xb2888d(0x10e)](_0xb2888d(0xa3));!_0x31340b&&await nodePersist['set']('expirationDateOFTheToken',_0x47b892);}async function token_expired(){const _0x341ebb=_0x54db13,_0x346b69=await nodePersist['get'](_0x341ebb(0xa3)),_0x58c949=new Date(_0x346b69),_0xc1e755=new Date();return _0xc1e755<_0x58c949;}async function remove_install_token(){const _0x508723=_0x54db13;await nodePersist[_0x508723(0xd8)]('installToken'),await nodePersist['removeItem']('expirationDateOFTheToken'),console[_0x508723(0x14c)]('installToken\x20eliminado');}async function initialize_token(_0x421040){const _0x53d1a6=_0x54db13,_0x1c8a30=await nodePersist['get'](_0x53d1a6(0x136));await nodePersist[_0x53d1a6(0xb4)](_0x53d1a6(0x136),_0x421040);}async function initialize_demo(){const _0x58b1da=_0x54db13,_0x3dd87d=await nodePersist['get'](_0x58b1da(0x9f));if(!_0x3dd87d){const _0x5c885a=new Date()['toISOString']();await nodePersist[_0x58b1da(0xb4)](_0x58b1da(0x115),_0x5c885a),console[_0x58b1da(0x14c)](_0x58b1da(0x11a),_0x5c885a);}else console[_0x58b1da(0x14c)]('Fecha\x20de\x20instalación\x20existente:',_0x3dd87d);}async function is_demo_expired(){const _0x5be913=_0x54db13,_0x328453=await nodePersist[_0x5be913(0x10e)](_0x5be913(0x9f));if(!_0x328453)return console[_0x5be913(0x14c)](_0x5be913(0xd4)),![];const _0x2daf8d=new Date(_0x328453),_0x3529e1=new Date(),_0x59b240=_0x3529e1-_0x2daf8d,_0x260437=_0x59b240/(0x3e8*0x3c*0x3c*0x18);return _0x260437>0x1e?(console[_0x5be913(0x14c)](_0x5be913(0x12f)),!![]):(console['log'](_0x5be913(0xe2)),![]);}async function this_software_count_have_a_count(){}async function the_user_have_a_token_active_in_the_database(){}async function verify_membership_of_user(){initialize_software();if(await the_software_have_a_token())return await token_expired();return![];}const simpleGit=require(_0x54db13(0xaf)),fs=require('fs'),repoPath=path[_0x54db13(0xa1)](__dirname),git=simpleGit(repoPath),repoURL=_0x54db13(0xe5),remote='origin';git[_0x54db13(0xbe)](remote,repoURL)[_0x54db13(0x128)](()=>{const _0x58470e=_0x54db13;console[_0x58470e(0x14c)](_0x58470e(0x105));})[_0x54db13(0x13f)](_0xdd2576=>{const _0x27f629=_0x54db13;console[_0x27f629(0x14f)](_0x27f629(0xcc),_0xdd2576);});async function check_if_exist_updates(){const _0x5b68a9=_0x54db13;try{await git['fetch'](remote),await git[_0x5b68a9(0x8b)](['update-index',_0x5b68a9(0x13a),'src/public/img/uploads/']),await git[_0x5b68a9(0xf2)]();const _0x4110b0=await git[_0x5b68a9(0x14c)]([_0x5b68a9(0xa6),'-1']),_0x1ada88=await git[_0x5b68a9(0x14c)]([_0x5b68a9(0x8e),'-1']);_0x4110b0[_0x5b68a9(0xc3)][_0x5b68a9(0x142)]!==_0x1ada88[_0x5b68a9(0xc3)][_0x5b68a9(0x142)]?(console[_0x5b68a9(0x14c)]('🔄\x20Nueva\x20versión\x20encontrada,\x20actualizando...'),await git[_0x5b68a9(0x11d)](_0x5b68a9(0xe3),_0x5b68a9(0x150),{'--rebase':null}),dialog[_0x5b68a9(0xcd)]({'type':_0x5b68a9(0x9d),'title':_0x5b68a9(0x133),'message':_0x5b68a9(0xc7),'buttons':[_0x5b68a9(0xca)]}),app['relaunch'](),app[_0x5b68a9(0x135)]()):console[_0x5b68a9(0x14c)](_0x5b68a9(0x14d)),await git[_0x5b68a9(0xf2)]([_0x5b68a9(0xc2)]);}catch(_0x7b0d20){const _0x3a1ad1=path[_0x5b68a9(0xa1)](__dirname,_0x5b68a9(0x143));fs[_0x5b68a9(0x116)](_0x3a1ad1,_0x5b68a9(0x13e)+_0x7b0d20[_0x5b68a9(0x99)]+'\x0a'+_0x7b0d20['stack']+'\x0a\x0a',_0x5b68a9(0xad)),console[_0x5b68a9(0x14f)](_0x5b68a9(0xba),_0x7b0d20);}}const serverExpress=express();require(_0x54db13(0xe1)),require(_0x54db13(0x113)),serverExpress['set'](_0x54db13(0xb2),process[_0x54db13(0x103)][_0x54db13(0x154)]||0xfa0),serverExpress[_0x54db13(0xb4)](_0x54db13(0x104),path[_0x54db13(0xa1)](__dirname,_0x54db13(0x104))),serverExpress[_0x54db13(0x96)](_0x54db13(0xd2),engine({'defaultLayout':'main','layoutsDir':path['join'](serverExpress[_0x54db13(0x10e)](_0x54db13(0x104)),_0x54db13(0xda)),'partialsDir':path[_0x54db13(0xa1)](serverExpress[_0x54db13(0x10e)](_0x54db13(0x104)),_0x54db13(0x153)),'extname':_0x54db13(0xd2),'helpers':require(_0x54db13(0x131))})),serverExpress[_0x54db13(0xb4)](_0x54db13(0xb6),_0x54db13(0xd2)),require(_0x54db13(0xcb))[_0x54db13(0x157)]();function _0x557f(){const _0x5e0e77=['Error\x20al\x20verificar\x20el\x20token:','then','\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SET\x20active\x20=\x20false\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','Token\x20encontrado\x20y\x20activo.','answer-from-login-render-token','connectionRejected','canSend','hashedPassword','La\x20demo\x20ha\x20expirado.','getConnection','./lib/handlebars','node-machine-id','Actualización','code','quit','installToken','Nueva\x20notificación:','./lib/addFrom','window-all-closed','--assume-unchanged','family','maximize','userId','Error\x20verificando\x20actualizaciones:\x20','catch','broadcast','./keys','hash','logfile.txt','419979pgUCbm','privateNotifications','node-persist','multer','device_id','urlencoded','El\x20token\x20no\x20está\x20activo\x20o\x20no\x20existe.','Tu\x20demo\x20de\x2030\x20días\x20ha\x20expirado.\x20Por\x20favor,\x20compra\x20la\x20versión\x20completa\x20y\x20sigue\x20creciendo\x20con\x20ED\x20PLUS\x20🚀.','log','✅\x20La\x20aplicación\x20ya\x20está\x20actualizada.','No\x20pudimos\x20enviar\x20el\x20mensaje\x20al\x20usuario\x20\x27','error','main','newNotification','type_membresy','partials','PORT','socketId','./router/links/fudone','config','sendNotificationToUser','initialize','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20users\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20SET\x20activation_date\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','La\x20conexión\x20a\x20la\x20base\x20de\x20datos\x20fue\x20cerrada.','215070THjuqj','raw','login-from-render-token','0000-00-00','HEAD','user','Datos\x20actualizados\x20con\x20éxito.\x20Cierra\x20y\x20vuelve\x20a\x20abrir\x20el\x20programa\x20😄','path','some','Socket\x20','uuid','\x20desconectado,\x20pero\x20no\x20estaba\x20asociado\x20a\x20ninguna\x20empresa.','engine','express-session','false','message','socket.io','./services/chat.js','Usuario\x20no\x20encontrado.','info','Suscripción\x20expirada.\x20Por\x20favor,\x20vuelve\x20a\x20activar\x20tu\x20membresía.','installDemo','activation.html','join','extname','expirationDateOFTheToken','login-from-render','success','origin/main','pack_branch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20token,\x20type_membresy,\x20activation_date\x20,\x20device_id\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','./router/links/subscription','Usuario\x20autenticado\x20con\x20éxito.','session','u995592926_bestpoint','utf8','getTheFirstTenNotifications','simple-git','Ups,\x20parece\x20que\x20ya\x20estás\x20conectado\x20en\x20otro\x20dispositivo.','./router/authentication','port','./router/links/CRM','set','235067idkVwv','view\x20engine','./router/links/app','loadFile','./router/links/store','❌\x20Error\x20verificando\x20actualizaciones:','release','passport','query','addRemote','split','electron','193.203.166.165','pop','latest','sendMessageToUser','json','createServer','Se\x20ha\x20descargado\x20una\x20nueva\x20versión.\x20Reinicia\x20la\x20aplicación\x20para\x20aplicar\x20los\x20cambios.','create_new_chat','PROTOCOL_CONNECTION_LOST','Reiniciar\x20ahora','dotenv','Error\x20al\x20agregar\x20el\x20repositorio\x20remoto','showMessageBoxSync','Ups,\x20parece\x20que\x20alcanzaste\x20tu\x20límite\x20de\x20dispositivos\x20conectados.\x20Por\x20favor,\x20actualiza\x20tu\x20membresía.','get_the_first_notification','password','originalname','.hbs','Bobesponja48*','No\x20se\x20encontró\x20la\x20fecha\x20de\x20instalación','bcrypt','flash','companyId','removeItem','La\x20conexión\x20a\x20la\x20base\x20de\x20datos\x20fue\x20rechazada.','layouts','single','./router/links/branch','La\x20base\x20de\x20datos\x20tiene\x20muchas\x20conexiones.','disconnect','Error\x20al\x20verificar\x20usuario:','messageStatus','./lib/passport','La\x20demo\x20aún\x20está\x20activa.','origin','Pool','https://github.com/EduardoMartinez68/VERSIONES_PLUS','Este\x20usuario\x20ya\x20tiene\x20un\x20TOKEN\x20registrado\x20en\x20un\x20equipo.','./router/links/ceo','privateMessage','public','emit','diskStorage','username','getFullYear','get_max_employee_of_this_company','activation_date','image','10AYMltB','stash','active','Este\x20email\x20\x27','ready','El\x20usuario\x20\x27','Contraseña\x20incorrecta.','locals','loadURL','public/img/uploads','http','FudSession','express-handlebars','express-recaptcha','use','./router/links/delivery','515068fIvpyt','token','env','views','Repositorio\x20remoto\x20configurado\x20correctamente','connection','listen','setFullYear','./router/links/desktop','1176480toSKyJ','connect-flash','sendNotification','127.0.0.1','get','morgan','length','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20*\x20FROM\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','desktop','./lib/editFrom','6700624aTAics','installDate','appendFileSync','init','create_notification','dev','Fecha\x20de\x20instalación\x20guardada:','394438WaTXOr','./router/links','pull','platform','0.0.0.0','\x27.\x20Inténtalo\x20de\x20nuevo.\x20😳','send_new_message','Demo\x20Expirada','\x27\x20no\x20existe.\x20🤔','reply','this_email_exist','company'];_0x557f=function(){return _0x5e0e77;};return _0x557f();}const {APP_PG_USER,APP_PG_HOST,APP_PG_DATABASE,APP_PG_PASSWORD,APP_PG_PORT,TOKEN}=process[_0x54db13(0x103)],pg=require('pg'),pgPool=new pg[(_0x54db13(0xe4))]({'user':APP_PG_USER,'host':APP_PG_HOST,'database':APP_PG_DATABASE,'password':APP_PG_PASSWORD,'port':APP_PG_PORT});serverExpress[_0x54db13(0xff)](session({'secret':_0x54db13(0xfc),'resave':![],'saveUninitialized':![],'store':new(require('connect-pg-simple')(session))({'pool':pgPool,'tableName':_0x54db13(0xab)})})),serverExpress[_0x54db13(0xff)](flash()),serverExpress['use'](morgan(_0x54db13(0x119))),serverExpress['use'](express[_0x54db13(0x149)]({'extended':![]})),serverExpress[_0x54db13(0xff)](express[_0x54db13(0xc5)]()),serverExpress[_0x54db13(0xff)](passport[_0x54db13(0x159)]()),serverExpress[_0x54db13(0xff)](passport['session']());const storage=multer[_0x54db13(0xeb)]({'destination':path[_0x54db13(0xa1)](__dirname,_0x54db13(0xfa)),'filename':(_0x121523,_0x9fb388,_0x1c3290,_0x37b059)=>{const _0x165131=_0x54db13;_0x1c3290(null,uuid()+path[_0x165131(0xa2)](_0x9fb388[_0x165131(0xd1)]));}});serverExpress[_0x54db13(0xff)](multer({'storage':storage})[_0x54db13(0xdb)](_0x54db13(0xf0))),serverExpress[_0x54db13(0xff)]((_0x352966,_0x2e12f5,_0xd2d745)=>{const _0x4a45fd=_0x54db13;serverExpress['locals']['success']=_0x352966[_0x4a45fd(0xd6)](_0x4a45fd(0xa5)),serverExpress['locals'][_0x4a45fd(0x99)]=_0x352966['flash'](_0x4a45fd(0x99)),serverExpress['locals'][_0x4a45fd(0x8f)]=_0x352966[_0x4a45fd(0x8f)],serverExpress['locals'][_0x4a45fd(0x126)]=_0x352966[_0x4a45fd(0x126)],serverExpress['locals']['pack_company']=0x0,serverExpress[_0x4a45fd(0xf8)][_0x4a45fd(0xa7)]=0x0,_0xd2d745();});const http=require(_0x54db13(0xfb)),server=http[_0x54db13(0xc6)](serverExpress),{Server}=require(_0x54db13(0x9a)),io=new Server(server),users={},connectedEmployees={},companyLimitsCache={},chat=require(_0x54db13(0x9b));io['on'](_0x54db13(0x106),async _0x165b6b=>{const _0x224c05=_0x54db13;_0x165b6b['on']('registerUser',async(_0x52bfe1,_0x4ba398)=>{const _0x27d47b=_0x530c,_0x5f7999=connectedEmployees[_0x4ba398]||[],_0x8186cb=_0x5f7999[_0x27d47b(0x92)](_0x1511dc=>_0x1511dc[_0x27d47b(0x13d)]===_0x52bfe1);if(_0x8186cb){_0x165b6b[_0x27d47b(0xea)](_0x27d47b(0x12c),_0x27d47b(0xb0));return;}if(system!=_0x27d47b(0x112)){!companyLimitsCache[_0x4ba398]&&(companyLimitsCache[_0x4ba398]=await chat[_0x27d47b(0xee)](_0x4ba398));const _0x466601=companyLimitsCache[_0x4ba398];if(_0x5f7999[_0x27d47b(0x110)]>=_0x466601){_0x165b6b[_0x27d47b(0xea)](_0x27d47b(0x12c),_0x27d47b(0xce));return;}}_0x165b6b[_0x27d47b(0xd7)]=_0x4ba398,_0x5f7999['push']({'userId':_0x52bfe1,'socketId':_0x165b6b['id']}),connectedEmployees[_0x4ba398]=_0x5f7999;const _0x585300=await chat['get_the_first_notification'](_0x52bfe1,0xa);io['to'](_0x52bfe1)[_0x27d47b(0xea)](_0x27d47b(0x145),{'notifications':_0x585300});});async function _0x36fdbd(_0x327523){const _0x570ea0=_0x530c,_0x92a6c7=users[_0x327523];let _0x37035d=_0x92a6c7;!_0x92a6c7&&(_0x37035d=await chat[_0x570ea0(0x125)](toUserId));const _0x499e75={'canSend':_0x37035d,'theUserIsConnect':_0x92a6c7};return _0x499e75;}_0x165b6b['on'](_0x224c05(0x158),async({userEmail:_0x5d7dbd,toUserEmail:_0x1fa01a,message:_0x202c37})=>{const _0x5546c7=_0x224c05,_0x1a5bf7=await _0x36fdbd(_0x1fa01a);_0x1a5bf7[_0x5546c7(0x12d)]?await chat[_0x5546c7(0x118)](_0x5d7dbd,_0x1fa01a,_0x202c37)?(_0x1a5bf7['theUserIsConnect']&&io['to'](recipientSocketId)[_0x5546c7(0xea)](_0x5546c7(0xe8),{'userId':userId,'message':_0x202c37}),_0x165b6b[_0x5546c7(0xea)](_0x5546c7(0xe0),{'success':!![],'message':'Mensaje\x20enviado\x20con\x20éxito.\x20👌'})):_0x165b6b[_0x5546c7(0xea)]('messageStatus',{'success':![],'message':_0x5546c7(0x14e)+_0x1fa01a+_0x5546c7(0x120)}):_0x165b6b[_0x5546c7(0xea)](_0x5546c7(0xe0),{'success':![],'message':_0x5546c7(0xf6)+_0x1fa01a+_0x5546c7(0x123)});}),_0x165b6b['on'](_0x224c05(0xae),async({userEmail:_0x3e8e2a})=>{const _0x4ee153=_0x224c05,_0x1b56ba=await chat[_0x4ee153(0xcf)](_0x3e8e2a,0xa);io['to'](recipientSocketId)['emit'](_0x4ee153(0x145),{'notifications':_0x1b56ba});}),_0x165b6b['on'](_0x224c05(0xc4),async({userId:_0x237c49,toUserId:_0x72c349,message:_0x39a99c})=>{const _0x5f2fad=_0x224c05,_0xa487ed=users[_0x72c349];let _0x530d06=_0xa487ed;!_0xa487ed&&(_0x530d06=await chat['this_email_exist'](_0x72c349));if(_0x530d06){const _0x19911c=await chat[_0x5f2fad(0xc8)](_0x237c49,_0x72c349);await chat[_0x5f2fad(0x121)](_0x19911c,_0x237c49,_0x39a99c)&&(_0xa487ed&&io['to'](_0xa487ed)[_0x5f2fad(0xea)](_0x5f2fad(0xe8),{'userId':_0x237c49,'message':_0x39a99c})),_0x165b6b['emit'](_0x5f2fad(0xe0),{'success':!![],'message':'Mensaje\x20enviado\x20con\x20éxito'});}else _0x165b6b[_0x5f2fad(0xea)](_0x5f2fad(0xe0),{'success':![],'message':_0x5f2fad(0xf4)+_0x72c349+'\x27\x20no\x20existe\x20🤔'});}),_0x165b6b['on'](_0x224c05(0xde),()=>{const _0x134b41=_0x224c05,{companyId:_0x48559c}=_0x165b6b;_0x48559c&&connectedEmployees[_0x48559c]?(connectedEmployees[_0x48559c]=connectedEmployees[_0x48559c]['filter'](_0x21a80a=>_0x21a80a[_0x134b41(0x155)]!==_0x165b6b['id']),connectedEmployees[_0x48559c][_0x134b41(0x110)]===0x0&&delete connectedEmployees[_0x48559c]):console[_0x134b41(0x14c)](_0x134b41(0x93)+_0x165b6b['id']+_0x134b41(0x95));}),_0x165b6b['on'](_0x224c05(0x10c),_0x62574a=>{const _0x57ce79=_0x224c05;console['log'](_0x57ce79(0x137),_0x62574a),_0x165b6b[_0x57ce79(0x140)]['emit'](_0x57ce79(0x151),_0x62574a);});});const companyName='/links';serverExpress[_0x54db13(0xff)](require('./router')),serverExpress[_0x54db13(0xff)](require(_0x54db13(0xb1))),serverExpress['use'](companyName,require(_0x54db13(0x11c))),serverExpress[_0x54db13(0xff)](companyName,require(_0x54db13(0x156))),serverExpress[_0x54db13(0xff)](companyName,require(_0x54db13(0xe7))),serverExpress[_0x54db13(0xff)](companyName,require(_0x54db13(0xdc))),serverExpress['use'](companyName,require(_0x54db13(0xa9))),serverExpress[_0x54db13(0xff)](companyName,require(_0x54db13(0xb9))),serverExpress[_0x54db13(0xff)](companyName,require(_0x54db13(0x100))),serverExpress[_0x54db13(0xff)](companyName,require(_0x54db13(0xb7))),serverExpress[_0x54db13(0xff)](companyName,require(_0x54db13(0xb3))),serverExpress['use'](companyName,require(_0x54db13(0x109))),serverExpress[_0x54db13(0xff)](companyName,require('./router/links/boutique')),serverExpress[_0x54db13(0xff)](companyName,require('./router/links/cashCut')),serverExpress[_0x54db13(0xff)](require(_0x54db13(0x138))),serverExpress['use'](express['static'](path[_0x54db13(0xa1)](__dirname,_0x54db13(0xe9))));const os=require('os');function getLocalIP(){const _0x3f6bd9=_0x54db13,_0x3c551f=os['networkInterfaces']();for(let _0x396a86 in _0x3c551f){for(let _0x19861f=0x0;_0x19861f<_0x3c551f[_0x396a86][_0x3f6bd9(0x110)];_0x19861f++){const _0x31eb5d=_0x3c551f[_0x396a86][_0x19861f];if(_0x31eb5d[_0x3f6bd9(0x13b)]==='IPv4'&&!_0x31eb5d['internal'])return _0x31eb5d['address'];}}return _0x3f6bd9(0x10d);}const mysql=require('mysql'),{promisify}=require('util'),pool=mysql['createPool']({'host':_0x54db13(0xc1),'user':_0x54db13(0xac),'password':_0x54db13(0xd3),'database':_0x54db13(0xac),'waitForConnections':!![],'connectionLimit':0xa,'queueLimit':0x0});pool[_0x54db13(0x130)]((_0x2f9c5c,_0x2b8a0a)=>{const _0x54f6d5=_0x54db13;_0x2f9c5c&&(_0x2f9c5c[_0x54f6d5(0x134)]===_0x54f6d5(0xc9)&&console['error'](_0x54f6d5(0x89)),_0x2f9c5c[_0x54f6d5(0x134)]==='ER_CON_COUNT_ERROR'&&console[_0x54f6d5(0x14f)](_0x54f6d5(0xdd)),_0x2f9c5c['code']==='ECONNREFUSED'&&console[_0x54f6d5(0x14f)](_0x54f6d5(0xd9)));_0x2b8a0a&&(_0x2b8a0a[_0x54f6d5(0xbb)](),console['log']('Conexión\x20a\x20la\x20base\x20de\x20datos\x20exitosa\x20MYSQL.'));return;}),pool[_0x54db13(0xbd)]=promisify(pool[_0x54db13(0xbd)]);let mainWindow,activationWindow,loginWindow;const createMainWindow=()=>{const _0x3c3c24=_0x54db13;mainWindow=new BrowserWindow({'width':0x320,'height':0x258}),mainWindow['maximize'](),mainWindow[_0x3c3c24(0xf9)]('http://localhost:'+serverExpress[_0x3c3c24(0x10e)]('port'));},createMainWindowRegister=()=>{const _0xdecc90=_0x54db13;loginWindow=new BrowserWindow({'width':0x320,'height':0x258,'parent':mainWindow,'webPreferences':{'preload':path[_0xdecc90(0xa1)](__dirname,'preload.js'),'nodeIntegration':!![],'contextIsolation':![]}}),loginWindow[_0xdecc90(0x13c)](),loginWindow[_0xdecc90(0xb8)](path[_0xdecc90(0xa1)](__dirname,_0xdecc90(0xa0)));},{machineIdSync}=require(_0x54db13(0x132)),deviceId=machineIdSync();ipcMain['on'](_0x54db13(0x8c),async(_0x46b113,_0x316655)=>{const _0x295d11=_0x54db13,_0x2d9559=_0x316655[_0x295d11(0x102)],_0x29af10=await see_if_exist_this_token_in_the_database_of_the_web(_0x2d9559);if(_0x29af10[_0x295d11(0x102)]){let _0x25e4ab=!![];_0x29af10[_0x295d11(0x94)]&&(_0x29af10[_0x295d11(0x94)]!==deviceId&&(_0x29af10['message']=_0x295d11(0xe6),_0x25e4ab=![])),_0x25e4ab&&(await save_the_uui_of_the_user_in_the_database(_0x2d9559,deviceId)&&(await initialize_token(_0x2d9559),await create_expiration_date_of_the_token(_0x29af10[_0x295d11(0xef)]),_0x29af10[_0x295d11(0x99)]=_0x295d11(0x90)));}_0x46b113[_0x295d11(0x124)](_0x295d11(0x12b),_0x29af10['message']);}),ipcMain['on'](_0x54db13(0xa4),async(_0x24c633,_0x1dadaf)=>{const _0x5f4d7f=_0x54db13,_0x30f1a1=_0x1dadaf[_0x5f4d7f(0xec)],_0xb76f73=_0x1dadaf[_0x5f4d7f(0xd0)],_0x553fa6=await see_if_exist_this_user_in_the_database_of_the_web(_0x30f1a1,_0xb76f73);if(_0x553fa6[_0x5f4d7f(0x102)]){if(_0x553fa6[_0x5f4d7f(0x94)]&&_0x553fa6[_0x5f4d7f(0x94)]!==deviceId)_0x553fa6[_0x5f4d7f(0x99)]='Este\x20usuario\x20ya\x20tiene\x20un\x20TOKEN\x20registrado\x20en\x20un\x20equipo.';else{if(await save_the_uui_of_the_user_in_the_database(_0x30f1a1,deviceId)){}}}_0x24c633[_0x5f4d7f(0x124)]('answer-from-login-render',_0x553fa6[_0x5f4d7f(0x99)]);});const bcrypt=require(_0x54db13(0xd5));async function see_if_exist_this_user_in_the_database_of_the_web(_0x501d4c,_0x568fb1){const _0x16264b=_0x54db13,_0x1cfbde='\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20token,\x20type_membresy,\x20password\x20AS\x20hashedPassword,\x20activation_date\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x20users\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20email\x20=\x20?\x0a\x20\x20\x20\x20';try{const _0x543838=await pool[_0x16264b(0xbd)](_0x1cfbde,[_0x501d4c]);if(_0x543838[_0x16264b(0x110)]===0x0)return{'token':null,'message':_0x16264b(0x9c)};const _0x59b772=_0x543838[0x0],_0x41602b=await bcrypt['compare'](_0x568fb1,_0x59b772[_0x16264b(0x12e)]);if(!_0x41602b)return{'token':null,'message':_0x16264b(0xf7)};const _0x1321ca=new Date();_0x1321ca[_0x16264b(0x108)](_0x1321ca[_0x16264b(0xed)]()-0x1);if(new Date(_0x59b772[_0x16264b(0xef)])<_0x1321ca)return{'token':null,'message':'Suscripción\x20expirada.\x20Por\x20favor,\x20vuelve\x20a\x20activar\x20tu\x20membresía.'};return console[_0x16264b(0x14c)](_0x16264b(0xaa)),{'token':_0x59b772[_0x16264b(0x102)],'type_membresy':_0x59b772[_0x16264b(0x152)],'message':_0x16264b(0xaa)};}catch(_0x38203f){return console[_0x16264b(0x14f)](_0x16264b(0xdf),_0x38203f),{'token':null};}}async function see_if_exist_this_token_in_the_database_of_the_web(_0x4b2a62){const _0x22e9ee=_0x54db13,_0x51c05e=_0x22e9ee(0xa8);try{const _0x2cd080=await pool['query'](_0x51c05e,[_0x4b2a62]);if(_0x2cd080[_0x22e9ee(0x110)]===0x0)return{'token':null,'message':'Token\x20no\x20encontrado.'};const _0x1495cd=_0x2cd080[0x0],_0x4b05b6=new Date();_0x4b05b6[_0x22e9ee(0x108)](_0x4b05b6[_0x22e9ee(0xed)]()-0x1);if(_0x1495cd[_0x22e9ee(0xef)]!=_0x22e9ee(0x8d)&&new Date(_0x1495cd[_0x22e9ee(0xef)])<_0x4b05b6)return{'token':null,'message':_0x22e9ee(0x9e)};if(_0x1495cd[_0x22e9ee(0xef)]===_0x22e9ee(0x8d)){const _0x7aa5d6=new Date();_0x7aa5d6['setFullYear'](_0x7aa5d6[_0x22e9ee(0xed)]()+0x1);const _0x51d85d=_0x22e9ee(0x15a);await pool[_0x22e9ee(0xbd)](_0x51d85d,[_0x7aa5d6['toISOString']()[_0x22e9ee(0xbf)]('T')[0x0],_0x1495cd[_0x22e9ee(0x102)]]),_0x1495cd[_0x22e9ee(0xef)]=_0x7aa5d6;}return console['log']('Usuario\x20autenticado\x20con\x20éxito.'),{'token':!![],'type_membresy':_0x1495cd[_0x22e9ee(0x152)],'uuid':_0x1495cd[_0x22e9ee(0x148)],'activation_date':_0x1495cd[_0x22e9ee(0xef)],'message':_0x22e9ee(0xaa)};}catch(_0x501537){return console[_0x22e9ee(0x14f)](_0x22e9ee(0xdf),_0x501537),{'token':null};}}async function save_the_uui_of_the_user_in_the_database(_0x5a2f16,_0xbadef8){const _0x4f237d=_0x54db13,_0xc5109='\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SET\x20device_id\x20=\x20?\x20,\x20active\x20=\x20false\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20';try{const _0x29b7bf=await pool[_0x4f237d(0xbd)](_0xc5109,[_0xbadef8,_0x5a2f16]);return!![];}catch(_0x23e43b){return console[_0x4f237d(0x14f)]('Error\x20al\x20actualizar\x20el\x20UUID\x20del\x20dispositivo:',_0x23e43b),![];}}async function verificarTokenActivo(){const _0x241c82=_0x54db13,_0xb39bdd=_0x241c82(0x111);try{const _0x5d0222=await pool[_0x241c82(0xbd)](_0xb39bdd,[TOKEN]);return console[_0x241c82(0x14c)](_0x5d0222[0x0]),_0x5d0222[0x0][_0x241c82(0xf3)]===0x1?(console[_0x241c82(0x14c)](_0x241c82(0x12a)),!![]):(console[_0x241c82(0x14c)](_0x241c82(0x14a)),![]);}catch(_0x21e4ee){return console['error'](_0x241c82(0x127),_0x21e4ee),![];}}async function actualizarToken(){const _0x2d7aeb=_0x54db13,_0x1f89a8=_0x2d7aeb(0x129);await pool['query'](_0x1f89a8,[TOKEN]);}function _0x530c(_0x30aa04,_0x1ff4f8){const _0x557f82=_0x557f();return _0x530c=function(_0x530cc6,_0x2c19ba){_0x530cc6=_0x530cc6-0x89;let _0x10a36d=_0x557f82[_0x530cc6];return _0x10a36d;},_0x530c(_0x30aa04,_0x1ff4f8);}app['on'](_0x54db13(0xf5),async()=>{const _0x516b66=_0x54db13;await check_if_exist_updates();if(thiIsADemo){await initialize_demo();if(await is_demo_expired()){dialog[_0x516b66(0xcd)]({'type':'warning','title':_0x516b66(0x122),'message':_0x516b66(0x14b)}),app['quit']();return;}}else await verify_membership_of_user()?(serverExpress[_0x516b66(0x107)](serverExpress[_0x516b66(0x10e)]('port'),_0x516b66(0x11f),()=>{const _0xe31dd2=_0x516b66;console['log']('Server\x20running\x20on\x20http://'+getLocalIP()+':'+serverExpress[_0xe31dd2(0x10e)]('port'));}),createMainWindow()):createMainWindowRegister();}),app['on'](_0x54db13(0x139),()=>{const _0x4ce462=_0x54db13;process[_0x4ce462(0x11e)]!=='darwin'&&app['quit']();});