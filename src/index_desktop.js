const _0x2182cb=_0x4355;(function(_0x308360,_0xfd0adf){const _0x291fc9=_0x4355,_0x1bd196=_0x308360();while(!![]){try{const _0x11a02a=-parseInt(_0x291fc9(0x278))/0x1*(-parseInt(_0x291fc9(0x217))/0x2)+parseInt(_0x291fc9(0x234))/0x3*(-parseInt(_0x291fc9(0x1c4))/0x4)+parseInt(_0x291fc9(0x214))/0x5+-parseInt(_0x291fc9(0x26e))/0x6*(-parseInt(_0x291fc9(0x1fb))/0x7)+-parseInt(_0x291fc9(0x1dc))/0x8*(-parseInt(_0x291fc9(0x281))/0x9)+-parseInt(_0x291fc9(0x224))/0xa+-parseInt(_0x291fc9(0x1be))/0xb;if(_0x11a02a===_0xfd0adf)break;else _0x1bd196['push'](_0x1bd196['shift']());}catch(_0x330839){_0x1bd196['push'](_0x1bd196['shift']());}}}(_0x264d,0xce240));const system=require(_0x2182cb(0x277)),thiIsADemo=![],{app,BrowserWindow,dialog,ipcMain}=require(_0x2182cb(0x26a)),express=require('express'),morgan=require(_0x2182cb(0x276)),{engine}=require(_0x2182cb(0x24f)),multer=require('multer'),flash=require(_0x2182cb(0x1e5)),session=require('express-session'),passport=require('passport'),{database}=require(_0x2182cb(0x1b5)),{v4:uuid}=require(_0x2182cb(0x22b)),path=require(_0x2182cb(0x21d)),{RecaptchaV2}=require('express-recaptcha'),nodePersist=require('node-persist');nodePersist[_0x2182cb(0x1da)]({'dir':path[_0x2182cb(0x1b1)](__dirname,_0x2182cb(0x23f))});async function initialize_software(){const _0x2ff887=_0x2182cb,_0x43511f=await nodePersist[_0x2ff887(0x1ea)](_0x2ff887(0x1cc));!_0x43511f&&await nodePersist[_0x2ff887(0x22f)](_0x2ff887(0x1cc),'false');}async function the_software_have_a_token(){const _0x3b346a=_0x2182cb,_0x1d22c8=await nodePersist['get'](_0x3b346a(0x1cc));if(!_0x1d22c8)return![];return _0x1d22c8!=_0x3b346a(0x1fd);}async function create_expiration_date_of_the_token(_0x15c84f){const _0x507f7e=_0x2182cb,_0x29ee6a=await nodePersist[_0x507f7e(0x1ea)](_0x507f7e(0x227));!_0x29ee6a&&await nodePersist[_0x507f7e(0x22f)](_0x507f7e(0x227),_0x15c84f);}async function token_expired(){const _0x301357=await nodePersist['get']('expirationDateOFTheToken'),_0x37b4f6=new Date(_0x301357),_0x482269=new Date();return _0x482269<_0x37b4f6;}function _0x264d(){const _0x512785=['logfile.txt','connect-pg-simple','bcrypt','networkInterfaces','platform','get_data_of_the_token_with_the_user_id.php','desktop','this_email_exist','userId','log','config','active','origin','electron','env','broadcast','Pool','24eIdUeS','./router/links/branch','Server\x20running\x20on\x20http://','CREATE\x20DATABASE\x20edplus','\x20La\x20base\x20de\x20datos\x20EDPLUS\x20ya\x20existe,\x20no\x20se\x20cre贸\x20nuevamente.','reply','image','query','morgan','./lib/system','252509xZbRun','device_id','user','Datos\x20actualizados\x20con\x20茅xito.\x20Cierra\x20y\x20vuelve\x20a\x20abrir\x20el\x20programa\x20','emit','stack','https://www.pluspuntodeventa.com/api/','fetch','./router/links/prescription','1061838luRoLY','Error\x20verificando\x20actualizaciones:\x20','extname','sendNotification','setFullYear','http://localhost:','createServer','./lib/handlebars','./router/links/CRM','./lib/editFrom','database','registerUser','Mensaje\x20enviado\x20con\x20茅xito.\x20','join','relaunch','family','pull','./keys','theUserIsConnect','./router/links/subscription','dev','locals','addRemote','split','Error\x20al\x20verificar\x20usuario:','password','12297032BHsFBG','diskStorage','update_activation_date.php','sendMessageToUser','readFileSync','Suscripci贸n\x20expirada.\x20Por\x20favor,\x20vuelve\x20a\x20activar\x20tu\x20membres铆a.','764kgbZWp','Este\x20usuario\x20no\x20tiene\x20ningun\x20Token\x20activo.','\x20desconectado,\x20pero\x20no\x20estaba\x20asociado\x20a\x20ninguna\x20empresa.','single','removeItem','installDemo','warning','Error\x20al\x20actualizar\x20el\x20UUID\x20del\x20dispositivo:','installToken','view\x20engine','IPv4','SELECT\x201\x20FROM\x20pg_database\x20WHERE\x20datname\x20=\x20\x27edplus\x27','appendFileSync','flash','latest','privateNotifications','answer-from-login-render-token','Actualizaci贸n','\x27\x20no\x20existe\x20','filter','ENTRE','PORT','init','setDate','32SlcoPp','Reiniciar\x20ahora','success','http','port','FudSession','length','Ups,\x20parece\x20que\x20alcanzaste\x20tu\x20l铆mite\x20de\x20dispositivos\x20conectados.\x20Por\x20favor,\x20actualiza\x20tu\x20membres铆a.','Error\x20al\x20verificar\x20el\x20token:','connect-flash','HEAD','newNotification','Usuario\x20autenticado\x20con\x20茅xito.','\x20Petici贸n\x20recibida\x20para\x20obtener\x20el\x20deviceId','get','showMessageBoxSync','pack_branch','La\x20demo\x20ha\x20expirado.','./router/links/ceo','company','map','message','trim','type_membresy','node-machine-id','127.0.0.1','socket.io','\x20SQL\x20ejecutado\x20correctamente','privateMessage','Ocurrio\x20un\x20error\x20al\x20verificar\x20tu\x20Token\x20en\x20el\x20ultimo\x20paso,\x20intentalo\x20otra\x20vez.','Socket\x20','2566578UZFprS','initialize','false','partials','./router/links/cashCut','./router/links/desktop','hash','./router/links/boutique','maximize','sendNotificationToUser','application/json','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20*\x20FROM\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','Usuario\x20no\x20encontrado.','preload.js','toISOString','installDate','internal','then','\x27.\x20Int茅ntalo\x20de\x20nuevo.\x20','listen','json','./lib/passport','get_max_employee_of_this_company','El\x20usuario\x20\x27','Demo\x20Expirada','5838480sweMHG','originalname','getDate','2hRXcXS','use','public/img/uploads','/links','address','views','path','./router/links/store','\x27\x20no\x20existe.\x20','messageStatus','./router/links/app','Se\x20ha\x20descargado\x20una\x20nueva\x20versi贸n.\x20Reinicia\x20la\x20aplicaci贸n\x20para\x20aplicar\x20los\x20cambios.','push','5763310iduQgr','info','pack_company','expirationDateOFTheToken','engine','main','Token\x20encontrado\x20y\x20activo.','uuid','companyId','post','\x20Nueva\x20versi贸n\x20encontrada,\x20actualizando...','set','token','connect','layouts','error','12882ZpPLvD','Este\x20usuario\x20ya\x20tiene\x20un\x20TOKEN\x20registrado\x20en\x20un\x20equipo.','darwin','./services/chat.js','some','expiration_date','Tu\x20demo\x20de\x2030\x20d铆as\x20ha\x20expirado.\x20Por\x20favor,\x20compra\x20la\x20versi贸n\x20completa\x20y\x20sigue\x20creciendo\x20con\x20ED\x20PLUS\x20.','utf8','dotenv','connection','Fecha\x20de\x20instalaci贸n\x20guardada:','data','Contrase帽a\x20incorrecta.','.hbs','create_new_chat','./router/links/delivery','\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SET\x20active\x20=\x20false\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','answer_get_my_deviceId','0.0.0.0','ready','\x0a\x0a\x0a','\x20Error\x20verificando\x20actualizaciones:','0000-00-00','Este\x20email\x20\x27','catch','activation_date','installToken\x20eliminado','express-handlebars','see_if_exist_this_token_in_the_database_of_the_web.php','update_data_of_the_token_in_this_drive','getFullYear','getTheFirstTenNotifications','quit','connectionRejected','socketId','login-from-render','postgres','\x20Base\x20de\x20datos\x20EDPLUS\x20creada','raw','Repositorio\x20remoto\x20configurado\x20correctamente','\x20Error\x20ejecutando\x20SQL:'];_0x264d=function(){return _0x512785;};return _0x264d();}async function remove_install_token(){const _0x4ba1ae=_0x2182cb;await nodePersist[_0x4ba1ae(0x1c8)]('installToken'),await nodePersist[_0x4ba1ae(0x1c8)](_0x4ba1ae(0x227)),console[_0x4ba1ae(0x266)](_0x4ba1ae(0x24e));}async function initialize_token(_0x73b782){const _0x396c09=_0x2182cb,_0x17b054=await nodePersist[_0x396c09(0x1ea)](_0x396c09(0x1cc));await nodePersist['set'](_0x396c09(0x1cc),_0x73b782);}async function initialize_demo(){const _0x41f3ac=_0x2182cb,_0x571aab=await nodePersist[_0x41f3ac(0x1ea)](_0x41f3ac(0x1c9));if(!_0x571aab){const _0x19e1b5=new Date()[_0x41f3ac(0x209)]();await nodePersist[_0x41f3ac(0x22f)](_0x41f3ac(0x20a),_0x19e1b5),console['log'](_0x41f3ac(0x23e),_0x19e1b5);}else console[_0x41f3ac(0x266)]('Fecha\x20de\x20instalaci贸n\x20existente:',_0x571aab);}async function is_demo_expired(){const _0x2cf00a=_0x2182cb,_0x10afe6=await nodePersist[_0x2cf00a(0x1ea)](_0x2cf00a(0x1c9));if(!_0x10afe6)return console[_0x2cf00a(0x266)]('No\x20se\x20encontr贸\x20la\x20fecha\x20de\x20instalaci贸n'),![];const _0x1e0ab4=new Date(_0x10afe6),_0x582151=new Date(),_0x3c7d6c=_0x582151-_0x1e0ab4,_0x245a95=_0x3c7d6c/(0x3e8*0x3c*0x3c*0x18);return _0x245a95>0x1e?(console[_0x2cf00a(0x266)](_0x2cf00a(0x1ed)),!![]):(console[_0x2cf00a(0x266)]('La\x20demo\x20a煤n\x20est谩\x20activa.'),![]);}async function this_software_count_have_a_count(){}async function the_user_have_a_token_active_in_the_database(){}async function verify_membership_of_user(){initialize_software();if(await the_software_have_a_token())return await token_expired();return![];}const simpleGit=require('simple-git'),fs=require('fs'),repoPath=path['join'](__dirname),git=simpleGit(repoPath),repoURL='https://github.com/EduardoMartinez68/VERSIONES_PLUS',remote=_0x2182cb(0x269);git[_0x2182cb(0x1ba)](remote,repoURL)[_0x2182cb(0x20c)](()=>{const _0x5190ad=_0x2182cb;console[_0x5190ad(0x266)](_0x5190ad(0x25b));})[_0x2182cb(0x24c)](_0x4ca3ac=>{const _0x33083b=_0x2182cb;console[_0x33083b(0x233)]('Error\x20al\x20agregar\x20el\x20repositorio\x20remoto',_0x4ca3ac);});async function check_if_exist_updates(){const _0x2f7b01=_0x2182cb;try{await git[_0x2f7b01(0x27f)](remote);const _0x534019=await git[_0x2f7b01(0x266)]([remote+'/main','-1']),_0x44df9a=await git['log']([_0x2f7b01(0x1e6),'-1']);_0x534019[_0x2f7b01(0x1d2)][_0x2f7b01(0x201)]!==_0x44df9a[_0x2f7b01(0x1d2)][_0x2f7b01(0x201)]?(console[_0x2f7b01(0x266)](_0x2f7b01(0x22e)),await git[_0x2f7b01(0x25a)](['reset','--hard',remote+'/main']),await git[_0x2f7b01(0x1b4)]('origin','main',{'--rebase':null}),dialog[_0x2f7b01(0x1eb)]({'type':_0x2f7b01(0x225),'title':_0x2f7b01(0x1d5),'message':_0x2f7b01(0x222),'buttons':[_0x2f7b01(0x1dd)]}),app[_0x2f7b01(0x1b2)](),app[_0x2f7b01(0x254)]()):console[_0x2f7b01(0x266)]('\x20La\x20aplicaci贸n\x20ya\x20est谩\x20actualizada.');}catch(_0x2b0947){const _0x2570c3=path[_0x2f7b01(0x1b1)](__dirname,_0x2f7b01(0x25d));fs[_0x2f7b01(0x1d0)](_0x2570c3,_0x2f7b01(0x282)+_0x2b0947[_0x2f7b01(0x1f1)]+'\x0a'+_0x2b0947['stack']+'\x0a\x0a',_0x2f7b01(0x23b)),console[_0x2f7b01(0x233)](_0x2f7b01(0x249),_0x2b0947),dialog[_0x2f7b01(0x1eb)]({'type':_0x2f7b01(0x1ca),'title':'Error\x20verificando\x20actualizaciones!','message':_0x2f7b01(0x282)+_0x2b0947['message']+'\x0a'+_0x2b0947[_0x2f7b01(0x27d)]+'\x0a\x0a'});}}function _0x4355(_0x395de6,_0x32af36){const _0x264d1e=_0x264d();return _0x4355=function(_0x4355c1,_0x3d31f2){_0x4355c1=_0x4355c1-0x1ae;let _0x2068a1=_0x264d1e[_0x4355c1];return _0x2068a1;},_0x4355(_0x395de6,_0x32af36);}const serverExpress=express();require(_0x2182cb(0x210)),require(_0x2182cb(0x28a)),serverExpress[_0x2182cb(0x22f)](_0x2182cb(0x1e0),process[_0x2182cb(0x26b)][_0x2182cb(0x1d9)]||0xfa0),serverExpress[_0x2182cb(0x22f)](_0x2182cb(0x21c),path[_0x2182cb(0x1b1)](__dirname,'views')),serverExpress[_0x2182cb(0x228)](_0x2182cb(0x241),engine({'defaultLayout':_0x2182cb(0x229),'layoutsDir':path[_0x2182cb(0x1b1)](serverExpress[_0x2182cb(0x1ea)](_0x2182cb(0x21c)),_0x2182cb(0x232)),'partialsDir':path[_0x2182cb(0x1b1)](serverExpress[_0x2182cb(0x1ea)](_0x2182cb(0x21c)),_0x2182cb(0x1fe)),'extname':'.hbs','helpers':require(_0x2182cb(0x288))})),serverExpress[_0x2182cb(0x22f)](_0x2182cb(0x1cd),_0x2182cb(0x241)),require(_0x2182cb(0x23c))[_0x2182cb(0x267)]();const {APP_PG_USER,APP_PG_HOST,APP_PG_DATABASE,APP_PG_PASSWORD,APP_PG_PORT,TOKEN}=process[_0x2182cb(0x26b)],pg=require('pg'),adminPool=new pg[(_0x2182cb(0x26d))]({'user':APP_PG_USER,'host':APP_PG_HOST,'password':APP_PG_PASSWORD,'port':APP_PG_PORT,'database':_0x2182cb(0x258)}),importSQLFile=async _0x12d181=>{const _0x5cc399=_0x2182cb,_0x2f660e=path[_0x5cc399(0x1b1)](__dirname,_0x5cc399(0x1ae),'edplus.sql'),_0x341349=fs[_0x5cc399(0x1c2)](_0x2f660e,_0x5cc399(0x23b)),_0x55dbcf=_0x341349[_0x5cc399(0x1bb)](/;\s*$/m)[_0x5cc399(0x1f0)](_0x216650=>_0x216650[_0x5cc399(0x1f2)]())[_0x5cc399(0x1d7)](_0x5a8521=>_0x5a8521[_0x5cc399(0x1e2)]>0x0),_0x110035=await _0x12d181[_0x5cc399(0x231)]();try{for(const _0x24a28b of _0x55dbcf){await _0x110035[_0x5cc399(0x275)](_0x24a28b);}console[_0x5cc399(0x266)](_0x5cc399(0x1f7));}catch(_0x48b005){console[_0x5cc399(0x233)](_0x5cc399(0x25c),_0x48b005[_0x5cc399(0x1f1)]);}finally{_0x110035['release']();}},createDatabase=async()=>{const _0x5c1114=_0x2182cb,_0x520983=await adminPool['query'](_0x5c1114(0x1cf));_0x520983['rowCount']===0x0?(await adminPool[_0x5c1114(0x275)](_0x5c1114(0x271)),importSQLFile(adminPool),console[_0x5c1114(0x266)](_0x5c1114(0x259))):console[_0x5c1114(0x266)](_0x5c1114(0x272));};createDatabase();const pgPool=new pg['Pool']({'user':APP_PG_USER,'host':APP_PG_HOST,'database':APP_PG_DATABASE,'password':APP_PG_PASSWORD,'port':APP_PG_PORT});serverExpress[_0x2182cb(0x218)](session({'secret':_0x2182cb(0x1e1),'resave':![],'saveUninitialized':![],'store':new(require(_0x2182cb(0x25e))(session))({'pool':pgPool,'tableName':'session'})})),serverExpress[_0x2182cb(0x218)](flash()),serverExpress[_0x2182cb(0x218)](morgan(_0x2182cb(0x1b8))),serverExpress[_0x2182cb(0x218)](express['urlencoded']({'extended':![]})),serverExpress[_0x2182cb(0x218)](express[_0x2182cb(0x20f)]()),serverExpress[_0x2182cb(0x218)](passport[_0x2182cb(0x1fc)]()),serverExpress[_0x2182cb(0x218)](passport['session']());const storage=multer[_0x2182cb(0x1bf)]({'destination':path[_0x2182cb(0x1b1)](__dirname,_0x2182cb(0x219)),'filename':(_0x1be7fc,_0x5076e4,_0x4e24db,_0x324e3e)=>{const _0x1db5ac=_0x2182cb;_0x4e24db(null,uuid()+path[_0x1db5ac(0x283)](_0x5076e4[_0x1db5ac(0x215)]));}});serverExpress[_0x2182cb(0x218)](multer({'storage':storage})[_0x2182cb(0x1c7)](_0x2182cb(0x274))),serverExpress['use']((_0x187c45,_0x56c197,_0xe3e64e)=>{const _0x563c4d=_0x2182cb;serverExpress[_0x563c4d(0x1b9)]['success']=_0x187c45[_0x563c4d(0x1d1)](_0x563c4d(0x1de)),serverExpress[_0x563c4d(0x1b9)][_0x563c4d(0x1f1)]=_0x187c45['flash'](_0x563c4d(0x1f1)),serverExpress[_0x563c4d(0x1b9)][_0x563c4d(0x27a)]=_0x187c45[_0x563c4d(0x27a)],serverExpress[_0x563c4d(0x1b9)][_0x563c4d(0x1ef)]=_0x187c45[_0x563c4d(0x1ef)],serverExpress[_0x563c4d(0x1b9)][_0x563c4d(0x226)]=0x0,serverExpress[_0x563c4d(0x1b9)][_0x563c4d(0x1ec)]=0x0,_0xe3e64e();});const http=require(_0x2182cb(0x1df)),server=http[_0x2182cb(0x287)](serverExpress),{Server}=require(_0x2182cb(0x1f6)),io=new Server(server),users={},connectedEmployees={},companyLimitsCache={},chat=require(_0x2182cb(0x237));io['on'](_0x2182cb(0x23d),async _0x38d599=>{const _0x2222ca=_0x2182cb;_0x38d599['on'](_0x2222ca(0x1af),async(_0x2c817e,_0x38889b)=>{const _0x445f77=_0x2222ca,_0x2c48fd=connectedEmployees[_0x38889b]||[],_0x5e8e0b=_0x2c48fd[_0x445f77(0x238)](_0x558da6=>_0x558da6[_0x445f77(0x265)]===_0x2c817e);if(_0x5e8e0b){_0x38d599[_0x445f77(0x27c)](_0x445f77(0x255),'Ups,\x20parece\x20que\x20ya\x20est谩s\x20conectado\x20en\x20otro\x20dispositivo.');return;}if(system!=_0x445f77(0x263)){!companyLimitsCache[_0x38889b]&&(companyLimitsCache[_0x38889b]=await chat[_0x445f77(0x211)](_0x38889b));const _0x4a7251=companyLimitsCache[_0x38889b];if(_0x2c48fd[_0x445f77(0x1e2)]>=_0x4a7251){_0x38d599[_0x445f77(0x27c)](_0x445f77(0x255),_0x445f77(0x1e3));return;}}_0x38d599[_0x445f77(0x22c)]=_0x38889b,_0x2c48fd[_0x445f77(0x223)]({'userId':_0x2c817e,'socketId':_0x38d599['id']}),connectedEmployees[_0x38889b]=_0x2c48fd;const _0x27b4c2=await chat['get_the_first_notification'](_0x2c817e,0xa);io['to'](_0x2c817e)[_0x445f77(0x27c)](_0x445f77(0x1d3),{'notifications':_0x27b4c2});});async function _0x4a0195(_0x46102d){const _0x279c42=_0x2222ca,_0x214b30=users[_0x46102d];let _0x59538b=_0x214b30;!_0x214b30&&(_0x59538b=await chat[_0x279c42(0x264)](toUserId));const _0x3a7c5a={'canSend':_0x59538b,'theUserIsConnect':_0x214b30};return _0x3a7c5a;}_0x38d599['on'](_0x2222ca(0x204),async({userEmail:_0x3ea12e,toUserEmail:_0x3e74db,message:_0x39714c})=>{const _0x55dd91=_0x2222ca,_0x51843d=await _0x4a0195(_0x3e74db);_0x51843d['canSend']?await chat['create_notification'](_0x3ea12e,_0x3e74db,_0x39714c)?(_0x51843d[_0x55dd91(0x1b6)]&&io['to'](recipientSocketId)[_0x55dd91(0x27c)](_0x55dd91(0x1f8),{'userId':userId,'message':_0x39714c}),_0x38d599[_0x55dd91(0x27c)](_0x55dd91(0x220),{'success':!![],'message':_0x55dd91(0x1b0)})):_0x38d599[_0x55dd91(0x27c)](_0x55dd91(0x220),{'success':![],'message':'No\x20pudimos\x20enviar\x20el\x20mensaje\x20al\x20usuario\x20\x27'+_0x3e74db+_0x55dd91(0x20d)}):_0x38d599['emit']('messageStatus',{'success':![],'message':_0x55dd91(0x212)+_0x3e74db+_0x55dd91(0x21f)});}),_0x38d599['on'](_0x2222ca(0x253),async({userEmail:_0xbc59a0})=>{const _0x1f6fa2=_0x2222ca,_0x36784d=await chat['get_the_first_notification'](_0xbc59a0,0xa);io['to'](recipientSocketId)[_0x1f6fa2(0x27c)](_0x1f6fa2(0x1d3),{'notifications':_0x36784d});}),_0x38d599['on'](_0x2222ca(0x1c1),async({userId:_0x5ed10a,toUserId:_0x4f2c73,message:_0x343c27})=>{const _0x31970e=_0x2222ca,_0xf5dab6=users[_0x4f2c73];let _0x473575=_0xf5dab6;!_0xf5dab6&&(_0x473575=await chat['this_email_exist'](_0x4f2c73));if(_0x473575){const _0x1c1280=await chat[_0x31970e(0x242)](_0x5ed10a,_0x4f2c73);await chat['send_new_message'](_0x1c1280,_0x5ed10a,_0x343c27)&&(_0xf5dab6&&io['to'](_0xf5dab6)['emit']('privateMessage',{'userId':_0x5ed10a,'message':_0x343c27})),_0x38d599[_0x31970e(0x27c)](_0x31970e(0x220),{'success':!![],'message':'Mensaje\x20enviado\x20con\x20茅xito'});}else _0x38d599[_0x31970e(0x27c)]('messageStatus',{'success':![],'message':_0x31970e(0x24b)+_0x4f2c73+_0x31970e(0x1d6)});}),_0x38d599['on']('disconnect',()=>{const _0x3c6e87=_0x2222ca,{companyId:_0x16cbc8}=_0x38d599;_0x16cbc8&&connectedEmployees[_0x16cbc8]?(connectedEmployees[_0x16cbc8]=connectedEmployees[_0x16cbc8][_0x3c6e87(0x1d7)](_0x2f29af=>_0x2f29af[_0x3c6e87(0x256)]!==_0x38d599['id']),connectedEmployees[_0x16cbc8][_0x3c6e87(0x1e2)]===0x0&&delete connectedEmployees[_0x16cbc8]):console[_0x3c6e87(0x266)](_0x3c6e87(0x1fa)+_0x38d599['id']+_0x3c6e87(0x1c6));}),_0x38d599['on'](_0x2222ca(0x284),_0x1e57d1=>{const _0xf2a132=_0x2222ca;console[_0xf2a132(0x266)]('Nueva\x20notificaci贸n:',_0x1e57d1),_0x38d599[_0xf2a132(0x26c)][_0xf2a132(0x27c)](_0xf2a132(0x1e7),_0x1e57d1);});});const companyName=_0x2182cb(0x21a);serverExpress[_0x2182cb(0x218)](require('./router')),serverExpress[_0x2182cb(0x218)](require('./router/authentication')),serverExpress[_0x2182cb(0x218)](companyName,require('./router/links')),serverExpress[_0x2182cb(0x218)](companyName,require('./router/links/fudone')),serverExpress['use'](companyName,require(_0x2182cb(0x1ee))),serverExpress[_0x2182cb(0x218)](companyName,require(_0x2182cb(0x26f))),serverExpress[_0x2182cb(0x218)](companyName,require(_0x2182cb(0x1b7))),serverExpress[_0x2182cb(0x218)](companyName,require(_0x2182cb(0x21e))),serverExpress[_0x2182cb(0x218)](companyName,require(_0x2182cb(0x243))),serverExpress[_0x2182cb(0x218)](companyName,require(_0x2182cb(0x221))),serverExpress['use'](companyName,require(_0x2182cb(0x289))),serverExpress[_0x2182cb(0x218)](companyName,require(_0x2182cb(0x200))),serverExpress[_0x2182cb(0x218)](companyName,require(_0x2182cb(0x202))),serverExpress[_0x2182cb(0x218)](companyName,require(_0x2182cb(0x1ff))),serverExpress[_0x2182cb(0x218)](companyName,require(_0x2182cb(0x280))),serverExpress[_0x2182cb(0x218)](require('./lib/addFrom')),serverExpress['use'](express['static'](path[_0x2182cb(0x1b1)](__dirname,'public')));const os=require('os');function getLocalIP(){const _0x37ba16=_0x2182cb,_0x580e2d=os[_0x37ba16(0x260)]();for(let _0x6fa106 in _0x580e2d){for(let _0x26e1be=0x0;_0x26e1be<_0x580e2d[_0x6fa106]['length'];_0x26e1be++){const _0x4529dc=_0x580e2d[_0x6fa106][_0x26e1be];if(_0x4529dc[_0x37ba16(0x1b3)]===_0x37ba16(0x1ce)&&!_0x4529dc[_0x37ba16(0x20b)])return _0x4529dc[_0x37ba16(0x21b)];}}return _0x37ba16(0x1f5);}const axios=require('axios');async function get_answer_of_my_api(_0x373be0,_0x28638d){const _0x266f1e=_0x2182cb,_0x496926=path[_0x266f1e(0x1b1)](__dirname,'logfile.txt');fs[_0x266f1e(0x1d0)](_0x496926,_0x266f1e(0x1d8),'utf8');try{const _0x25d2fd=await axios[_0x266f1e(0x22d)](_0x266f1e(0x27e)+_0x373be0,_0x28638d,{'headers':{'Content-Type':_0x266f1e(0x205)}});return fs[_0x266f1e(0x1d0)](_0x496926,'Error\x20verificando\x20actualizaciones:\x20'+_0x25d2fd[_0x266f1e(0x23f)]+_0x266f1e(0x248),_0x266f1e(0x23b)),_0x25d2fd;}catch(_0xabee6d){return fs['appendFileSync'](_0x496926,_0x266f1e(0x282)+_0xabee6d[_0x266f1e(0x1f1)]+'\x0a'+_0xabee6d[_0x266f1e(0x27d)]+'\x0a\x0a',_0x266f1e(0x23b)),{'success':![],'message':'Hubo\x20un\x20error\x20al\x20hacer\x20la\x20solicitud.'};}}let mainWindow,activationWindow,loginWindow;const createMainWindow=()=>{const _0x4523f9=_0x2182cb;mainWindow=new BrowserWindow({'width':0x320,'height':0x258}),mainWindow[_0x4523f9(0x203)](),mainWindow['loadURL'](_0x4523f9(0x286)+serverExpress[_0x4523f9(0x1ea)](_0x4523f9(0x1e0)));},createMainWindowRegister=()=>{const _0x31584b=_0x2182cb;loginWindow=new BrowserWindow({'width':0x320,'height':0x258,'parent':mainWindow,'webPreferences':{'preload':path[_0x31584b(0x1b1)](__dirname,_0x31584b(0x208)),'nodeIntegration':!![],'contextIsolation':![]}}),loginWindow[_0x31584b(0x203)](),loginWindow['loadFile'](path[_0x31584b(0x1b1)](__dirname,'activation.html'));},{machineIdSync}=require(_0x2182cb(0x1f4)),deviceId=machineIdSync();ipcMain['on']('get_my_deviceId',async _0x140b1b=>{const _0xf1481d=_0x2182cb;console['log'](_0xf1481d(0x1e9)),_0x140b1b[_0xf1481d(0x273)](_0xf1481d(0x245),deviceId);}),ipcMain['on'](_0x2182cb(0x251),async(_0x1e3330,_0x4ac187)=>{const _0x11b0fd=_0x2182cb,_0x4cb58d=_0x4ac187['dataToken'];await initialize_token(_0x4cb58d[_0x11b0fd(0x230)]),await create_expiration_date_of_the_token(_0x4cb58d[_0x11b0fd(0x239)]);const _0xf7af54=_0x11b0fd(0x27b);_0x1e3330[_0x11b0fd(0x273)](_0x11b0fd(0x251),_0xf7af54);}),ipcMain['on']('login-from-render-token',async(_0x3f1e60,_0x41225e)=>{const _0x144987=_0x2182cb,_0x20bed2=_0x41225e['token'],_0x313cc7=await see_if_exist_this_token_in_the_database_of_the_web(_0x20bed2);if(_0x313cc7['token']){let _0x2d30a4=!![];_0x313cc7['uuid']&&(_0x313cc7[_0x144987(0x22b)]!==deviceId&&(_0x313cc7['message']=_0x144987(0x235),_0x2d30a4=![])),_0x2d30a4&&(await save_the_uui_of_the_user_in_the_database(_0x20bed2,deviceId)&&(await initialize_token(_0x20bed2),await create_expiration_date_of_the_token(_0x313cc7[_0x144987(0x24d)]),_0x313cc7[_0x144987(0x1f1)]=_0x144987(0x27b)));}_0x3f1e60[_0x144987(0x273)](_0x144987(0x1d4),_0x313cc7['message']);}),ipcMain['on'](_0x2182cb(0x257),async(_0x4f3b0c,_0x2636ad)=>{const _0x334d0a=_0x2182cb,_0x587e5e=_0x2636ad['username'],_0x979316=_0x2636ad[_0x334d0a(0x1bd)],_0x51c1f4=await see_if_exist_this_user_in_the_database_of_the_web(_0x587e5e,_0x979316);if(_0x51c1f4['token']){if(_0x51c1f4[_0x334d0a(0x22b)]&&_0x51c1f4[_0x334d0a(0x22b)]!==deviceId)_0x51c1f4[_0x334d0a(0x1f1)]=_0x334d0a(0x235);else{if(await save_the_uui_of_the_user_in_the_database(_0x587e5e,deviceId)){}}}_0x4f3b0c[_0x334d0a(0x273)]('answer-from-login-render',_0x51c1f4[_0x334d0a(0x1f1)]);});const bcrypt=require(_0x2182cb(0x25f));async function see_if_exist_this_user_in_the_database_of_the_web(_0x3b82ec,_0x5888f4){const _0x55642c=_0x2182cb;try{const _0x104d9b=await get_answer_of_my_api('get_information_of_the_user.php',{'email':_0x3b82ec});if(!_0x104d9b[_0x55642c(0x23f)][_0x55642c(0x1de)])return{'token':null,'message':_0x55642c(0x207)};const _0x4fddee=_0x104d9b[_0x55642c(0x23f)],_0x227185=await bcrypt['compare'](_0x5888f4,_0x4fddee['hashedPassword']);if(!_0x227185)return{'token':null,'message':_0x55642c(0x240)};const _0x476d73=await get_answer_of_my_api(_0x55642c(0x262),{'userId':_0x4fddee['id']});if(_0x476d73[_0x55642c(0x23f)][_0x55642c(0x1de)])return{'token':null,'message':_0x55642c(0x1c5)};const _0xede3fb=_0x476d73[_0x55642c(0x23f)],_0x3456a8=new Date();_0x3456a8['setFullYear'](_0x3456a8[_0x55642c(0x252)]()-0x1);if(new Date(_0x4fddee[_0x55642c(0x24d)])<_0x3456a8)return{'token':null,'message':_0x55642c(0x1c3)};return console['log'](_0x55642c(0x1e8)),{'token':_0xede3fb['token'],'type_membresy':_0xede3fb['type_membresy'],'message':'Usuario\x20autenticado\x20con\x20茅xito.'};}catch(_0x233a4b){return console[_0x55642c(0x233)]('Error\x20al\x20verificar\x20usuario:',_0x233a4b),{'token':null};}}async function see_if_exist_this_token_in_the_database_of_the_web(_0x18ab13){const _0x45fc9a=_0x2182cb;try{const _0x37bb1d=await get_answer_of_my_api(_0x45fc9a(0x250),{'token':_0x18ab13});if(!_0x37bb1d[_0x45fc9a(0x23f)]['success'])return{'token':null,'message':'Token\x20no\x20encontrado.'};const _0x274f82=_0x37bb1d[_0x45fc9a(0x23f)],_0x4ae686=new Date();_0x274f82[_0x45fc9a(0x1f3)]==0x0?_0x4ae686[_0x45fc9a(0x1db)](_0x4ae686[_0x45fc9a(0x216)]()-0x1e):_0x4ae686['setFullYear'](_0x4ae686[_0x45fc9a(0x252)]()-0x1);if(_0x274f82[_0x45fc9a(0x24d)]!='0000-00-00'&&new Date(_0x274f82[_0x45fc9a(0x24d)])<_0x4ae686)return{'token':null,'message':_0x45fc9a(0x1c3)};if(_0x274f82[_0x45fc9a(0x24d)]===_0x45fc9a(0x24a)){const _0x1af3a4=new Date();_0x274f82[_0x45fc9a(0x1f3)]==0x0?_0x1af3a4[_0x45fc9a(0x1db)](_0x4ae686[_0x45fc9a(0x216)]()+0x1e):_0x1af3a4[_0x45fc9a(0x285)](_0x1af3a4['getFullYear']()+0x1);const _0x100719=await get_answer_of_my_api(_0x45fc9a(0x1c0),{'suscripcion':_0x1af3a4[_0x45fc9a(0x209)]()[_0x45fc9a(0x1bb)]('T')[0x0],'token':_0x18ab13});return _0x100719['data'][_0x45fc9a(0x1de)]?(_0x274f82[_0x45fc9a(0x24d)]=_0x1af3a4,console[_0x45fc9a(0x266)](_0x45fc9a(0x1e8)),{'token':!![],'type_membresy':_0x274f82[_0x45fc9a(0x1f3)],'uuid':_0x274f82[_0x45fc9a(0x279)],'activation_date':_0x274f82[_0x45fc9a(0x24d)],'message':_0x45fc9a(0x1e8)}):{'token':null,'message':_0x45fc9a(0x1f9)};}}catch(_0x4d2cf9){return console['error'](_0x45fc9a(0x1bc),_0x4d2cf9),{'token':null,'message':_0x4d2cf9};}}async function save_the_uui_of_the_user_in_the_database(_0x532758,_0x42b42f){const _0x9b3737=_0x2182cb;try{const _0xb64e7b=await get_answer_of_my_api(_0x9b3737(0x250),{'token':_0x532758,'deviceId':_0x42b42f});return _0xb64e7b[_0x9b3737(0x23f)][_0x9b3737(0x1de)];}catch(_0x3d8b09){return console[_0x9b3737(0x233)](_0x9b3737(0x1cb),_0x3d8b09),![];}}async function verificarTokenActivo(){const _0x2878af=_0x2182cb,_0x3cf2d1=_0x2878af(0x206);try{const _0x50cb38=await pool['query'](_0x3cf2d1,[TOKEN]);return console[_0x2878af(0x266)](_0x50cb38[0x0]),_0x50cb38[0x0][_0x2878af(0x268)]===0x1?(console[_0x2878af(0x266)](_0x2878af(0x22a)),!![]):(console['log']('El\x20token\x20no\x20est谩\x20activo\x20o\x20no\x20existe.'),![]);}catch(_0x55ff67){return console[_0x2878af(0x233)](_0x2878af(0x1e4),_0x55ff67),![];}}async function actualizarToken(){const _0x1b428a=_0x2182cb,_0x17791f=_0x1b428a(0x244);await pool[_0x1b428a(0x275)](_0x17791f,[TOKEN]);}app['on'](_0x2182cb(0x247),async()=>{const _0x54bf29=_0x2182cb;if(thiIsADemo){await initialize_demo();if(await is_demo_expired()){dialog[_0x54bf29(0x1eb)]({'type':_0x54bf29(0x1ca),'title':_0x54bf29(0x213),'message':_0x54bf29(0x23a)}),app['quit']();return;}}else await verify_membership_of_user()?(serverExpress[_0x54bf29(0x20e)](serverExpress[_0x54bf29(0x1ea)](_0x54bf29(0x1e0)),_0x54bf29(0x246),()=>{const _0x1daaac=_0x54bf29;console[_0x1daaac(0x266)](_0x1daaac(0x270)+getLocalIP()+':'+serverExpress['get']('port'));}),createMainWindow()):createMainWindowRegister();}),app['on']('window-all-closed',()=>{const _0x37a3d6=_0x2182cb;process[_0x37a3d6(0x261)]!==_0x37a3d6(0x236)&&app['quit']();});