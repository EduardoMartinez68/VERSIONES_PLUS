const _0x574deb=_0x30ac;(function(_0x5e7bc2,_0x30be75){const _0x218c7a=_0x30ac,_0x596d8c=_0x5e7bc2();while(!![]){try{const _0x6b2457=parseInt(_0x218c7a(0xb4))/0x1+-parseInt(_0x218c7a(0x12d))/0x2*(parseInt(_0x218c7a(0xb5))/0x3)+-parseInt(_0x218c7a(0x15b))/0x4+-parseInt(_0x218c7a(0x16f))/0x5+-parseInt(_0x218c7a(0x136))/0x6*(-parseInt(_0x218c7a(0x13b))/0x7)+-parseInt(_0x218c7a(0xf7))/0x8*(parseInt(_0x218c7a(0xc6))/0x9)+-parseInt(_0x218c7a(0xe9))/0xa*(-parseInt(_0x218c7a(0xa7))/0xb);if(_0x6b2457===_0x30be75)break;else _0x596d8c['push'](_0x596d8c['shift']());}catch(_0x4196db){_0x596d8c['push'](_0x596d8c['shift']());}}}(_0x5327,0xd6832));const system=require('./lib/system'),thiIsADemo=![],{app,BrowserWindow,dialog,ipcMain}=require(_0x574deb(0xd1)),express=require(_0x574deb(0xb3)),morgan=require('morgan'),{engine}=require(_0x574deb(0x14e)),multer=require('multer'),flash=require('connect-flash'),session=require('express-session'),passport=require('passport'),{database}=require(_0x574deb(0x161)),{v4:uuid}=require(_0x574deb(0xbd)),path=require(_0x574deb(0xfc)),{RecaptchaV2}=require('express-recaptcha'),nodePersist=require(_0x574deb(0x94));nodePersist[_0x574deb(0xae)]({'dir':path[_0x574deb(0x127)](__dirname,_0x574deb(0x112))});async function initialize_software(){const _0x5e06a3=_0x574deb,_0x593544=await nodePersist[_0x5e06a3(0xbf)](_0x5e06a3(0x137));!_0x593544&&await nodePersist[_0x5e06a3(0x13f)]('installToken',_0x5e06a3(0xcb));}async function the_software_have_a_token(){const _0x478bb0=_0x574deb,_0x28d9b3=await nodePersist['get']('installToken');if(!_0x28d9b3)return![];return _0x28d9b3!=_0x478bb0(0xcb);}async function create_expiration_date_of_the_token(_0x11c339){const _0x5aad77=_0x574deb,_0x1e319c=await nodePersist[_0x5aad77(0xbf)](_0x5aad77(0xd7));!_0x1e319c&&await nodePersist[_0x5aad77(0x13f)](_0x5aad77(0xd7),_0x11c339);}async function token_expired(){const _0x2ccee6=_0x574deb,_0xd61af8=await nodePersist['get'](_0x2ccee6(0xd7)),_0x55105c=new Date(_0xd61af8),_0x182177=new Date();return _0x182177<_0x55105c;}async function remove_install_token(){const _0xfff22b=_0x574deb;await nodePersist[_0xfff22b(0x123)](_0xfff22b(0x137)),await nodePersist[_0xfff22b(0x123)](_0xfff22b(0xd7)),console[_0xfff22b(0x97)](_0xfff22b(0x150));}async function initialize_token(_0x55daf1){const _0x454df0=_0x574deb,_0x4839c9=await nodePersist[_0x454df0(0xbf)](_0x454df0(0x137));await nodePersist[_0x454df0(0x13f)]('installToken',_0x55daf1);}async function initialize_demo(){const _0x4b039d=_0x574deb,_0x1ce2b3=await nodePersist[_0x4b039d(0xbf)](_0x4b039d(0xf8));if(!_0x1ce2b3){const _0x501859=new Date()[_0x4b039d(0x16c)]();await nodePersist[_0x4b039d(0x13f)](_0x4b039d(0x165),_0x501859),console['log']('Fecha\x20de\x20instalación\x20guardada:',_0x501859);}else console['log'](_0x4b039d(0x128),_0x1ce2b3);}async function is_demo_expired(){const _0x4dba7a=_0x574deb,_0x2e3174=await nodePersist['get']('installDemo');if(!_0x2e3174)return console[_0x4dba7a(0x97)](_0x4dba7a(0xca)),![];const _0x4ef7ef=new Date(_0x2e3174),_0x38e004=new Date(),_0x243242=_0x38e004-_0x4ef7ef,_0x21de8b=_0x243242/(0x3e8*0x3c*0x3c*0x18);return _0x21de8b>0x1e?(console['log'](_0x4dba7a(0x14f)),!![]):(console[_0x4dba7a(0x97)](_0x4dba7a(0xda)),![]);}async function this_software_count_have_a_count(){}async function the_user_have_a_token_active_in_the_database(){}function _0x5327(){const _0x331c9e=['public','✅\x20La\x20aplicación\x20ya\x20está\x20actualizada.','map','30fCaQxH','flash','catch','\x27\x20no\x20existe.\x20🤔','json','Pool','https://github.com/EduardoMartinez68/VERSIONES_PLUS','get_information_of_the_user.php','messageStatus','error','maximize','connect','socketId','setDate','27688EoPyjd','installDemo','origin','node-machine-id','--hard','path','📂\x20La\x20base\x20de\x20datos\x20EDPLUS\x20ya\x20existe,\x20no\x20se\x20creó\x20nuevamente.','token','ENTRE','http://localhost:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SET\x20active\x20=\x20false\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','session','theUserIsConnect','./lib/handlebars','postgres','./router/links/branch','device_id','application/json','getFullYear','info','message','loadURL','password','then','./router/links','.hbs','see_if_exist_this_token_in_the_database_of_the_web.php','data','family','sendMessageToUser','showMessageBoxSync','split','privateNotifications','/links','companyId','❌\x20Error\x20ejecutando\x20SQL:','Demo\x20Expirada','\x0a\x0a\x0a','company','./router/links/fudone','hashedPassword','axios','./router/links/prescription','reply','removeItem','warning','view\x20engine','SELECT\x201\x20FROM\x20pg_database\x20WHERE\x20datname\x20=\x20\x27edplus\x27','join','Fecha\x20de\x20instalación\x20existente:','get_the_first_notification','sendNotification','diskStorage','Mensaje\x20enviado\x20con\x20éxito','2DbGdXx','pack_company','utf8','userId','0000-00-00','./router/links/subscription','setFullYear','login-from-render-token','./lib/editFrom','198dISvKi','installToken','./router/links/boutique','answer_get_my_deviceId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x20*\x20FROM\x20pagos\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20token\x20=\x20?\x0a\x20\x20\x20\x20','153447vaagzw','views','📦\x20Base\x20de\x20datos\x20EDPLUS\x20creada','internal','set','Error\x20al\x20agregar\x20el\x20repositorio\x20remoto','length','Actualización','Ocurrio\x20un\x20error\x20al\x20verificar\x20tu\x20Token\x20en\x20el\x20ultimo\x20paso,\x20intentalo\x20otra\x20vez.','\x27.\x20Inténtalo\x20de\x20nuevo.\x20😳','Este\x20usuario\x20no\x20tiene\x20ningun\x20Token\x20activo.','./router/links/CRM','Reiniciar\x20ahora','simple-git','Error\x20al\x20verificar\x20el\x20token:','Suscripción\x20expirada.\x20Por\x20favor,\x20vuelve\x20a\x20activar\x20tu\x20membresía.','http','expiration_date','some','express-handlebars','La\x20demo\x20ha\x20expirado.','installToken\x20eliminado','main','edplus.sql','sendNotificationToUser','./router/links/ceo','port','ready','CREATE\x20DATABASE\x20edplus','hash','update_data_of_the_token_in_this_drive','answer-from-login-render','4206796snpBue','0.0.0.0','Nueva\x20notificación:','Datos\x20actualizados\x20con\x20éxito.\x20Cierra\x20y\x20vuelve\x20a\x20abrir\x20el\x20programa\x20😄','socket.io','getDate','./keys','loadFile','./router/links/desktop','filter','installDate','appendFileSync','connectionRejected','activation_date','❌\x20Error\x20verificando\x20actualizaciones:','Token\x20no\x20encontrado.','use','toISOString','./router/authentication','./router/links/cashCut','3835365mhjdzS','get_data_of_the_token_with_the_user_id.php','disconnect','update_activation_date.php','https://www.pluspuntodeventa.com/api/','user','broadcast','post','emit','PORT','node-persist','Usuario\x20no\x20encontrado.','Se\x20ha\x20descargado\x20una\x20nueva\x20versión.\x20Reinicia\x20la\x20aplicación\x20para\x20aplicar\x20los\x20cambios.','log','Server\x20running\x20on\x20http://','success','database','privateMessage','raw','platform','stack','logfile.txt','./router/links/store','networkInterfaces','Usuario\x20autenticado\x20con\x20éxito.','username','this_email_exist','✅\x20SQL\x20ejecutado\x20correctamente','send_new_message','12691767sWjXFE','reset','single','createServer','compare','get_my_deviceId','Error\x20verificando\x20actualizaciones:\x20','init','bcrypt','HEAD','El\x20usuario\x20\x27','\x27\x20no\x20existe\x20🤔','express','945867mKyTRa','4703961XJkWPi','query','quit','readFileSync','./router/links/app','dev','Contraseña\x20incorrecta.','Error\x20al\x20actualizar\x20el\x20UUID\x20del\x20dispositivo:','uuid','extname','get','addRemote','dataToken','login-from-render','connect-pg-simple','get_max_employee_of_this_company','activation.html','2250xqevhE','latest','type_membresy','\x20desconectado,\x20pero\x20no\x20estaba\x20asociado\x20a\x20ninguna\x20empresa.','No\x20se\x20encontró\x20la\x20fecha\x20de\x20instalación','false','create_notification','FudSession','dotenv','relaunch','image','electron','Este\x20email\x20\x27','create_new_chat','Error\x20al\x20verificar\x20usuario:','Mensaje\x20enviado\x20con\x20éxito.\x20👌','🔄\x20Nueva\x20versión\x20encontrada,\x20actualizando...','expirationDateOFTheToken','locals','initialize','La\x20demo\x20aún\x20está\x20activa.','rowCount','listen','release','window-all-closed','registerUser','pull','./lib/passport','No\x20pudimos\x20enviar\x20el\x20mensaje\x20al\x20usuario\x20\x27','env','./lib/addFrom','address'];_0x5327=function(){return _0x331c9e;};return _0x5327();}async function verify_membership_of_user(){initialize_software();if(await the_software_have_a_token())return await token_expired();return![];}const simpleGit=require(_0x574deb(0x148)),fs=require('fs'),repoPath=path['join'](__dirname),git=simpleGit(repoPath),repoURL=_0x574deb(0xef),remote='origin';git[_0x574deb(0xc0)](remote,repoURL)[_0x574deb(0x10e)](()=>{console['log']('Repositorio\x20remoto\x20configurado\x20correctamente');})[_0x574deb(0xeb)](_0x4eca28=>{const _0xce84ae=_0x574deb;console[_0xce84ae(0xf2)](_0xce84ae(0x140),_0x4eca28);});async function check_if_exist_updates(){const _0x58ed80=_0x574deb;try{await git['fetch'](remote);const _0x373b29=await git[_0x58ed80(0x97)]([remote+'/main','-1']),_0x18e9cd=await git['log']([_0x58ed80(0xb0),'-1']);_0x373b29['latest'][_0x58ed80(0x158)]!==_0x18e9cd[_0x58ed80(0xc7)][_0x58ed80(0x158)]?(console[_0x58ed80(0x97)](_0x58ed80(0xd6)),await git[_0x58ed80(0x9c)]([_0x58ed80(0xa8),_0x58ed80(0xfb),remote+'/main']),await git[_0x58ed80(0xe0)](_0x58ed80(0xf9),'main',{'--rebase':null}),dialog[_0x58ed80(0x115)]({'type':_0x58ed80(0x10a),'title':_0x58ed80(0x142),'message':_0x58ed80(0x96),'buttons':[_0x58ed80(0x147)]}),app[_0x58ed80(0xcf)](),app[_0x58ed80(0xb7)]()):console['log'](_0x58ed80(0xe7));}catch(_0x2bbc1a){const _0x153478=path[_0x58ed80(0x127)](__dirname,_0x58ed80(0x9f));fs[_0x58ed80(0x166)](_0x153478,_0x58ed80(0xad)+_0x2bbc1a['message']+'\x0a'+_0x2bbc1a[_0x58ed80(0x9e)]+'\x0a\x0a','utf8'),console[_0x58ed80(0xf2)](_0x58ed80(0x169),_0x2bbc1a),dialog[_0x58ed80(0x115)]({'type':'warning','title':'Error\x20verificando\x20actualizaciones!','message':'Error\x20verificando\x20actualizaciones:\x20'+_0x2bbc1a['message']+'\x0a'+_0x2bbc1a['stack']+'\x0a\x0a'});}}const serverExpress=express();require(_0x574deb(0xe1)),require(_0x574deb(0x135)),serverExpress[_0x574deb(0x13f)](_0x574deb(0x155),process[_0x574deb(0xe3)][_0x574deb(0x93)]||0xfa0),serverExpress[_0x574deb(0x13f)](_0x574deb(0x13c),path[_0x574deb(0x127)](__dirname,_0x574deb(0x13c))),serverExpress['engine'](_0x574deb(0x110),engine({'defaultLayout':_0x574deb(0x151),'layoutsDir':path[_0x574deb(0x127)](serverExpress[_0x574deb(0xbf)](_0x574deb(0x13c)),'layouts'),'partialsDir':path[_0x574deb(0x127)](serverExpress[_0x574deb(0xbf)]('views'),'partials'),'extname':_0x574deb(0x110),'helpers':require(_0x574deb(0x104))})),serverExpress[_0x574deb(0x13f)](_0x574deb(0x125),_0x574deb(0x110)),require(_0x574deb(0xce))['config']();const {APP_PG_USER,APP_PG_HOST,APP_PG_DATABASE,APP_PG_PASSWORD,APP_PG_PORT,TOKEN}=process[_0x574deb(0xe3)],pg=require('pg'),adminPool=new pg[(_0x574deb(0xee))]({'user':APP_PG_USER,'host':APP_PG_HOST,'password':APP_PG_PASSWORD,'port':APP_PG_PORT,'database':_0x574deb(0x105)}),importSQLFile=async _0x3ed18c=>{const _0x168b15=_0x574deb,_0x1cd2fa=path['join'](__dirname,_0x168b15(0x9a),_0x168b15(0x152)),_0x527356=fs[_0x168b15(0xb8)](_0x1cd2fa,_0x168b15(0x12f)),_0x4d30b4=_0x527356[_0x168b15(0x116)](/;\s*$/m)[_0x168b15(0xe8)](_0x922513=>_0x922513['trim']())[_0x168b15(0x164)](_0x366977=>_0x366977[_0x168b15(0x141)]>0x0),_0x1af1e9=await _0x3ed18c[_0x168b15(0xf4)]();try{for(const _0x52e41c of _0x4d30b4){await _0x1af1e9[_0x168b15(0xb6)](_0x52e41c);}console['log'](_0x168b15(0xa5));}catch(_0x5e1415){console[_0x168b15(0xf2)](_0x168b15(0x11a),_0x5e1415[_0x168b15(0x10b)]);}finally{_0x1af1e9[_0x168b15(0xdd)]();}},createDatabase=async()=>{const _0x2b8c51=_0x574deb,_0x426f7e=await adminPool[_0x2b8c51(0xb6)](_0x2b8c51(0x126));_0x426f7e[_0x2b8c51(0xdb)]===0x0?(await adminPool[_0x2b8c51(0xb6)](_0x2b8c51(0x157)),importSQLFile(adminPool),console[_0x2b8c51(0x97)](_0x2b8c51(0x13d))):console[_0x2b8c51(0x97)](_0x2b8c51(0xfd));};createDatabase();const pgPool=new pg[(_0x574deb(0xee))]({'user':APP_PG_USER,'host':APP_PG_HOST,'database':APP_PG_DATABASE,'password':APP_PG_PASSWORD,'port':APP_PG_PORT});serverExpress[_0x574deb(0x16b)](session({'secret':_0x574deb(0xcd),'resave':![],'saveUninitialized':![],'store':new(require(_0x574deb(0xc3))(session))({'pool':pgPool,'tableName':_0x574deb(0x102)})})),serverExpress[_0x574deb(0x16b)](flash()),serverExpress['use'](morgan(_0x574deb(0xba))),serverExpress[_0x574deb(0x16b)](express['urlencoded']({'extended':![]})),serverExpress[_0x574deb(0x16b)](express[_0x574deb(0xed)]()),serverExpress[_0x574deb(0x16b)](passport[_0x574deb(0xd9)]()),serverExpress[_0x574deb(0x16b)](passport[_0x574deb(0x102)]());const storage=multer[_0x574deb(0x12b)]({'destination':path['join'](__dirname,'public/img/uploads'),'filename':(_0x57ab17,_0x59e8aa,_0x2386ef,_0x2915b7)=>{const _0x5a4cf2=_0x574deb;_0x2386ef(null,uuid()+path[_0x5a4cf2(0xbe)](_0x59e8aa['originalname']));}});serverExpress[_0x574deb(0x16b)](multer({'storage':storage})[_0x574deb(0xa9)](_0x574deb(0xd0))),serverExpress[_0x574deb(0x16b)]((_0x507df1,_0x46193a,_0x23fdf4)=>{const _0x4260c2=_0x574deb;serverExpress[_0x4260c2(0xd8)][_0x4260c2(0x99)]=_0x507df1[_0x4260c2(0xea)]('success'),serverExpress[_0x4260c2(0xd8)]['message']=_0x507df1[_0x4260c2(0xea)](_0x4260c2(0x10b)),serverExpress[_0x4260c2(0xd8)][_0x4260c2(0x8f)]=_0x507df1[_0x4260c2(0x8f)],serverExpress[_0x4260c2(0xd8)][_0x4260c2(0x11d)]=_0x507df1[_0x4260c2(0x11d)],serverExpress[_0x4260c2(0xd8)][_0x4260c2(0x12e)]=0x0,serverExpress[_0x4260c2(0xd8)]['pack_branch']=0x0,_0x23fdf4();});function _0x30ac(_0x52dd71,_0x4bec01){const _0x53278c=_0x5327();return _0x30ac=function(_0x30acbd,_0x2ded52){_0x30acbd=_0x30acbd-0x8b;let _0x56361d=_0x53278c[_0x30acbd];return _0x56361d;},_0x30ac(_0x52dd71,_0x4bec01);}const http=require(_0x574deb(0x14b)),server=http[_0x574deb(0xaa)](serverExpress),{Server}=require(_0x574deb(0x15f)),io=new Server(server),users={},connectedEmployees={},companyLimitsCache={},chat=require('./services/chat.js');io['on']('connection',async _0x563b0b=>{const _0x53a26d=_0x574deb;_0x563b0b['on'](_0x53a26d(0xdf),async(_0x5d89d7,_0x23609b)=>{const _0x312c0c=_0x53a26d,_0x3fa6ec=connectedEmployees[_0x23609b]||[],_0x2630b7=_0x3fa6ec[_0x312c0c(0x14d)](_0x37db55=>_0x37db55[_0x312c0c(0x130)]===_0x5d89d7);if(_0x2630b7){_0x563b0b[_0x312c0c(0x92)](_0x312c0c(0x167),'Ups,\x20parece\x20que\x20ya\x20estás\x20conectado\x20en\x20otro\x20dispositivo.');return;}if(system!='desktop'){!companyLimitsCache[_0x23609b]&&(companyLimitsCache[_0x23609b]=await chat[_0x312c0c(0xc4)](_0x23609b));const _0x406864=companyLimitsCache[_0x23609b];if(_0x3fa6ec[_0x312c0c(0x141)]>=_0x406864){_0x563b0b['emit'](_0x312c0c(0x167),'Ups,\x20parece\x20que\x20alcanzaste\x20tu\x20límite\x20de\x20dispositivos\x20conectados.\x20Por\x20favor,\x20actualiza\x20tu\x20membresía.');return;}}_0x563b0b[_0x312c0c(0x119)]=_0x23609b,_0x3fa6ec['push']({'userId':_0x5d89d7,'socketId':_0x563b0b['id']}),connectedEmployees[_0x23609b]=_0x3fa6ec;const _0x5d2820=await chat[_0x312c0c(0x129)](_0x5d89d7,0xa);io['to'](_0x5d89d7)[_0x312c0c(0x92)]('privateNotifications',{'notifications':_0x5d2820});});async function _0x56d81f(_0x38a20e){const _0x21db32=_0x53a26d,_0x2fa659=users[_0x38a20e];let _0x171a36=_0x2fa659;!_0x2fa659&&(_0x171a36=await chat[_0x21db32(0xa4)](toUserId));const _0x336a96={'canSend':_0x171a36,'theUserIsConnect':_0x2fa659};return _0x336a96;}_0x563b0b['on'](_0x53a26d(0x153),async({userEmail:_0x4b1c26,toUserEmail:_0x52fdc8,message:_0x13a231})=>{const _0x3a71ab=_0x53a26d,_0x128288=await _0x56d81f(_0x52fdc8);_0x128288['canSend']?await chat[_0x3a71ab(0xcc)](_0x4b1c26,_0x52fdc8,_0x13a231)?(_0x128288[_0x3a71ab(0x103)]&&io['to'](recipientSocketId)[_0x3a71ab(0x92)](_0x3a71ab(0x9b),{'userId':userId,'message':_0x13a231}),_0x563b0b[_0x3a71ab(0x92)]('messageStatus',{'success':!![],'message':_0x3a71ab(0xd5)})):_0x563b0b[_0x3a71ab(0x92)](_0x3a71ab(0xf1),{'success':![],'message':_0x3a71ab(0xe2)+_0x52fdc8+_0x3a71ab(0x144)}):_0x563b0b[_0x3a71ab(0x92)](_0x3a71ab(0xf1),{'success':![],'message':_0x3a71ab(0xb1)+_0x52fdc8+_0x3a71ab(0xec)});}),_0x563b0b['on']('getTheFirstTenNotifications',async({userEmail:_0x37645b})=>{const _0x5a9759=_0x53a26d,_0x2e212f=await chat[_0x5a9759(0x129)](_0x37645b,0xa);io['to'](recipientSocketId)[_0x5a9759(0x92)](_0x5a9759(0x117),{'notifications':_0x2e212f});}),_0x563b0b['on'](_0x53a26d(0x114),async({userId:_0x55e61c,toUserId:_0x26e1e6,message:_0x42e6fa})=>{const _0x48c8b7=_0x53a26d,_0x218944=users[_0x26e1e6];let _0x1c7113=_0x218944;!_0x218944&&(_0x1c7113=await chat['this_email_exist'](_0x26e1e6));if(_0x1c7113){const _0x27400f=await chat[_0x48c8b7(0xd3)](_0x55e61c,_0x26e1e6);await chat[_0x48c8b7(0xa6)](_0x27400f,_0x55e61c,_0x42e6fa)&&(_0x218944&&io['to'](_0x218944)[_0x48c8b7(0x92)](_0x48c8b7(0x9b),{'userId':_0x55e61c,'message':_0x42e6fa})),_0x563b0b[_0x48c8b7(0x92)]('messageStatus',{'success':!![],'message':_0x48c8b7(0x12c)});}else _0x563b0b[_0x48c8b7(0x92)](_0x48c8b7(0xf1),{'success':![],'message':_0x48c8b7(0xd2)+_0x26e1e6+_0x48c8b7(0xb2)});}),_0x563b0b['on'](_0x53a26d(0x8c),()=>{const _0x309211=_0x53a26d,{companyId:_0x3c84bd}=_0x563b0b;_0x3c84bd&&connectedEmployees[_0x3c84bd]?(connectedEmployees[_0x3c84bd]=connectedEmployees[_0x3c84bd][_0x309211(0x164)](_0x3ebff7=>_0x3ebff7[_0x309211(0xf5)]!==_0x563b0b['id']),connectedEmployees[_0x3c84bd][_0x309211(0x141)]===0x0&&delete connectedEmployees[_0x3c84bd]):console[_0x309211(0x97)]('Socket\x20'+_0x563b0b['id']+_0x309211(0xc9));}),_0x563b0b['on'](_0x53a26d(0x12a),_0x305fd0=>{const _0x361048=_0x53a26d;console['log'](_0x361048(0x15d),_0x305fd0),_0x563b0b[_0x361048(0x90)]['emit']('newNotification',_0x305fd0);});});const companyName=_0x574deb(0x118);serverExpress[_0x574deb(0x16b)](require('./router')),serverExpress[_0x574deb(0x16b)](require(_0x574deb(0x16d))),serverExpress[_0x574deb(0x16b)](companyName,require(_0x574deb(0x10f))),serverExpress[_0x574deb(0x16b)](companyName,require(_0x574deb(0x11e))),serverExpress[_0x574deb(0x16b)](companyName,require(_0x574deb(0x154))),serverExpress[_0x574deb(0x16b)](companyName,require(_0x574deb(0x106))),serverExpress['use'](companyName,require(_0x574deb(0x132))),serverExpress[_0x574deb(0x16b)](companyName,require(_0x574deb(0xa0))),serverExpress[_0x574deb(0x16b)](companyName,require('./router/links/delivery')),serverExpress[_0x574deb(0x16b)](companyName,require(_0x574deb(0xb9))),serverExpress[_0x574deb(0x16b)](companyName,require(_0x574deb(0x146))),serverExpress['use'](companyName,require(_0x574deb(0x163))),serverExpress[_0x574deb(0x16b)](companyName,require(_0x574deb(0x138))),serverExpress['use'](companyName,require(_0x574deb(0x16e))),serverExpress[_0x574deb(0x16b)](companyName,require(_0x574deb(0x121))),serverExpress[_0x574deb(0x16b)](require(_0x574deb(0xe4))),serverExpress[_0x574deb(0x16b)](express['static'](path['join'](__dirname,_0x574deb(0xe6))));const os=require('os');function getLocalIP(){const _0x3f7e10=_0x574deb,_0x4ba3e1=os[_0x3f7e10(0xa1)]();for(let _0x1be648 in _0x4ba3e1){for(let _0x348029=0x0;_0x348029<_0x4ba3e1[_0x1be648]['length'];_0x348029++){const _0x134a24=_0x4ba3e1[_0x1be648][_0x348029];if(_0x134a24[_0x3f7e10(0x113)]==='IPv4'&&!_0x134a24[_0x3f7e10(0x13e)])return _0x134a24[_0x3f7e10(0xe5)];}}return'127.0.0.1';}const axios=require(_0x574deb(0x120));async function get_answer_of_my_api(_0x1fddbe,_0x20da84){const _0x1b9de3=_0x574deb,_0x4da3a8=path['join'](__dirname,_0x1b9de3(0x9f));fs['appendFileSync'](_0x4da3a8,_0x1b9de3(0xff),'utf8');try{const _0x45fc6a=await axios[_0x1b9de3(0x91)](_0x1b9de3(0x8e)+_0x1fddbe,_0x20da84,{'headers':{'Content-Type':_0x1b9de3(0x108)}});return fs[_0x1b9de3(0x166)](_0x4da3a8,_0x1b9de3(0xad)+_0x45fc6a[_0x1b9de3(0x112)]+_0x1b9de3(0x11c),_0x1b9de3(0x12f)),_0x45fc6a;}catch(_0x180d2c){return fs[_0x1b9de3(0x166)](_0x4da3a8,_0x1b9de3(0xad)+_0x180d2c[_0x1b9de3(0x10b)]+'\x0a'+_0x180d2c[_0x1b9de3(0x9e)]+'\x0a\x0a','utf8'),{'success':![],'message':'Hubo\x20un\x20error\x20al\x20hacer\x20la\x20solicitud.'};}}let mainWindow,activationWindow,loginWindow;const createMainWindow=()=>{const _0x51611d=_0x574deb;mainWindow=new BrowserWindow({'width':0x320,'height':0x258}),mainWindow[_0x51611d(0xf3)](),mainWindow[_0x51611d(0x10c)](_0x51611d(0x100)+serverExpress[_0x51611d(0xbf)](_0x51611d(0x155)));},createMainWindowRegister=()=>{const _0x294268=_0x574deb;loginWindow=new BrowserWindow({'width':0x320,'height':0x258,'parent':mainWindow,'webPreferences':{'preload':path[_0x294268(0x127)](__dirname,'preload.js'),'nodeIntegration':!![],'contextIsolation':![]}}),loginWindow['maximize'](),loginWindow[_0x294268(0x162)](path[_0x294268(0x127)](__dirname,_0x294268(0xc5)));},{machineIdSync}=require(_0x574deb(0xfa)),deviceId=machineIdSync();ipcMain['on'](_0x574deb(0xac),async _0x3f45c1=>{const _0x597bad=_0x574deb;console['log']('📥\x20Petición\x20recibida\x20para\x20obtener\x20el\x20deviceId'),_0x3f45c1[_0x597bad(0x122)](_0x597bad(0x139),deviceId);}),ipcMain['on'](_0x574deb(0x159),async(_0x28abb5,_0x53ee03)=>{const _0x51c573=_0x574deb,_0x4542e5=_0x53ee03[_0x51c573(0xc1)];await initialize_token(_0x4542e5['token']),await create_expiration_date_of_the_token(_0x4542e5[_0x51c573(0x14c)]);const _0x2db0fb=_0x51c573(0x15e);_0x28abb5[_0x51c573(0x122)](_0x51c573(0x159),_0x2db0fb);}),ipcMain['on'](_0x574deb(0x134),async(_0x14022a,_0x53b034)=>{const _0x10bc81=_0x574deb,_0x3ebde6=_0x53b034[_0x10bc81(0xfe)],_0xa2af25=await see_if_exist_this_token_in_the_database_of_the_web(_0x3ebde6);if(_0xa2af25[_0x10bc81(0xfe)]){let _0x1d8386=!![];_0xa2af25[_0x10bc81(0xbd)]&&(_0xa2af25[_0x10bc81(0xbd)]!==deviceId&&(_0xa2af25[_0x10bc81(0x10b)]='Este\x20usuario\x20ya\x20tiene\x20un\x20TOKEN\x20registrado\x20en\x20un\x20equipo.',_0x1d8386=![])),_0x1d8386&&(await save_the_uui_of_the_user_in_the_database(_0x3ebde6,deviceId)&&(await initialize_token(_0x3ebde6),await create_expiration_date_of_the_token(_0xa2af25['activation_date']),_0xa2af25[_0x10bc81(0x10b)]=_0x10bc81(0x15e)));}_0x14022a[_0x10bc81(0x122)]('answer-from-login-render-token',_0xa2af25[_0x10bc81(0x10b)]);}),ipcMain['on'](_0x574deb(0xc2),async(_0x2dffcd,_0x267ff1)=>{const _0x7e5c3d=_0x574deb,_0x121c46=_0x267ff1[_0x7e5c3d(0xa3)],_0x4e5b8d=_0x267ff1[_0x7e5c3d(0x10d)],_0x6b2301=await see_if_exist_this_user_in_the_database_of_the_web(_0x121c46,_0x4e5b8d);if(_0x6b2301[_0x7e5c3d(0xfe)]){if(_0x6b2301[_0x7e5c3d(0xbd)]&&_0x6b2301[_0x7e5c3d(0xbd)]!==deviceId)_0x6b2301[_0x7e5c3d(0x10b)]='Este\x20usuario\x20ya\x20tiene\x20un\x20TOKEN\x20registrado\x20en\x20un\x20equipo.';else{if(await save_the_uui_of_the_user_in_the_database(_0x121c46,deviceId)){}}}_0x2dffcd[_0x7e5c3d(0x122)](_0x7e5c3d(0x15a),_0x6b2301['message']);});const bcrypt=require(_0x574deb(0xaf));async function see_if_exist_this_user_in_the_database_of_the_web(_0x1ef286,_0x133273){const _0x22982d=_0x574deb;try{const _0x3d3384=await get_answer_of_my_api(_0x22982d(0xf0),{'email':_0x1ef286});if(!_0x3d3384['data'][_0x22982d(0x99)])return{'token':null,'message':_0x22982d(0x95)};const _0x32f429=_0x3d3384['data'],_0x9cc35b=await bcrypt[_0x22982d(0xab)](_0x133273,_0x32f429[_0x22982d(0x11f)]);if(!_0x9cc35b)return{'token':null,'message':_0x22982d(0xbb)};const _0xff03fc=await get_answer_of_my_api(_0x22982d(0x8b),{'userId':_0x32f429['id']});if(_0xff03fc['data'][_0x22982d(0x99)])return{'token':null,'message':_0x22982d(0x145)};const _0x3d7fde=_0xff03fc[_0x22982d(0x112)],_0x377965=new Date();_0x377965['setFullYear'](_0x377965['getFullYear']()-0x1);if(new Date(_0x32f429['activation_date'])<_0x377965)return{'token':null,'message':'Suscripción\x20expirada.\x20Por\x20favor,\x20vuelve\x20a\x20activar\x20tu\x20membresía.'};return console[_0x22982d(0x97)]('Usuario\x20autenticado\x20con\x20éxito.'),{'token':_0x3d7fde[_0x22982d(0xfe)],'type_membresy':_0x3d7fde[_0x22982d(0xc8)],'message':_0x22982d(0xa2)};}catch(_0x4e0e13){return console[_0x22982d(0xf2)](_0x22982d(0xd4),_0x4e0e13),{'token':null};}}async function see_if_exist_this_token_in_the_database_of_the_web(_0x2f1ce0){const _0x2b4e39=_0x574deb;try{const _0x2fbeb3=await get_answer_of_my_api(_0x2b4e39(0x111),{'token':_0x2f1ce0});if(!_0x2fbeb3['data'][_0x2b4e39(0x99)])return{'token':null,'message':_0x2b4e39(0x16a)};const _0x4b41b4=_0x2fbeb3['data'],_0x584274=new Date();_0x4b41b4[_0x2b4e39(0xc8)]==0x0?_0x584274[_0x2b4e39(0xf6)](_0x584274['getDate']()-0x1e):_0x584274[_0x2b4e39(0x133)](_0x584274[_0x2b4e39(0x109)]()-0x1);if(_0x4b41b4['activation_date']!='0000-00-00'&&new Date(_0x4b41b4[_0x2b4e39(0x168)])<_0x584274)return{'token':null,'message':_0x2b4e39(0x14a)};if(_0x4b41b4[_0x2b4e39(0x168)]===_0x2b4e39(0x131)){const _0x3bf64e=new Date();_0x4b41b4['type_membresy']==0x0?_0x3bf64e[_0x2b4e39(0xf6)](_0x584274[_0x2b4e39(0x160)]()+0x1e):_0x3bf64e['setFullYear'](_0x3bf64e[_0x2b4e39(0x109)]()+0x1);const _0x2ba00d=await get_answer_of_my_api(_0x2b4e39(0x8d),{'suscripcion':_0x3bf64e[_0x2b4e39(0x16c)]()[_0x2b4e39(0x116)]('T')[0x0],'token':_0x2f1ce0});return _0x2ba00d[_0x2b4e39(0x112)]['success']?(_0x4b41b4['activation_date']=_0x3bf64e,console[_0x2b4e39(0x97)](_0x2b4e39(0xa2)),{'token':!![],'type_membresy':_0x4b41b4['type_membresy'],'uuid':_0x4b41b4[_0x2b4e39(0x107)],'activation_date':_0x4b41b4['activation_date'],'message':'Usuario\x20autenticado\x20con\x20éxito.'}):{'token':null,'message':_0x2b4e39(0x143)};}}catch(_0x2209cd){return console[_0x2b4e39(0xf2)](_0x2b4e39(0xd4),_0x2209cd),{'token':null,'message':_0x2209cd};}}async function save_the_uui_of_the_user_in_the_database(_0x57334f,_0x224c88){const _0x5a162a=_0x574deb;try{const _0x493721=await get_answer_of_my_api('see_if_exist_this_token_in_the_database_of_the_web.php',{'token':_0x57334f,'deviceId':_0x224c88});return _0x493721[_0x5a162a(0x112)][_0x5a162a(0x99)];}catch(_0x16d59f){return console[_0x5a162a(0xf2)](_0x5a162a(0xbc),_0x16d59f),![];}}async function verificarTokenActivo(){const _0xc5f580=_0x574deb,_0x3fb6ca=_0xc5f580(0x13a);try{const _0xc6d915=await pool['query'](_0x3fb6ca,[TOKEN]);return console[_0xc5f580(0x97)](_0xc6d915[0x0]),_0xc6d915[0x0]['active']===0x1?(console[_0xc5f580(0x97)]('Token\x20encontrado\x20y\x20activo.'),!![]):(console[_0xc5f580(0x97)]('El\x20token\x20no\x20está\x20activo\x20o\x20no\x20existe.'),![]);}catch(_0x4a3153){return console[_0xc5f580(0xf2)](_0xc5f580(0x149),_0x4a3153),![];}}async function actualizarToken(){const _0x2bb055=_0x574deb,_0x8b6fb5=_0x2bb055(0x101);await pool[_0x2bb055(0xb6)](_0x8b6fb5,[TOKEN]);}app['on'](_0x574deb(0x156),async()=>{const _0x2ea6f8=_0x574deb;await check_if_exist_updates();if(thiIsADemo){await initialize_demo();if(await is_demo_expired()){dialog['showMessageBoxSync']({'type':_0x2ea6f8(0x124),'title':_0x2ea6f8(0x11b),'message':'Tu\x20demo\x20de\x2030\x20días\x20ha\x20expirado.\x20Por\x20favor,\x20compra\x20la\x20versión\x20completa\x20y\x20sigue\x20creciendo\x20con\x20ED\x20PLUS\x20🚀.'}),app['quit']();return;}}else await verify_membership_of_user()?(serverExpress[_0x2ea6f8(0xdc)](serverExpress['get'](_0x2ea6f8(0x155)),_0x2ea6f8(0x15c),()=>{const _0x36f2b9=_0x2ea6f8;console[_0x36f2b9(0x97)](_0x36f2b9(0x98)+getLocalIP()+':'+serverExpress[_0x36f2b9(0xbf)](_0x36f2b9(0x155)));}),createMainWindow()):createMainWindowRegister();}),app['on'](_0x574deb(0xde),()=>{const _0x3c66e3=_0x574deb;process[_0x3c66e3(0x9d)]!=='darwin'&&app['quit']();});